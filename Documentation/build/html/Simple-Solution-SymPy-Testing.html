<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Simple Solution SymPy Testing Theory and Code Generation &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="None"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="search" title="Search" href="search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="index.html">
      <img style="border: 0;" alt="ENKI" src="_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="index.html">Thermoengine 1.0.1 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="simple-solution-sympy-testing-theory-and-code-generation">
<h1>Simple Solution SymPy Testing Theory and Code Generation<a class="headerlink" href="#simple-solution-sympy-testing-theory-and-code-generation" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="simple-solution-properties-structure-of-the-equations">
<h2>Simple Solution Properties - Structure of the Equations<a class="headerlink" href="#simple-solution-properties-structure-of-the-equations" title="Permalink to this headline">¶</a></h2>
<p>There are three terms: - Terms describing standard state contributions -
Terms describing the configurational entropy of solution - Terms
describing the excess enthalpy of solution</p>
<p>Assumptions: - There are <span class="math notranslate nohighlight">\(c\)</span> components in the system - There are
as many endmember species, <span class="math notranslate nohighlight">\(s\)</span>, as there are components - The
configurational entropy is described as a simple <span class="math notranslate nohighlight">\(x_i log(x_i)\)</span>
sum - The excess enthalpy is described using an asymmetric regular
solution
<span class="math notranslate nohighlight">\(\left[ {{W_{ij}} + \Delta {W_{ij}}\left( {{X_i} - {X_j}} \right)} \right]{X_i}{X_j}\)</span>,
where the <span class="math notranslate nohighlight">\(W_{ij}\)</span> and <span class="math notranslate nohighlight">\(\Delta{W_{ij}}\)</span> are allowed to be
first order functions of both <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P\)</span> - Ternary
interaction terms are permittted, i.e. <span class="math notranslate nohighlight">\(W_{ijk}\)</span></p>
</div>
<div class="section" id="number-of-solution-components">
<h2>Number of solution components<a class="headerlink" href="#number-of-solution-components" title="Permalink to this headline">¶</a></h2>
<p>This notebook illustrates a three component solution</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="section" id="define-primary-compositional-variables">
<h2>Define primary compositional variables<a class="headerlink" href="#define-primary-compositional-variables" title="Permalink to this headline">¶</a></h2>
<p>= <span class="math notranslate nohighlight">\(n\)</span> is a vector of mole numbers of each component ## Define
derived compositional variables - <span class="math notranslate nohighlight">\(n_T\)</span> is the total number of
moles in the solution - <span class="math notranslate nohighlight">\(X\)</span> is a vector of mole fractions of
components in the system</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">component_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">component_string</span> <span class="o">+=</span> <span class="s1">&#39;n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">component_string</span><span class="p">)))</span>
<span class="n">nT</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">nT</span>
<span class="n">nT</span><span class="p">,</span> <span class="n">X</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left ( n_{1} + n_{2} + n_{3}, \quad \left[\begin{matrix}\frac{n_{1}}{n_{1} + n_{2} + n_{3}}\\\frac{n_{2}}{n_{1} + n_{2} + n_{3}}\\\frac{n_{3}}{n_{1} + n_{2} + n_{3}}\end{matrix}\right]\right )\end{split}\]</div>
</div>
<div class="section" id="define-temperature-and-pressure">
<h2>Define temperature and pressure<a class="headerlink" href="#define-temperature-and-pressure" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature in <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> is pressure in <span class="math notranslate nohighlight">\(bars\)</span></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="define-standard-state-properties">
<h2>Define standard state properties<a class="headerlink" href="#define-standard-state-properties" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ss_string</span> <span class="o">=</span> <span class="s1">&#39;mu&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">ss_string</span><span class="p">)(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">))</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
<span class="n">mu</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{matrix}\mu_{1}{\left (T,P \right )}\\\mu_{2}{\left (T,P \right )}\\\mu_{3}{\left (T,P \right )}\end{matrix}\right]\end{split}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">mu</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">G_ss</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[n_{1} \mu_{1}{\left (T,P \right )} + n_{2} \mu_{2}{\left (T,P \right )} + n_{3} \mu_{3}{\left (T,P \right )}\]</div>
</div>
<div class="section" id="define-configurational-entropy-and-configurational-gibbs-free-energy">
<h2>Define configurational entropy and configurational Gibbs free energy<a class="headerlink" href="#define-configurational-entropy-and-configurational-gibbs-free-energy" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_config</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;S_config R&#39;</span><span class="p">)</span>
<span class="n">S_config</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="n">S_config</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">S_config</span> <span class="o">*=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">nT</span>
<span class="n">S_config</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- R \left(n_{1} + n_{2} + n_{3}\right) \left(\frac{n_{1} \log{\left (\frac{n_{1}}{n_{1} + n_{2} + n_{3}} \right )}}{n_{1} + n_{2} + n_{3}} + \frac{n_{2} \log{\left (\frac{n_{2}}{n_{1} + n_{2} + n_{3}} \right )}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3} \log{\left (\frac{n_{3}}{n_{1} + n_{2} + n_{3}} \right )}}{n_{1} + n_{2} + n_{3}}\right)\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_config</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">S_config</span><span class="p">)</span>
<span class="n">G_config</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[R T \left(n_{1} \log{\left (\frac{n_{1}}{n_{1} + n_{2} + n_{3}} \right )} + n_{2} \log{\left (\frac{n_{2}}{n_{1} + n_{2} + n_{3}} \right )} + n_{3} \log{\left (\frac{n_{3}}{n_{1} + n_{2} + n_{3}} \right )}\right)\]</div>
</div>
<div class="section" id="parameterize-the-excess-free-energy">
<h2>Parameterize the excess free energy<a class="headerlink" href="#parameterize-the-excess-free-energy" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Symmetric terms: <span class="math notranslate nohighlight">\(W_{ij} = Wh_{ij} - T Ws_{ij} + P Wv_{ij}\)</span>,
where <span class="math notranslate nohighlight">\(Wh_{ij}\)</span> is the excess enthalpy along the
<span class="math notranslate nohighlight">\(i\)</span>-<span class="math notranslate nohighlight">\(j\)</span> binary, <span class="math notranslate nohighlight">\(Ws_{ij}\)</span> is the excess entropy,
and <span class="math notranslate nohighlight">\(Wv_{ij}\)</span> is the excess volume</p></li>
<li><p>Asymetric terms:
<span class="math notranslate nohighlight">\(\Delta W_{ij} = \Delta Wh_{ij} - T \Delta Ws_{ij} + P \Delta Wv_{ij}\)</span></p></li>
<li><p>Convention:
<span class="math notranslate nohighlight">\(\left[ {{W_{ij}} + \Delta {W_{ij}}\left( {{X_i} - {X_j}} \right)} \right]{X_i}{X_j} = \left( {{W_{ij}} + \Delta {W_{ij}}} \right)X_i^2{X_j} + \left( {{W_{ij}} - \Delta {W_{ij}}} \right){X_i}X_j^2 = {W_{iij}}X_i^2{X_j} + {W_{ijj}}{X_i}X_j^2\)</span></p></li>
<li><p>Strictly ternary terms: <span class="math notranslate nohighlight">\(W_{ijk}X_iX_jX_k\)</span>, where
<span class="math notranslate nohighlight">\(i {\ne} j {\ne} k\)</span></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="o">=</span> <span class="s1">&#39;asymm_regular&#39;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">symparam</span> <span class="o">=</span> <span class="p">()</span>
<span class="n">G_excess</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;G_excess&#39;</span><span class="p">)</span>
<span class="n">G_excess</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Wh&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/m&#39;</span><span class="p">)</span>
        <span class="n">h_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">h_term</span><span class="p">,)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Ws&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/K-m&#39;</span><span class="p">)</span>
        <span class="n">s_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">s_term</span><span class="p">,)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Wv&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-m&#39;</span><span class="p">)</span>
        <span class="n">v_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">v_term</span><span class="p">,)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;dWh&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/m&#39;</span><span class="p">)</span>
        <span class="n">dh_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dh_term</span><span class="p">,)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;dWs&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/K-m&#39;</span><span class="p">)</span>
        <span class="n">ds_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ds_term</span><span class="p">,)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;dWv&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-m&#39;</span><span class="p">)</span>
        <span class="n">dv_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dv_term</span><span class="p">,)</span>
        <span class="n">w_term</span> <span class="o">=</span> <span class="n">h_term</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">s_term</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">v_term</span>
        <span class="n">dw_term</span> <span class="o">=</span> <span class="n">dh_term</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">ds_term</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">dv_term</span>
        <span class="n">G_excess</span> <span class="o">+=</span> <span class="p">(</span><span class="n">w_term</span> <span class="o">+</span> <span class="n">dw_term</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">nT</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">G_excess</span> <span class="o">/=</span> <span class="n">nT</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Wh&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/m&#39;</span><span class="p">)</span>
            <span class="n">h_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">h_term</span><span class="p">,)</span>
            <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Ws&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/K-m&#39;</span><span class="p">)</span>
            <span class="n">s_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">s_term</span><span class="p">,)</span>
            <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;Wv&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-m&#39;</span><span class="p">)</span>
            <span class="n">v_term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">param</span><span class="p">);</span> <span class="n">symparam</span> <span class="o">+=</span> <span class="p">(</span><span class="n">v_term</span><span class="p">,)</span>
            <span class="n">G_excess</span> <span class="o">+=</span> <span class="p">(</span><span class="n">h_term</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">s_term</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">v_term</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">nT</span><span class="o">/</span><span class="n">nT</span>
<span class="n">G_excess</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{n_{1} n_{2} n_{3} \left(P Wv_{123} - T Ws_{123} + Wh_{123}\right)}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{n_{1} n_{2} \left(P Wv_{12} - T Ws_{12} + Wh_{12} + \frac{\left(n_{1} - n_{2}\right) \left(P dWv_{12} - T dWs_{12} + dWh_{12}\right)}{n_{1} + n_{2} + n_{3}}\right) + n_{1} n_{3} \left(P Wv_{13} - T Ws_{13} + Wh_{13} + \frac{\left(n_{1} - n_{3}\right) \left(P dWv_{13} - T dWs_{13} + dWh_{13}\right)}{n_{1} + n_{2} + n_{3}}\right) + n_{2} n_{3} \left(P Wv_{23} - T Ws_{23} + Wh_{23} + \frac{\left(n_{2} - n_{3}\right) \left(P dWv_{23} - T dWs_{23} + dWh_{23}\right)}{n_{1} + n_{2} + n_{3}}\right)}{n_{1} + n_{2} + n_{3}}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Wh12&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws12&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv12&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh13&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws13&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv13&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh23&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws23&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv23&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh123&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws123&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv123&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="define-the-gibbs-free-energy-of-solution">
<h2>Define the Gibbs free energy of solution<a class="headerlink" href="#define-the-gibbs-free-energy-of-solution" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">G_ss</span> <span class="o">+</span> <span class="n">G_config</span> <span class="o">+</span> <span class="n">G_excess</span>
<span class="n">G</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[R T \left(n_{1} \log{\left (\frac{n_{1}}{n_{1} + n_{2} + n_{3}} \right )} + n_{2} \log{\left (\frac{n_{2}}{n_{1} + n_{2} + n_{3}} \right )} + n_{3} \log{\left (\frac{n_{3}}{n_{1} + n_{2} + n_{3}} \right )}\right) + \frac{n_{1} n_{2} n_{3} \left(P Wv_{123} - T Ws_{123} + Wh_{123}\right)}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + n_{1} \mu_{1}{\left (T,P \right )} + n_{2} \mu_{2}{\left (T,P \right )} + n_{3} \mu_{3}{\left (T,P \right )} + \frac{n_{1} n_{2} \left(P Wv_{12} - T Ws_{12} + Wh_{12} + \frac{\left(n_{1} - n_{2}\right) \left(P dWv_{12} - T dWs_{12} + dWh_{12}\right)}{n_{1} + n_{2} + n_{3}}\right) + n_{1} n_{3} \left(P Wv_{13} - T Ws_{13} + Wh_{13} + \frac{\left(n_{1} - n_{3}\right) \left(P dWv_{13} - T dWs_{13} + dWh_{13}\right)}{n_{1} + n_{2} + n_{3}}\right) + n_{2} n_{3} \left(P Wv_{23} - T Ws_{23} + Wh_{23} + \frac{\left(n_{2} - n_{3}\right) \left(P dWv_{23} - T dWs_{23} + dWh_{23}\right)}{n_{1} + n_{2} + n_{3}}\right)}{n_{1} + n_{2} + n_{3}}\]</div>
</div>
<div class="section" id="instantiate-c-code-printers-and-modify-default-behavior">
<h2>Instantiate C code printers and modify default behavior<a class="headerlink" href="#instantiate-c-code-printers-and-modify-default-behavior" title="Permalink to this headline">¶</a></h2>
<p>The C99 code printing class is subclassed and two functions are added: -
The first overrides the pow() function for products with integer
exponent &lt;= 4 - The second implements a version of user function
derivative printing specified to endmember chemical potential
derivatives called externally from a C structure (see implementation
below)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.printing.ccode</span> <span class="kn">import</span> <span class="n">C99CodePrinter</span>
<span class="k">class</span> <span class="nc">SubCodePrinter</span><span class="p">(</span><span class="n">C99CodePrinter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_print_Pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_integer</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;)*(&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">)])</span>
            <span class="k">return</span> <span class="s1">&#39;((&#39;</span> <span class="o">+</span> <span class="n">result</span> <span class="o">+</span> <span class="s1">&#39;))&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_print_Pow</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_print_Derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">number_of_derivatives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">function_string_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">derivative_string</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].dmu0d&#39;</span> <span class="o">+</span> <span class="n">derivative_string</span> <span class="o">+</span> <span class="s1">&#39;)(T, P)&#39;</span>
        <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d2mu0dT2)(T, P)&#39;</span>
            <span class="k">elif</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d2mu0dTdP)(T, P)&#39;</span>
            <span class="k">elif</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d2mu0dP2)(T, P)&#39;</span>
        <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">derivative_string_3</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_3</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d3mu0dT3)(T, P)&#39;</span>
            <span class="k">elif</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_3</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d3mu0dT2dP)(T, P)&#39;</span>
            <span class="k">elif</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_3</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d3mu0dTdP2)(T, P)&#39;</span>
            <span class="k">elif</span> <span class="n">derivative_string_1</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_2</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> <span class="ow">and</span> <span class="n">derivative_string_3</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d3mu0dP3)(T, P)&#39;</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
<div class="section" id="instantiate-the-mldified-c99-printing-class">
<h2>Instantiate the mldified C99 printing class<a class="headerlink" href="#instantiate-the-mldified-c99-printing-class" title="Permalink to this headline">¶</a></h2>
<p>and add definitions of user functions that describe endmember chemical
potentials</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="n">_endmembers</span> <span class="p">{</span>
  <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">formula</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">const</span> <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">mw</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">mu0</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">dmu0dT</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">dmu0dP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dT2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dTdP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dP2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dT3</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dT2dP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dTdP2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dP3</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
<span class="p">}</span> <span class="n">Endmembers</span><span class="p">;</span>
<span class="n">static</span> <span class="n">Endmembers</span> <span class="n">endmember</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">Akermanite_berman_name</span><span class="p">,</span>
    <span class="n">Akermanite_berman_formula</span><span class="p">,</span>
    <span class="n">Akermanite_berman_mw</span><span class="p">,</span>
    <span class="n">Akermanite_berman_g</span><span class="p">,</span>
    <span class="n">Akermanite_berman_dgdt</span><span class="p">,</span>
    <span class="n">Akermanite_berman_dgdp</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d2gdt2</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d2gdtdp</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d2gdp2</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d3gdt3</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d3gdt2dp</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d3gdtdp2</span><span class="p">,</span>
    <span class="n">Akermanite_berman_d3gdp3</span>
  <span class="p">},</span>
  <span class="p">{</span>
  <span class="o">...</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="n">static</span> <span class="nb">int</span> <span class="n">nc</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizeof</span> <span class="n">endmember</span> <span class="o">/</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">_endmembers</span><span class="p">));</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">printer</span> <span class="o">=</span> <span class="n">SubCodePrinter</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user_functions&#39;</span><span class="p">:{</span><span class="s1">&#39;mu1&#39;</span><span class="p">:</span><span class="s1">&#39;(*endmember[0].mu0)&#39;</span><span class="p">,</span> <span class="s1">&#39;mu2&#39;</span><span class="p">:</span><span class="s1">&#39;(*endmember[1].mu0)&#39;</span><span class="p">,</span> \
                                   <span class="s1">&#39;mu3&#39;</span><span class="p">:</span><span class="s1">&#39;(*endmember[2].mu0)&#39;</span><span class="p">}})</span>
<span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;R*T*(-n2/(n1 + n2 + n3) - n3/(n1 + n2 + n3) + (-n1/((n1 + n2 + n3)*(n1 + n2 + n3)) + 1.0/(n1 + n2 + n3))*(n1 + n2 + n3) + log(n1/(n1 + n2 + n3))) - 2*n1*n2*n3*(P*Wv123 - T*Ws123 + Wh123)/((n1 + n2 + n3)*(n1 + n2 + n3)*(n1 + n2 + n3)) + n2*n3*(P*Wv123 - T*Ws123 + Wh123)/((n1 + n2 + n3)*(n1 + n2 + n3)) + (*endmember[0].mu0)(T, P) + (n1*n2*(-(n1 - n2)*(P*dWv12 - T*dWs12 + dWh12)/((n1 + n2 + n3)*(n1 + n2 + n3)) + (P*dWv12 - T*dWs12 + dWh12)/(n1 + n2 + n3)) + n1*n3*(-(n1 - n3)*(P*dWv13 - T*dWs13 + dWh13)/((n1 + n2 + n3)*(n1 + n2 + n3)) + (P*dWv13 - T*dWs13 + dWh13)/(n1 + n2 + n3)) - n2*n3*(n2 - n3)*(P*dWv23 - T*dWs23 + dWh23)/((n1 + n2 + n3)*(n1 + n2 + n3)) + n2*(P*Wv12 - T*Ws12 + Wh12 + (n1 - n2)*(P*dWv12 - T*dWs12 + dWh12)/(n1 + n2 + n3)) + n3*(P*Wv13 - T*Ws13 + Wh13 + (n1 - n3)*(P*dWv13 - T*dWs13 + dWh13)/(n1 + n2 + n3)))/(n1 + n2 + n3) - (n1*n2*(P*Wv12 - T*Ws12 + Wh12 + (n1 - n2)*(P*dWv12 - T*dWs12 + dWh12)/(n1 + n2 + n3)) + n1*n3*(P*Wv13 - T*Ws13 + Wh13 + (n1 - n3)*(P*dWv13 - T*dWs13 + dWh13)/(n1 + n2 + n3)) + n2*n3*(P*Wv23 - T*Ws23 + Wh23 + (n2 - n3)*(P*dWv23 - T*dWs23 + dWh23)/(n1 + n2 + n3)))/((n1 + n2 + n3)*(n1 + n2 + n3))&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="use-code-printers-to-construct-c-package-code">
<h1>Use code printers to construct “C” package code<a class="headerlink" href="#use-code-printers-to-construct-c-package-code" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="nv">mkdir</span> <span class="o">=</span>p working
<span class="o">%</span><span class="k">cd</span> working
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span><span class="p">:</span> <span class="o">=</span><span class="n">p</span><span class="p">:</span> <span class="n">File</span> <span class="n">exists</span>
<span class="n">mkdir</span><span class="p">:</span> <span class="n">working</span><span class="p">:</span> <span class="n">File</span> <span class="n">exists</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span><span class="o">/</span><span class="n">working</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moles_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = n[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">moles_assign_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="n">double</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="n">double</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</pre></div>
</div>
<p>Function template for primary routines in solution_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_calc_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_</span><span class="si">{func}</span><span class="s2">(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="si">{moles_assign}</span><span class="s2"></span>
<span class="s2">    double result = </span><span class="si">{g_code}</span><span class="s2">;</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>
<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">solution_derivative_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static void </span><span class="si">{module}</span><span class="s2">_</span><span class="si">{func}</span><span class="s2">(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="si">{moles_assign}</span><span class="s2"></span>
<span class="si">{derivative_code}</span><span class="s2"></span>
<span class="s2">}}</span>
<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Primary routines in solution_calc.h</div>
<div class="line">Note that the compositional derivatives augment the standard routines
inherited from the endmember api</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;dgdt&#39;</span><span class="p">,</span> <span class="s1">&#39;dgdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdt2&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdp3&#39;</span><span class="p">]</span>
<span class="n">G_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">G</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                       <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">dn_f_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dgdn&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdndt&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdndp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdndt2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdndtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdndp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndt2dp&#39;</span><span class="p">,</span> \
             <span class="s1">&#39;d4gdndtdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndp3&#39;</span><span class="p">]</span>
<span class="n">d2n_f_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d2gdn2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdn2dt&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdn2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn2dt2&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn2dtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn2dp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dt2dp&#39;</span><span class="p">,</span> \
             <span class="s1">&#39;d5gdn2dtdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dp3&#39;</span><span class="p">]</span>
<span class="n">d3n_f_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d3gdn3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn3dt&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn3dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn3dt2&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn3dtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn3dp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dt2dp&#39;</span><span class="p">,</span> \
             <span class="s1">&#39;d6gdn3dtdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dp3&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that the compositional derivatives are returned in a pre-allocated
one dimensional array that is passed to the function (which returns
void). The higher-oredr compositional derivatives are returned in
compact storage mode, as defined below.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_calc</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">)):</span>
    <span class="n">solution_calc</span> <span class="o">+=</span> <span class="n">solution_calc_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                              <span class="n">func</span><span class="o">=</span><span class="n">f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
                              <span class="n">g_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
                              <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>

    <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
        <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">solution_calc</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                              <span class="n">func</span><span class="o">=</span><span class="n">dn_f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
                              <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
                              <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span> \
                              <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>

    <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
            <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                                  <span class="o">+</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">solution_calc</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                              <span class="n">func</span><span class="o">=</span><span class="n">d2n_f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
                              <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
                              <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span> \
                              <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>

    <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                                      <span class="o">+</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">solution_calc</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                              <span class="n">func</span><span class="o">=</span><span class="n">d3n_f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
                              <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
                              <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span> \
                              <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>
</pre></div>
</div>
<p>Compact storage scheme for the second order compositional derivatives.
Elements of the upper triangle of the symmetric Hessian matrix are
returned.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">0</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">2</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">3</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">4</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">5</span>
</pre></div>
</div>
<p>Compact storage scheme for the third order compositional derivatives.
Elements of the upper wedge of the symmetric third order array are
returned.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">0</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">2</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">3</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">4</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">5</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">6</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">7</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">8</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">9</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Add convenience routiines to soution_calc.h</div>
<div class="line">These routines mimic those of the endmember API. Convenience routines
manipulating compositional derivatives are not included, although they
could be defined if the need arises.</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convenience_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_s(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_dgdt(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_v(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_cv(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P, n);</span>
<span class="s2">    double dvdt = </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P, n);</span>
<span class="s2">    double dvdp = </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n);</span>
<span class="s2">    result += T*dvdt*dvdt/dvdp;</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_cp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P, n) - </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_alpha(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P, n)/</span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_beta(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n)/</span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_K(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n)/</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_Kp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">    result *= </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P, n);</span>
<span class="s2">    result /= pow(</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n), 2.0);</span>
<span class="s2">    return result - 1.0;</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_calc</span> <span class="o">+=</span> <span class="n">convenience_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>Write contents to solution_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;solution_calc.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">solution_calc</span><span class="p">)</span>
</pre></div>
</div>
<p>Function template for primary routines in solution_calib.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_calib_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_dparam_</span><span class="si">{func}</span><span class="s2">(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="si">{moles_assign}</span><span class="s2"></span>
<span class="s2">    double result = 0.0;</span>
<span class="s2">    switch (index) {{</span>
<span class="si">{switch_code}</span><span class="s2"></span>
<span class="s2">    default:</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">        return result;</span>
<span class="s2">}}</span>
<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Wh12</span><span class="p">,</span> <span class="n">Ws12</span><span class="p">,</span> <span class="n">Wv12</span><span class="p">,</span> <span class="n">dWh12</span><span class="p">,</span> <span class="n">dWs12</span><span class="p">,</span> <span class="n">dWv12</span><span class="p">,</span> <span class="n">Wh13</span><span class="p">,</span> <span class="n">Ws13</span><span class="p">,</span> <span class="n">Wv13</span><span class="p">,</span> <span class="n">dWh13</span><span class="p">,</span> <span class="n">dWs13</span><span class="p">,</span> <span class="n">dWv13</span><span class="p">,</span> <span class="n">Wh23</span><span class="p">,</span> <span class="n">Ws23</span><span class="p">,</span> <span class="n">Wv23</span><span class="p">,</span> <span class="n">dWh23</span><span class="p">,</span> <span class="n">dWs23</span><span class="p">,</span> <span class="n">dWv23</span><span class="p">,</span> <span class="n">Wh123</span><span class="p">,</span> <span class="n">Ws123</span><span class="p">,</span> <span class="n">Wv123</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_calib</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">)):</span>
    <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>

    <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)):</span>
        <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">solution_calib</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                              <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
                              <span class="n">func</span><span class="o">=</span><span class="n">f_list</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                              <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> \
                              <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span> \
                             <span class="p">)</span>
</pre></div>
</div>
<p>Add convenience routines to solution_calib.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_get_param_number(void) {{</span>
<span class="s2">    return </span><span class="si">{number_params}</span><span class="s2">;</span>
<span class="s2">}}</span>

<span class="s2">static const char *paramNames[</span><span class="si">{number_params}</span><span class="s2">] = </span><span class="si">{names_params}</span><span class="s2">;</span>
<span class="s2">static const char *paramUnits[</span><span class="si">{number_params}</span><span class="s2">] = </span><span class="si">{units_params}</span><span class="s2">;</span>

<span class="s2">static const char **</span><span class="si">{module}</span><span class="s2">_get_param_names(void) {{</span>
<span class="s2">    return paramNames;</span>
<span class="s2">}}</span>

<span class="s2">static const char **</span><span class="si">{module}</span><span class="s2">_get_param_units(void) {{</span>
<span class="s2">    return paramUnits;</span>
<span class="s2">}}</span>

<span class="s2">static void </span><span class="si">{module}</span><span class="s2">_get_param_values(double *values) {{</span>
<span class="si">{code_block_one}</span><span class="s2"></span>
<span class="s2">}}</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_set_param_values(double *values) {{</span>
<span class="si">{code_block_two}</span><span class="s2"></span>
<span class="s2">    return 1;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_get_param_value(int index) {{</span>
<span class="s2">    double result = 0.0;</span>
<span class="s2">    switch (index) {{</span>
<span class="si">{code_block_three}</span><span class="s2"></span>
<span class="s2">    default:</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value) {{</span>
<span class="s2">    int result = 1;</span>
<span class="s2">    switch (index) {{</span>
<span class="si">{code_block_four}</span><span class="s2"></span>
<span class="s2">    default:</span>
<span class="s2">        result = 0;</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value_params</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
<span class="n">code_block_one_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">code_block_two_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">code_block_three_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">code_block_four_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">value_params</span><span class="p">)):</span>
    <span class="n">code_block_one_text</span>   <span class="o">+=</span> <span class="s1">&#39;    values[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_two_text</span>   <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = values[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;        result = &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_four_text</span>  <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;        &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = value;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="n">solution_calib</span> <span class="o">+=</span> <span class="n">extra_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                                      <span class="n">number_params</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> \
                                      <span class="n">names_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span> \
                                      <span class="n">units_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span> \
                                      <span class="n">code_block_one</span><span class="o">=</span><span class="n">code_block_one_text</span><span class="p">,</span> \
                                      <span class="n">code_block_two</span><span class="o">=</span><span class="n">code_block_two_text</span><span class="p">,</span> \
                                      <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span> \
                                      <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;solution_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">solution_calib</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="define-characteristics-of-a-feldspar-solution">
<h1>Define characteristics of a Feldspar Solution<a class="headerlink" href="#define-characteristics-of-a-feldspar-solution" title="Permalink to this headline">¶</a></h1>
<p>Components 1. albite, <span class="math notranslate nohighlight">\({\rm{NaAlSi_3O_8}}\)</span> 2. anorthite,
<span class="math notranslate nohighlight">\({\rm{CaAl_2Si_2O_8}}\)</span> 3. sanidine, <span class="math notranslate nohighlight">\({\rm{KAlSi_3O_8}}\)</span></p>
<p>Original calibration from the Elkins-Grove paper using their notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">whabor</span>   <span class="o">=</span> <span class="mf">18810.0</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">wsabor</span>   <span class="o">=</span> <span class="mf">10.3</span><span class="p">;</span>     <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">K</span>   <span class="o">*/</span>
<span class="n">wvabor</span>   <span class="o">=</span> <span class="mf">0.4602</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
<span class="n">whorab</span>   <span class="o">=</span> <span class="mf">27320.0</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">wsorab</span>   <span class="o">=</span> <span class="mf">10.3</span><span class="p">;</span>     <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">K</span>   <span class="o">*/</span>
<span class="n">wvorab</span>   <span class="o">=</span> <span class="mf">0.3264</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
<span class="n">whaban</span>   <span class="o">=</span> <span class="mf">7924.0</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">whanab</span>   <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>      <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">whoran</span>   <span class="o">=</span> <span class="mf">40317.0</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">whanor</span>   <span class="o">=</span> <span class="mf">38974.0</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">wvanor</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.1037</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
<span class="n">whabanor</span> <span class="o">=</span> <span class="mf">12545.0</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">wvabanor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.095</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Note that in the notation derveloped in this paper,
<span class="math notranslate nohighlight">\(\left[ {{W_{ij}} + \Delta {W_{ij}}\left( {{X_i} - {X_j}} \right)} \right]{X_i}{X_j}\)</span>,
is related to the convention used in the original paper:
<span class="math notranslate nohighlight">\({{\tilde W}_{13}}{X_1}{X_3}\left( {{X_3} + \frac{{{X_2}}}{2}} \right) + {{\tilde W}_{31}}{X_1}{X_3}\left( {{X_1} + \frac{{{X_2}}}{2}} \right)\)</span>:</div>
<div class="line">- <span class="math notranslate nohighlight">\({W_{13}} = {{\tilde W}_{13}} + {{\tilde W}_{31}}\)</span> -
<span class="math notranslate nohighlight">\(d{W_{13}} = {{\tilde W}_{31}} - {{\tilde W}_{13}}\)</span></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">whabor</span>   <span class="o">=</span> <span class="mf">18810.0</span>
<span class="n">wsabor</span>   <span class="o">=</span> <span class="mf">10.3</span>
<span class="n">wvabor</span>   <span class="o">=</span> <span class="mf">0.4602</span>
<span class="n">whorab</span>   <span class="o">=</span> <span class="mf">27320.0</span>
<span class="n">wsorab</span>   <span class="o">=</span> <span class="mf">10.3</span>
<span class="n">wvorab</span>   <span class="o">=</span> <span class="mf">0.3264</span>
<span class="n">whaban</span>   <span class="o">=</span> <span class="mf">7924.0</span>
<span class="n">whanab</span>   <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">whoran</span>   <span class="o">=</span> <span class="mf">40317.0</span>
<span class="n">whanor</span>   <span class="o">=</span> <span class="mf">38974.0</span>
<span class="n">wvanor</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.1037</span>
<span class="n">wvoran</span>   <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">whabanor</span> <span class="o">=</span> <span class="mf">12545.0</span>
<span class="n">wvabanor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.095</span>
<span class="n">paramValues</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Wh12&#39;</span><span class="p">:</span><span class="n">whaban</span><span class="o">+</span><span class="n">whanab</span><span class="p">,</span>  <span class="s1">&#39;Ws12&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>            <span class="s1">&#39;Wv12&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> \
                <span class="s1">&#39;Wh13&#39;</span><span class="p">:</span><span class="n">whabor</span><span class="o">+</span><span class="n">whorab</span><span class="p">,</span>  <span class="s1">&#39;Ws13&#39;</span><span class="p">:</span><span class="n">wsabor</span><span class="o">+</span><span class="n">wsorab</span><span class="p">,</span>  <span class="s1">&#39;Wv13&#39;</span><span class="p">:</span><span class="n">wvabor</span><span class="o">+</span><span class="n">wvorab</span><span class="p">,</span> \
                <span class="s1">&#39;Wh23&#39;</span><span class="p">:</span><span class="n">whanor</span><span class="o">+</span><span class="n">whoran</span><span class="p">,</span>  <span class="s1">&#39;Ws23&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>            <span class="s1">&#39;Wv23&#39;</span><span class="p">:</span><span class="n">wvanor</span><span class="o">+</span><span class="n">wvoran</span><span class="p">,</span> \
                <span class="s1">&#39;dWh12&#39;</span><span class="p">:</span><span class="n">whanab</span><span class="o">-</span><span class="n">whaban</span><span class="p">,</span> <span class="s1">&#39;dWs12&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>           <span class="s1">&#39;dWv12&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> \
                <span class="s1">&#39;dWh13&#39;</span><span class="p">:</span><span class="n">whorab</span><span class="o">-</span><span class="n">whabor</span><span class="p">,</span> <span class="s1">&#39;dWs13&#39;</span><span class="p">:</span><span class="n">wsorab</span><span class="o">-</span><span class="n">wsabor</span><span class="p">,</span> <span class="s1">&#39;dWv13&#39;</span><span class="p">:</span><span class="n">wvorab</span><span class="o">-</span><span class="n">wvabor</span><span class="p">,</span> \
                <span class="s1">&#39;dWh23&#39;</span><span class="p">:</span><span class="n">whoran</span><span class="o">-</span><span class="n">whanor</span><span class="p">,</span> <span class="s1">&#39;dWs23&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>           <span class="s1">&#39;dWv23&#39;</span><span class="p">:</span><span class="n">wvoran</span><span class="o">-</span><span class="n">wvanor</span><span class="p">,</span>
                <span class="s1">&#39;Wh123&#39;</span><span class="p">:</span><span class="n">whabanor</span><span class="p">,</span> <span class="s1">&#39;Ws123&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Wv123&#39;</span><span class="p">:</span><span class="n">wvabanor</span><span class="p">}</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">paramValues</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Wh12&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws12&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs12&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv12&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh13&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws13&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs13&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv13&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh23&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws23&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWh23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWs23&#39;</span><span class="p">,</span> <span class="s1">&#39;dWv23&#39;</span><span class="p">,</span> <span class="s1">&#39;Wh123&#39;</span><span class="p">,</span> <span class="s1">&#39;Ws123&#39;</span><span class="p">,</span> <span class="s1">&#39;Wv123&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="s1">&#39;Wh12&#39;</span><span class="p">:</span> <span class="mf">7924.0</span><span class="p">,</span> <span class="s1">&#39;Ws12&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Wv12&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Wh13&#39;</span><span class="p">:</span> <span class="mf">46130.0</span><span class="p">,</span> <span class="s1">&#39;Ws13&#39;</span><span class="p">:</span> <span class="mf">20.6</span><span class="p">,</span> <span class="s1">&#39;Wv13&#39;</span><span class="p">:</span> <span class="mf">0.7866</span><span class="p">,</span> <span class="s1">&#39;Wh23&#39;</span><span class="p">:</span> <span class="mf">79291.0</span><span class="p">,</span> <span class="s1">&#39;Ws23&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Wv23&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.1037</span><span class="p">,</span> <span class="s1">&#39;dWh12&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">7924.0</span><span class="p">,</span> <span class="s1">&#39;dWs12&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;dWv12&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;dWh13&#39;</span><span class="p">:</span> <span class="mf">8510.0</span><span class="p">,</span> <span class="s1">&#39;dWs13&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;dWv13&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.13379999999999997</span><span class="p">,</span> <span class="s1">&#39;dWh23&#39;</span><span class="p">:</span> <span class="mf">1343.0</span><span class="p">,</span> <span class="s1">&#39;dWs23&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;dWv23&#39;</span><span class="p">:</span> <span class="mf">0.1037</span><span class="p">,</span> <span class="s1">&#39;Wh123&#39;</span><span class="p">:</span> <span class="mf">12545.0</span><span class="p">,</span> <span class="s1">&#39;Ws123&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;Wv123&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.095</span><span class="p">}</span>
</pre></div>
</div>
<div class="section" id="create-templates-for-instance-of-an-asymmetric-regular-solution-phase">
<h2>Create templates for instance of an asymmetric regular solution phase<a class="headerlink" href="#create-templates-for-instance-of-an-asymmetric-regular-solution-phase" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_c_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static const int identifier = </span><span class="si">{git_identifier}</span><span class="s2">;</span>
<span class="si">{code_block_one}</span><span class="s2"></span>

<span class="s2">#include &quot;solution_calc.h&quot;</span>

<span class="s2">const int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_identifier(void) {{</span>
<span class="s2">    return identifier;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_name(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{phase}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_g(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdn(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_dgdn(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdn2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdn2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdt(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdndt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdndt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn2dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn2dt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn3dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn3dt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdndp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdndp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn3dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn3dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt2dp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdtdp2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_s(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_s(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_v(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_v(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cv(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cv(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dcpdt(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_alpha(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_alpha(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_beta(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_beta(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_K(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_K(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_Kp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_Kp(T, P, n);</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calib_c_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static int identifier = </span><span class="si">{git_identifier}</span><span class="s2">;</span>
<span class="si">{code_block_two}</span><span class="s2"></span>

<span class="s2">#include &quot;solution_calc.h&quot;</span>
<span class="s2">#include &quot;solution_calib.h&quot;</span>

<span class="s2">const int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_identifier(void) {{</span>
<span class="s2">    return identifier;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_name(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{phase}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_g(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdn(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_dgdn(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdn2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdn2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdt(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdndt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdndt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn2dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn2dt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn3dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn3dt(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdndp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d2gdndp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdn2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn3dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn3dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dt2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dtdp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d3gdndp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdn2dp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn3dp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dt3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt2dp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dt2dp(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdtdp2(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dtdp2(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d4gdndp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d5gdn2dp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_d6gdn3dp3(T, P, n, result);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_s(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_s(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_v(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_v(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cv(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cv(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dcpdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dcpdt(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_alpha(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_alpha(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_beta(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_beta(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_K(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_K(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_Kp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_Kp(T, P, n);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_number(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_number();</span>
<span class="s2">}}</span>

<span class="s2">const char **</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_names(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_names();</span>
<span class="s2">}}</span>

<span class="s2">const char **</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_units(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_units();</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_values(double *values) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_get_param_values(values);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_values(double *values) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_set_param_values(values);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_value(int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_value(index);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_set_param_value(index, value);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_g(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_dgdt(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_dgdp(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(T, P, n, index);</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_h_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_name(void);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdn(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdndt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdndp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdndp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdndp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdn2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn2dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn2dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn2dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdn3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn3dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d4gdn3dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d5gdn3dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d6gdn3dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_s(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_v(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cv(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_alpha(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_beta(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_K(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_Kp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calib_h_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_name(void);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdn(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdndt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdndp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdndp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdndp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdn2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn2dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn2dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn2dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdn3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn3dt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d4gdn3dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d5gdn3dp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d6gdn3dp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], double result[</span><span class="si">{number_components}</span><span class="s2">]);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_s(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_v(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cv(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dcpdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_alpha(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_beta(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_K(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_Kp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">]);</span>


<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_number(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_names(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_units(void);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_values(double *values);</span>
<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_values(double *values);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_value(int index);</span>
<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_g(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdt(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(double T, double P, double n[</span><span class="si">{number_components}</span><span class="s2">], int index);</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="n">_endmembers</span> <span class="p">{</span>
  <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">formula</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">const</span> <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">mw</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">mu0</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">dmu0dT</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">dmu0dP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dT2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dTdP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d2mu0dP2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dT3</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dT2dP</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dTdP2</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
  <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">d3mu0dP3</span><span class="p">)</span> <span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">);</span>
<span class="p">}</span> <span class="n">Endmembers</span><span class="p">;</span>
<span class="n">static</span> <span class="n">Endmembers</span> <span class="n">endmember</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="n">Albite_berman_name</span><span class="p">,</span>
    <span class="n">Albite_berman_formula</span><span class="p">,</span>
    <span class="n">Albite_berman_mw</span><span class="p">,</span>
    <span class="n">Albite_berman_g</span><span class="p">,</span>
    <span class="n">Albite_berman_dgdt</span><span class="p">,</span>
    <span class="n">Albite_berman_dgdp</span><span class="p">,</span>
    <span class="n">Albite_berman_d2gdt2</span><span class="p">,</span>
    <span class="n">Albite_berman_d2gdtdp</span><span class="p">,</span>
    <span class="n">Albite_berman_d2gdp2</span><span class="p">,</span>
    <span class="n">Albite_berman_d3gdt3</span><span class="p">,</span>
    <span class="n">Albite_berman_d3gdt2dp</span><span class="p">,</span>
    <span class="n">Albite_berman_d3gdtdp2</span><span class="p">,</span>
    <span class="n">Albite_berman_d3gdp3</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">Anorthite_berman_name</span><span class="p">,</span>
    <span class="n">Anorthite_berman_formula</span><span class="p">,</span>
    <span class="n">Anorthite_berman_mw</span><span class="p">,</span>
    <span class="n">Anorthite_berman_g</span><span class="p">,</span>
    <span class="n">Anorthite_berman_dgdt</span><span class="p">,</span>
    <span class="n">Anorthite_berman_dgdp</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d2gdt2</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d2gdtdp</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d2gdp2</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d3gdt3</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d3gdt2dp</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d3gdtdp2</span><span class="p">,</span>
    <span class="n">Anorthite_berman_d3gdp3</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">Sanidine_berman_name</span><span class="p">,</span>
    <span class="n">Sanidine_berman_formula</span><span class="p">,</span>
    <span class="n">Sanidine_berman_mw</span><span class="p">,</span>
    <span class="n">Sanidine_berman_g</span><span class="p">,</span>
    <span class="n">Sanidine_berman_dgdt</span><span class="p">,</span>
    <span class="n">Sanidine_berman_dgdp</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d2gdt2</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d2gdtdp</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d2gdp2</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d3gdt3</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d3gdt2dp</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d3gdtdp2</span><span class="p">,</span>
    <span class="n">Sanidine_berman_d3gdp3</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="n">static</span> <span class="nb">int</span> <span class="n">nc</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizeof</span> <span class="n">endmember</span> <span class="o">/</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">_endmembers</span><span class="p">));</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_state_h_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="si">{code_block_four}</span><span class="s2"></span>

<span class="s2">typedef struct _endmembers {{</span>
<span class="s2">  const char *(*name) (void);</span>
<span class="s2">  const char *(*formula) (void);</span>
<span class="s2">  const double (*mw) (void);</span>
<span class="s2">  double (*mu0) (double t, double p);</span>
<span class="s2">  double (*dmu0dT) (double t, double p);</span>
<span class="s2">  double (*dmu0dP) (double t, double p);</span>
<span class="s2">  double (*d2mu0dT2) (double t, double p);</span>
<span class="s2">  double (*d2mu0dTdP) (double t, double p);</span>
<span class="s2">  double (*d2mu0dP2) (double t, double p);</span>
<span class="s2">  double (*d3mu0dT3) (double t, double p);</span>
<span class="s2">  double (*d3mu0dT2dP) (double t, double p);</span>
<span class="s2">  double (*d3mu0dTdP2) (double t, double p);</span>
<span class="s2">  double (*d3mu0dP3) (double t, double p);</span>
<span class="s2">}} Endmembers;</span>

<span class="s2">static Endmembers endmember[] = {{</span>
<span class="si">{code_block_three}</span><span class="s2"></span>
<span class="s2">}};</span>
<span class="s2">static int nc = (sizeof endmember / sizeof(struct _endmembers));</span>

<span class="s2">static const double R=8.3143;</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Generate both fast computation and calibibration code for the feldspar
solution</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="s1">&#39;Feldspar&#39;</span>
<span class="n">endmembers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Albite_berman&#39;</span><span class="p">,</span> <span class="s1">&#39;Anorthite_berman&#39;</span><span class="p">,</span> <span class="s1">&#39;Potassium_Feldspar_berman&#39;</span><span class="p">]</span>
<span class="n">feldspar_phase_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">feldspar_phase_h</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">code_block_three_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">code_block_four_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">endmembers</span><span class="p">)):</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;  {</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_name,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_formula,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_mw,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_g,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_dgdt,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_dgdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d2gdt2,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d2gdtdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d2gdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt3,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt2dp,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d3gdtdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_d3gdp3</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;  },</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_four_text</span> <span class="o">+=</span> <span class="s1">&#39;#include &quot;&#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.h&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="n">code_block_one_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">code_block_two_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)):</span>
    <span class="n">symbol</span> <span class="o">=</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">paramValues</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">code_block_one_text</span> <span class="o">+=</span> <span class="s1">&#39;static const double &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">code_block_two_text</span> <span class="o">+=</span> <span class="s1">&#39;static double &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">code_block_four_text</span><span class="p">)</span>

<span class="n">feldspar_phase_c</span> <span class="o">+=</span> <span class="n">std_state_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span> \
        <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">,</span> \
        <span class="p">)</span>
<span class="n">feldspar_phase_c</span> <span class="o">+=</span> <span class="n">fast_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
        <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> \
        <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> \
        <span class="n">param_values</span><span class="o">=</span><span class="n">paramValues</span><span class="p">,</span> \
        <span class="n">git_identifier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
        <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
        <span class="n">code_block_one</span><span class="o">=</span><span class="n">code_block_one_text</span> \
        <span class="p">)</span>
<span class="n">feldspar_phase_h</span> <span class="o">+=</span> <span class="n">fast_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_solution.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feldspar_phase_h</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_solution.c&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feldspar_phase_c</span><span class="p">)</span>
<span class="n">feldspar_phase_calib_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">feldspar_phase_calib_h</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">feldspar_phase_calib_c</span> <span class="o">+=</span> <span class="n">std_state_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span> \
        <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">,</span> \
        <span class="p">)</span>
<span class="n">feldspar_phase_calib_c</span> <span class="o">+=</span> <span class="n">calib_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
        <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> \
        <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> \
        <span class="n">param_values</span><span class="o">=</span><span class="n">paramValues</span><span class="p">,</span> \
        <span class="n">git_identifier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
        <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> \
        <span class="n">code_block_two</span><span class="o">=</span><span class="n">code_block_two_text</span> \
        <span class="p">)</span>
<span class="n">feldspar_phase_calib_h</span> <span class="o">+=</span> <span class="n">calib_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_solution_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feldspar_phase_calib_h</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_solution_calib.c&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feldspar_phase_calib_c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;Albite_berman.h&quot;</span>
<span class="c1">#include &quot;Anorthite_berman.h&quot;</span>
<span class="c1">#include &quot;Potassium_Feldspar_berman.h&quot;</span>
</pre></div>
</div>
<div class="section" id="load-the-cython-jupyter-magic">
<h3>Load the Cython Jupyter magic<a class="headerlink" href="#load-the-cython-jupyter-magic" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> cython
</pre></div>
</div>
<p>Generate the C-code and python extension</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setuptools</span><span class="o">.</span><span class="n">extension</span><span class="o">.</span><span class="n">Extension</span>
<span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">undef_macros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">library_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_library_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_compile_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_link_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">export_symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">swig_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-O0, -O1, -O2, -O3, -Ofast, -Os, -Oz, -Og, -O, -O4
Specify which optimization level to use:

-O0 Means “no optimization”: this level compiles the fastest and generates the most debuggable code.

-O1 Somewhere between -O0 and -O2.

-O2 Moderate level of optimization which enables most optimizations.

-O3 Like -O2, except that it enables optimizations that take longer to perform or that may generate larger code (in an attempt to make the program run faster).

-Ofast Enables all the optimizations from -O3 along with other aggressive optimizations that may violate strict compliance with language standards.

-Os Like -O2 with extra optimizations to reduce code size.

-Oz Like -Os (and thus -O2), but reduces code size further.

-Og Like -O1. In future versions, this option might disable different optimizations in order to improve debuggability.

-O Equivalent to -O2.

-O4 and higher
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> feldspar.pyxbld
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="c1">#            module name specified by `%%cython_pyximport` magic</span>
<span class="c1">#            |        just `modname + &quot;.pyx&quot;`</span>
<span class="c1">#            |        |</span>
<span class="k">def</span> <span class="nf">make_ext</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">pyxfilename</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">setuptools.extension</span> <span class="kn">import</span> <span class="n">Extension</span>
    <span class="k">return</span> <span class="n">Extension</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span>
                     <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">pyxfilename</span><span class="p">,</span> \
                              <span class="s1">&#39;Feldspar_solution.c&#39;</span><span class="p">,</span> <span class="s1">&#39;Feldspar_solution_calib.c&#39;</span><span class="p">,</span> \
                              <span class="s1">&#39;Albite_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;Albite_berman_calib.c&#39;</span><span class="p">,</span> \
                              <span class="s1">&#39;Anorthite_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;Anorthite_berman_calib.c&#39;</span><span class="p">,</span> \
                              <span class="s1">&#39;Potassium_Feldspar_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;Potassium_Feldspar_berman_calib.c&#39;</span><span class="p">,</span> \
                             <span class="p">],</span>
                     <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">get_include</span><span class="p">()],</span> <span class="n">extra_compile_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-O3&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">feldspar</span><span class="o">.</span><span class="n">pyxbld</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">cython_pyximport</span> feldspar
import numpy as np
cimport numpy as cnp # cimport gives us access to NumPy&#39;s C API

# here we just replicate the function signature from the header
cdef extern from &quot;Feldspar_solution.h&quot;:
    double Feldspar_asymm_regular_g(double t, double p, double n[3])
cdef extern from &quot;Feldspar_solution_calib.h&quot;:
    double Feldspar_asymm_regular_calib_g(double t, double p, double n[3])

# here is the &quot;wrapper&quot; signature
def cy_Feldspar_asymm_regular_g(double t, double p, cnp.ndarray[cnp.double_t,ndim=1] n):
    result = Feldspar_asymm_regular_g(&lt;double&gt; t, &lt;double&gt; p, &lt;double*&gt; n.data)
    return result

def cy_Feldspar_asymm_regular_calib_g(double t, double p, cnp.ndarray[cnp.double_t,ndim=1] n):
    result = Feldspar_asymm_regular_calib_g(&lt;double&gt; t, &lt;double&gt; p, &lt;double*&gt; n.data)
    return result
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">cd</span> ..
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span>
</pre></div>
</div>
</div>
<div class="section" id="test-and-time-the-generated-functions-for-feldspar">
<h3>Test and time the generated functions for Feldspar<a class="headerlink" href="#test-and-time-the-generated-functions-for-feldspar" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mf">2000.00</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newCodeFast</span> <span class="o">=</span> <span class="n">cy_Feldspar_asymm_regular_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">newCodeCalib</span> <span class="o">=</span> <span class="n">cy_Feldspar_asymm_regular_calib_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">newCodeFast</span><span class="p">,</span> <span class="n">newCodeCalib</span><span class="p">,</span> <span class="n">newCodeFast</span><span class="o">-</span><span class="n">newCodeCalib</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">10194212.10545563</span> <span class="o">-</span><span class="mf">10194212.10545563</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>Instantiate the Objective-C code via Rubicon</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">cdll</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">util</span>
<span class="kn">from</span> <span class="nn">rubicon.objc</span> <span class="kn">import</span> <span class="n">ObjCClass</span><span class="p">,</span> <span class="n">objc_method</span>
<span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">find_library</span><span class="p">(</span><span class="s1">&#39;phaseobjc&#39;</span><span class="p">))</span>
<span class="n">FeldsparRaw</span> <span class="o">=</span> <span class="n">ObjCClass</span><span class="p">(</span><span class="s1">&#39;FeldsparBerman&#39;</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">FeldsparRaw</span><span class="o">.</span><span class="n">alloc</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseName</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseFormula</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Feldspar</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ctypes</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="o">*</span><span class="mi">3</span><span class="p">)()</span>
<span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">))</span>
<span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0e-12</span>
<span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">oldCode</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getGibbsFreeEnergyFromMolesOfComponents_andT_andP_</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">oldCode</span><span class="p">,</span> <span class="n">oldCode</span><span class="o">-</span><span class="n">newCodeFast</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">10210751.991823655</span> <span class="o">-</span><span class="mf">16539.886368025094</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AnCorr</span> <span class="o">=</span> <span class="mf">3.7</span><span class="o">*</span><span class="mf">4184.0</span> <span class="o">-</span> <span class="n">t</span><span class="o">*</span><span class="mf">3.7</span><span class="o">*</span><span class="mf">4184.0</span><span class="o">/</span><span class="mf">2200.0</span>
<span class="n">SnCorr</span> <span class="o">=</span> <span class="mf">3400.0</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">AnCorr</span><span class="o">+</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">SnCorr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">4807.345454545455</span>
</pre></div>
</div>
<p>Time the fast code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_Feldspar_asymm_regular_g(t, p, n))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>666 ns ± 10.5 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</pre></div>
</div>
<p>Time the calibration code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_Feldspar_asymm_regular_calib_g(t, p, n))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>678 ns ± 9.27 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</pre></div>
</div>
<p>Time the Rubicon wrapped Objective-C code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(obj.getGibbsFreeEnergyFromMolesOfComponents_andT_andP_(m, t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>52.4 µs ± 2.16 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>