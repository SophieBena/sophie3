<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>coder &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../None"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="../index.html" >
    <link rel="up" title="Module code" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="ENKI" src="../_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="../index.html">Thermoengine 1.0.1 documentation</a></li>
	
          <li class="active"><a href="index.html" accesskey="U">Module code</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <h1>Source code for coder</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">The Coder module provides code generation for symbolically defined thermodynamics.</span>

<span class="sd">This module implements a Python interface that enables the symbolic</span>
<span class="sd">specification of the thermodynamic properties of a phase with code generation</span>
<span class="sd">of the resulting model. Code may be produced for either fast computation of</span>
<span class="sd">results or model parameter calibration.</span>

<span class="sd">Code generation options:</span>
<span class="sd">    * Fast computation optimization: fixed parameters</span>
<span class="sd">    * Model calibration optimization: variable parameters</span>

<span class="sd">Classes are defined to implement standard state properties of pure components,</span>
<span class="sd">thermodynamic properties of simple solutions, and thermodynamic properties of</span>
<span class="sd">complex solid solutions that exhibit both convergent and non-convergent cation</span>
<span class="sd">order-disorder.</span>

<span class="sd">Thermodynamic properties are implemented for:</span>
<span class="sd">    * Pure phases at standard state</span>
<span class="sd">    * Simple solutions (asymmetric regular)</span>
<span class="sd">    * Complex solutions (convergent &amp; non-convergent cation order-disorder)</span>

<span class="sd">By default, models are formulated in terms of the Gibbs free energy, with</span>
<span class="sd">independent variables temperature, pressure, and (for solutions) mole numbers of</span>
<span class="sd">components. Alternatively, models may be implemented in terms of the Helmholtz</span>
<span class="sd">free energy, with independent variables temperature, volume, and mole numbers of</span>
<span class="sd">components.</span>

<span class="sd">Model formulation options:</span>
<span class="sd">    * Gibbs Free Energy G(T, P, mols) [default]</span>
<span class="sd">    * Helmholtz Free Energy A(T, V, mols)</span>


<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pyximport</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">sympy.printing.ccode</span> <span class="kn">import</span> <span class="n">C99CodePrinter</span>
<span class="kn">from</span> <span class="nn">sympy.core.function</span> <span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">UndefinedFunction</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">core</span>

<span class="kn">import</span> <span class="nn">thermoengine.coder_templates</span> <span class="k">as</span> <span class="nn">tpl</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StdStateModel&#39;</span><span class="p">,</span> <span class="s1">&#39;SimpleSolnModel&#39;</span><span class="p">,</span> <span class="s1">&#39;Debye&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span>
<span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;dXdT&#39;</span><span class="p">,</span> <span class="s1">&#39;dUdT&#39;</span><span class="p">,</span> <span class="s1">&#39;dUdP&#39;</span><span class="p">,</span> <span class="s1">&#39;dNdT&#39;</span><span class="p">,</span> <span class="s1">&#39;dNdP&#39;</span><span class="p">,</span> <span class="s1">&#39;Agamma&#39;</span><span class="p">,</span> <span class="s1">&#39;Bgamma&#39;</span><span class="p">,</span>
<span class="s1">&#39;AsubG&#39;</span><span class="p">,</span> <span class="s1">&#39;AsubH&#39;</span><span class="p">,</span> <span class="s1">&#39;AsubJ&#39;</span><span class="p">,</span> <span class="s1">&#39;AsubV&#39;</span><span class="p">,</span> <span class="s1">&#39;AsubKappa&#39;</span><span class="p">,</span> <span class="s1">&#39;AsubEx&#39;</span><span class="p">,</span>
<span class="s1">&#39;BsubG&#39;</span><span class="p">,</span> <span class="s1">&#39;BsubH&#39;</span><span class="p">,</span> <span class="s1">&#39;BsubJ&#39;</span><span class="p">,</span> <span class="s1">&#39;BsubV&#39;</span><span class="p">,</span> <span class="s1">&#39;BsubKappa&#39;</span><span class="p">,</span> <span class="s1">&#39;BsubEx&#39;</span><span class="p">,</span> <span class="s1">&#39;Expression&#39;</span><span class="p">,</span> <span class="s1">&#39;f_mu_e&#39;</span><span class="p">,</span> <span class="s1">&#39;gSolvent&#39;</span><span class="p">,</span>
<span class="s1">&#39;Implicit_Function&#39;</span><span class="p">,</span> <span class="s1">&#39;ComplexSolnModel&#39;</span><span class="p">,</span> <span class="s1">&#39;Ordering_Functions&#39;</span><span class="p">,</span> <span class="s1">&#39;Parameter&#39;</span><span class="p">,</span>
<span class="s1">&#39;SpeciationSolnModel&#39;</span><span class="p">,</span> <span class="s1">&#39;SubCodePrinter&#39;</span><span class="p">]</span>

<span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;data/coder&#39;</span>
<span class="n">AQUEOUSDIR</span> <span class="o">=</span> <span class="s1">&#39;aqueous&#39;</span>

<span class="c1">#####################################################</span>
<span class="c1"># Class to extend SymPy code printer                #</span>
<span class="c1"># Deals with powers and user function substitutions #</span>
<span class="c1">#####################################################</span>

<div class="viewcode-block" id="SubCodePrinter"><a class="viewcode-back" href="../coder.html#coder.SubCodePrinter">[docs]</a><span class="k">class</span> <span class="nc">SubCodePrinter</span><span class="p">(</span><span class="n">C99CodePrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of the C99 code printer class in SymPy</span>

<span class="sd">    Extension expands :math:`x^2`, :math:`x^3`, and :math:`x^4` as multiplication rather than</span>
<span class="sd">    pow(x, (double)n).</span>

<span class="sd">    The second implements a version of user function derivative printing</span>
<span class="sd">    specified to endmember chemical potential derivatives called externally</span>
<span class="sd">    from a C structure. (See implementation below.)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    forIndex</span>
<span class="sd">    nBasis</span>
<span class="sd">    sum_result</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nBasis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">forIndex</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span>
        <span class="n">sum_result</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nBasis</span> <span class="o">=</span> <span class="n">nBasis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_forIndex</span> <span class="o">=</span> <span class="n">forIndex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sum_result</span> <span class="o">=</span> <span class="n">sum_result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_subs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nBasis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of basis species used in printing derivatives of standard state</span>
<span class="sd">        chemical potentials</span>

<span class="sd">        See _print_derivative method for the function mu_s to illustrate</span>
<span class="sd">        functionality. nBasis is the number of basis species in an instance</span>
<span class="sd">        of the SpeciationSolnModel class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nBasis</span>

    <span class="nd">@nBasis</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nBasis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nBasis</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nBasis</span> <span class="o">=</span> <span class="n">nBasis</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">forIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Index variable used in for loop generation for printing derivatives of</span>
<span class="sd">        standard state chemical potentials</span>

<span class="sd">        See _print_derivative method for the function mu_s to illustrate</span>
<span class="sd">        functionality. forIndex is the string equivalent of the index variable</span>
<span class="sd">        (SymPy class Idx) used in summation expressions that are fed to the</span>
<span class="sd">        SpeciationSolnModel class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            [type] -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forIndex</span>

    <span class="nd">@forIndex</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">forIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forIndex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_forIndex</span> <span class="o">=</span> <span class="n">forIndex</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of assignment variable used when printing summations</span>

<span class="sd">        See _print_Sum method to illustrate functionality. When an instance of</span>
<span class="sd">        the SymPy class Sum is printed, the result is assigned to a variable of</span>
<span class="sd">        this name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_result</span>

    <span class="nd">@sum_result</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sum_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sum_result</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sum_result</span> <span class="o">=</span> <span class="n">sum_result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">print_subs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A list of tuples of expression substitutions used in doprint()</span>

<span class="sd">        Each tuple is of the form (sympy expression to be replaced, sympy</span>
<span class="sd">        expression to be substituted). Replacement is done in expressions</span>
<span class="sd">        passed to the doprint() method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_subs</span>

    <span class="nd">@print_subs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">print_subs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_subs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_subs</span> <span class="o">=</span> <span class="n">print_subs</span>

<div class="viewcode-block" id="SubCodePrinter.doprint"><a class="viewcode-back" href="../coder.html#coder.SubCodePrinter.doprint">[docs]</a>    <span class="k">def</span> <span class="nf">doprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">assign_to</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_subs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_subs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SubCodePrinter</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">assign_to</span><span class="o">=</span><span class="n">assign_to</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_print_Pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_integer</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;)*(&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">)])</span>
            <span class="k">return</span> <span class="s1">&#39;((&#39;</span> <span class="o">+</span> <span class="n">result</span> <span class="o">+</span> <span class="s1">&#39;))&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_print_Pow</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_print_Sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">low</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">high</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">function</span>
        <span class="n">result</span> <span class="o">=</span>  <span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;double sum = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;for (int &#39;</span><span class="o">+</span><span class="n">ind</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="o">+</span><span class="n">low</span><span class="o">+</span><span class="s1">&#39;; &#39;</span><span class="o">+</span><span class="n">ind</span><span class="o">+</span><span class="s1">&#39;&lt;=&#39;</span><span class="o">+</span><span class="n">high</span><span class="o">+</span><span class="s1">&#39;; &#39;</span><span class="o">+</span><span class="n">ind</span><span class="o">+</span><span class="s1">&#39;++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;sum += &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_result</span> <span class="o">+</span> <span class="s1">&#39; += sum;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_print_Derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="nb">vars</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
        <span class="n">number_of_derivatives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mu_s&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">derivative_string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(*endmember[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nBasis</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">forIndex</span><span class="o">+</span><span class="s1">&#39;-1].d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;mu0d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;)(T, P)&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order_2</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order_1</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_total</span>    <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(*endmember[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nBasis</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">forIndex</span><span class="o">+</span><span class="s1">&#39;-1].d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_total</span> <span class="o">+</span> <span class="s1">&#39;mu0d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string_1</span> <span class="o">+</span> <span class="n">derivative_order_1</span> <span class="o">+</span><span class="s1">&#39;d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string_2</span> <span class="o">+</span> <span class="n">derivative_order_2</span> <span class="o">+</span> <span class="s1">&#39;)(T, P)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">elif</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span>
            <span class="n">function_string_index</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">srepr</span><span class="p">(</span><span class="n">function</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">derivative_string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;mu0d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;)(T, P)&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order_2</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">derivative_order_1</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_total</span>    <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">function_string_index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_total</span> <span class="o">+</span> <span class="s1">&#39;mu0d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string_1</span> <span class="o">+</span> <span class="n">derivative_order_1</span> <span class="o">+</span><span class="s1">&#39;d&#39;</span>
                          <span class="o">+</span> <span class="n">derivative_string_2</span> <span class="o">+</span> <span class="n">derivative_order_2</span> <span class="o">+</span> <span class="s1">&#39;)(T, P)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">6</span> <span class="ow">and</span>
            <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gamma&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">derivative_string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;d&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;(T, P)&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order_2</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order_1</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_total</span>    <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="n">derivative_total</span> <span class="o">+</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;D&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string_1</span> <span class="o">+</span> <span class="n">derivative_order_1</span> <span class="o">+</span><span class="s1">&#39;D&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string_2</span> <span class="o">+</span> <span class="n">derivative_order_2</span> <span class="o">+</span> <span class="s1">&#39;(T, P)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="ow">and</span>
            <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gSolvent&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">derivative_string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;D&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string</span> <span class="o">+</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="s1">&#39;(T, P)&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">number_of_derivatives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">derivative_string_2</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order_2</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_string_1</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">derivative_order_1</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">derivative_total</span>    <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span> <span class="o">+</span> <span class="n">derivative_total</span> <span class="o">+</span> <span class="n">function</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;D&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string_1</span> <span class="o">+</span> <span class="n">derivative_order_1</span> <span class="o">+</span><span class="s1">&#39;D&#39;</span>
                    <span class="o">+</span> <span class="n">derivative_string_2</span> <span class="o">+</span> <span class="n">derivative_order_2</span> <span class="o">+</span> <span class="s1">&#39;(T, P)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">function</span><span class="p">),</span> <span class="n">UndefinedFunction</span><span class="p">)</span> <span class="ow">or</span>
                <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_print_Derivative</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<span class="c1">#####################################################</span>
<span class="c1"># SymPy sub-classes implementing the Born Functions #</span>
<span class="c1">#####################################################</span>

<div class="viewcode-block" id="dUdT"><a class="viewcode-back" href="../coder.html#coder.dUdT">[docs]</a><span class="k">class</span> <span class="nc">dUdT</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Third partial derivative of the Born</span>
<span class="sd">    function with respect to pressure and twice with respect to temperature</span>

<span class="sd">    Note that :math:`U = \\frac{{{\\partial ^2}B}}{{\\partial T\\partial P}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="dUdP"><a class="viewcode-back" href="../coder.html#coder.dUdP">[docs]</a><span class="k">class</span> <span class="nc">dUdP</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Third partial derivative of the Born</span>
<span class="sd">    function with respect to temperature and twice with respect to pressure</span>

<span class="sd">    Note that :math:`U = \\frac{{{\\partial ^2}B}}{{\\partial T\\partial P}}`.</span>
<span class="sd">    Identical to *dNdT*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="dNdT"><a class="viewcode-back" href="../coder.html#coder.dNdT">[docs]</a><span class="k">class</span> <span class="nc">dNdT</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Third partial derivative of the Born</span>
<span class="sd">    function with respect to temperature and twice with respect to pressure</span>

<span class="sd">    Note that :math:`N = \\frac{{{\\partial ^2}B}}{{\\partial {P^2}}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="dNdP"><a class="viewcode-back" href="../coder.html#coder.dNdP">[docs]</a><span class="k">class</span> <span class="nc">dNdP</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Third partial derivative of the Born</span>
<span class="sd">    function with respect to pressure</span>

<span class="sd">    Note that :math:`N = \\frac{{{\\partial ^2}B}}{{\\partial {P^2}}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="dXdT"><a class="viewcode-back" href="../coder.html#coder.dXdT">[docs]</a><span class="k">class</span> <span class="nc">dXdT</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Third partial derivative of the Born</span>
<span class="sd">    function with respect to temperature</span>

<span class="sd">    Note that :math:`X = \\frac{{{\\partial ^2}B}}{{\\partial {T^2}}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="dXdT.fdiff"><a class="viewcode-back" href="../coder.html#coder.dXdT.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span></div></div>

<div class="viewcode-block" id="X"><a class="viewcode-back" href="../coder.html#coder.X">[docs]</a><span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Second partial derivative of the Born</span>
<span class="sd">    function with respect to temperature</span>

<span class="sd">    Definition: :math:`X = \\frac{1}{\\varepsilon }\\left[ {{{\\left( {\\frac{{{\\partial ^2}\\ln \\varepsilon }}{{\\partial {T^2}}}} \\right)}_P} - \\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial T}}} \\right)_P^2} \\right]`</span>

<span class="sd">    Note that :math:`X = \\frac{{{\\partial ^2}B}}{{\\partial {T^2}}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="X.fdiff"><a class="viewcode-back" href="../coder.html#coder.X.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dXdT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dUdT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="N"><a class="viewcode-back" href="../coder.html#coder.N">[docs]</a><span class="k">class</span> <span class="nc">N</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Second partial derivative of the Born</span>
<span class="sd">    function with respect to pressure</span>

<span class="sd">    Definition: :math:`N = \\frac{1}{\\varepsilon }\\left[ {{{\\left( {\\frac{{{\\partial ^2}\\ln \\varepsilon }}{{\\partial {P^2}}}} \\right)}_T} - \\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial P}}} \\right)_T^2} \\right]`</span>

<span class="sd">    Note that :math:`N = \\frac{{{\\partial ^2}B}}{{\\partial {P^2}}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="N.fdiff"><a class="viewcode-back" href="../coder.html#coder.N.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dNdT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dNdP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="U"><a class="viewcode-back" href="../coder.html#coder.U">[docs]</a><span class="k">class</span> <span class="nc">U</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Second partial derivative of the Born</span>
<span class="sd">    function with respect to temperature and pressure</span>

<span class="sd">    Definition: :math:`U = \\frac{1}{\\varepsilon }\\left[ {\\left( {\\frac{{{\\partial ^2}\\ln \\varepsilon }}{{\\partial T\\partial P}}} \\right) - {{\\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial T}}} \\right)}_P}{{\\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial P}}} \\right)}_T}} \\right]`</span>

<span class="sd">    Note that :math:`U = \\frac{{{\\partial ^2}B}}{{\\partial T\\partial P}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="U.fdiff"><a class="viewcode-back" href="../coder.html#coder.U.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dUdT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dUdP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Y"><a class="viewcode-back" href="../coder.html#coder.Y">[docs]</a><span class="k">class</span> <span class="nc">Y</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Temperature derivative of the Born function</span>

<span class="sd">    Definition: :math:`Y = \\frac{1}{\\varepsilon }{\\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial T}}} \\right)_P}`</span>

<span class="sd">    Note that :math:`Y = \\frac{{\\partial B}}{{\\partial T}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="Y.fdiff"><a class="viewcode-back" href="../coder.html#coder.Y.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">X</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Q"><a class="viewcode-back" href="../coder.html#coder.Q">[docs]</a><span class="k">class</span> <span class="nc">Q</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Pressure derivative of the Born function</span>

<span class="sd">    Definition: :math:`Q = \\frac{1}{\\varepsilon }{\\left( {\\frac{{\\partial \\ln \\varepsilon }}{{\\partial P}}} \\right)_T}`</span>

<span class="sd">    Note that :math:`Q = \\frac{{\\partial B}}{{\\partial P}}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="Q.fdiff"><a class="viewcode-back" href="../coder.html#coder.Q.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">N</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="B"><a class="viewcode-back" href="../coder.html#coder.B">[docs]</a><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Born function</span>

<span class="sd">    Definition: :math:`B = - \\frac{1}{\\varepsilon }`, where</span>
<span class="sd">    :math:`\\varepsilon` is the dielectric constant of water</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="B.fdiff"><a class="viewcode-back" href="../coder.html#coder.B.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Y</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Q</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<span class="c1">#############################################################</span>
<span class="c1"># SymPy sub-classes implementing the Debye-Hckel Functions #</span>
<span class="c1">#############################################################</span>

<div class="viewcode-block" id="AsubEx"><a class="viewcode-back" href="../coder.html#coder.AsubEx">[docs]</a><span class="k">class</span> <span class="nc">AsubEx</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Temperature derivative of AsubV</span>

<span class="sd">    Definition: :math:`{A_{Ex} } = {\\left( {\\frac{{\\partial {A_V}}}{{\\partial T}}} \\right)_P}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="AsubKappa"><a class="viewcode-back" href="../coder.html#coder.AsubKappa">[docs]</a><span class="k">class</span> <span class="nc">AsubKappa</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Pressure derivative of AsubV</span>

<span class="sd">    Definition: :math:`{A_\\kappa } = {\\left( {\\frac{{\\partial {A_V}}}{{\\partial P}}} \\right)_T}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="AsubJ"><a class="viewcode-back" href="../coder.html#coder.AsubJ">[docs]</a><span class="k">class</span> <span class="nc">AsubJ</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Temperature derivative of AsubH</span>

<span class="sd">    Definition: :math:`{A_J} = {\\left( {\\frac{{\\partial {A_H}}}{{\\partial T}}} \\right)_P}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="AsubV"><a class="viewcode-back" href="../coder.html#coder.AsubV">[docs]</a><span class="k">class</span> <span class="nc">AsubV</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Pressure derivative of AsubG</span>

<span class="sd">    Definition: :math:`{A_V} = {\\left( {\\frac{{\\partial {A_G}}}{{\\partial P}}} \\right)_T}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="AsubV.fdiff"><a class="viewcode-back" href="../coder.html#coder.AsubV.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AsubEx</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AsubKappa</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AsubH"><a class="viewcode-back" href="../coder.html#coder.AsubH">[docs]</a><span class="k">class</span> <span class="nc">AsubH</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Enthalpy equivalent of the Debye-Hckel</span>
<span class="sd">    function Agamma</span>

<span class="sd">    Definition: :math:`{A_H} = {A_G} - T{\\left( {\\frac{{\\partial {A_G}}}{{\\partial T}}} \\right)_P}`</span>

<span class="sd">    Pressure derivative: :math:`\\frac{{\\partial {A_H}}}{{\\partial P}} = \\frac{{\\partial {A_G}}}{{\\partial P}} - T\\frac{{{\\partial ^2}{A_G}}}{{\\partial T\\partial P}}`</span>

<span class="sd">    or, :math:`\\frac{{\\partial {A_H}}}{{\\partial P}} = {A_V} - T{A_{Ex}}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="AsubH.fdiff"><a class="viewcode-back" href="../coder.html#coder.AsubH.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AsubJ</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AsubV</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">AsubEx</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AsubG"><a class="viewcode-back" href="../coder.html#coder.AsubG">[docs]</a><span class="k">class</span> <span class="nc">AsubG</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Gibbs free energy equivalent of the</span>
<span class="sd">    Debye-Hckel function Agamma</span>

<span class="sd">    Definition: :math:`{A_G} =  - 2\\left( {\\ln 2} \\right)RT{A_\\gamma }`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="AsubG.fdiff"><a class="viewcode-back" href="../coder.html#coder.AsubG.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">AsubG</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">AsubH</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">))</span><span class="o">/</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AsubV</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Agamma"><a class="viewcode-back" href="../coder.html#coder.Agamma">[docs]</a><span class="k">class</span> <span class="nc">Agamma</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Debye-Hckel function Agamma</span>

<span class="sd">    Temperature and pressure derivatives to third order are coded for this</span>
<span class="sd">    function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BsubEx"><a class="viewcode-back" href="../coder.html#coder.BsubEx">[docs]</a><span class="k">class</span> <span class="nc">BsubEx</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Temperature derivative of BsubV</span>

<span class="sd">    Definition: :math:`{B_{Ex} } = {\\left( {\\frac{{\\partial {B_V}}}{{\\partial T}}} \\right)_P}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BsubKappa"><a class="viewcode-back" href="../coder.html#coder.BsubKappa">[docs]</a><span class="k">class</span> <span class="nc">BsubKappa</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Pressure derivative of BsubV</span>

<span class="sd">    Definition: :math:`{B_\\kappa } = {\\left( {\\frac{{\\partial {B_V}}}{{\\partial P}}} \\right)_T}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BsubJ"><a class="viewcode-back" href="../coder.html#coder.BsubJ">[docs]</a><span class="k">class</span> <span class="nc">BsubJ</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Temperature derivative of BsubH</span>

<span class="sd">    Definition: :math:`{B_J} = {\\left( {\\frac{{\\partial {B_H}}}{{\\partial T}}} \\right)_P}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BsubV"><a class="viewcode-back" href="../coder.html#coder.BsubV">[docs]</a><span class="k">class</span> <span class="nc">BsubV</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Pressure derivative of BsubG</span>

<span class="sd">    Definition: :math:`{B_V} = {\\left( {\\frac{{\\partial {B_G}}}{{\\partial P}}} \\right)_T}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="BsubV.fdiff"><a class="viewcode-back" href="../coder.html#coder.BsubV.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BsubEx</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BsubKappa</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="BsubH"><a class="viewcode-back" href="../coder.html#coder.BsubH">[docs]</a><span class="k">class</span> <span class="nc">BsubH</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Enthalpy equivalent of the Debye-Hckel</span>
<span class="sd">    function Bgamma</span>

<span class="sd">    Definition: :math:`{B_H} = {B_G} - T{\\left( {\\frac{{\\partial {B_G}}}{{\\partial T}}} \\right)_P}`</span>

<span class="sd">    Pressure derivative: :math:`\\frac{{\\partial {B_H}}}{{\\partial P}} = \\frac{{\\partial {B_G}}}{{\\partial P}} - T\\frac{{{\\partial ^2}{B_G}}}{{\\partial T\\partial P}}`</span>

<span class="sd">    or, :math:`\\frac{{\\partial {B_H}}}{{\\partial P}} = {B_V} - T{B_{Ex}}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="BsubH.fdiff"><a class="viewcode-back" href="../coder.html#coder.BsubH.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BsubJ</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BsubV</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">BsubEx</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="BsubG"><a class="viewcode-back" href="../coder.html#coder.BsubG">[docs]</a><span class="k">class</span> <span class="nc">BsubG</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Gibbs free energy equivalent of the</span>
<span class="sd">    Debye-Hckel function Bgamma</span>

<span class="sd">    Definition: :math:`{B_G} =  - 2\\left( {\\ln 2} \\right)RT{B_\\gamma }`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="BsubG.fdiff"><a class="viewcode-back" href="../coder.html#coder.BsubG.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">BsubG</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">BsubH</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">))</span><span class="o">/</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BsubV</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Bgamma"><a class="viewcode-back" href="../coder.html#coder.Bgamma">[docs]</a><span class="k">class</span> <span class="nc">Bgamma</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Debye-Hckel function Bgamma</span>

<span class="sd">    Temperature and pressure derivatives to third order are coded for this</span>
<span class="sd">    function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<span class="c1">#########################################################</span>
<span class="c1"># SymPy sub-classes implementing the g solvent function #</span>
<span class="c1">#########################################################</span>

<div class="viewcode-block" id="gSolvent"><a class="viewcode-back" href="../coder.html#coder.gSolvent">[docs]</a><span class="k">class</span> <span class="nc">gSolvent</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: g solvent function</span>

<span class="sd">    Temperature and pressure derivatives to second order are coded for</span>
<span class="sd">    this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<span class="c1">#####################################################</span>
<span class="c1"># SymPy sub-classes implementing the Debye integral #</span>
<span class="c1">#####################################################</span>

<div class="viewcode-block" id="Debye"><a class="viewcode-back" href="../coder.html#coder.Debye">[docs]</a><span class="k">class</span> <span class="nc">Debye</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SymPy Function package extension: Debye function integral</span>

<span class="sd">    Defines symbolic derivatives using a recurrence relation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Debye.eval"><a class="viewcode-back" href="../coder.html#coder.Debye.eval">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">One</span></div>

<div class="viewcode-block" id="Debye.fdiff"><a class="viewcode-back" href="../coder.html#coder.Debye.fdiff">[docs]</a>    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a definition for the derivative of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Debye</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="o">*</span><span class="n">Debye</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>

        <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span></div></div>

<span class="c1">####################################################################</span>
<span class="c1"># Classes to store and organize information for the public classes #</span>
<span class="c1">####################################################################</span>

<div class="viewcode-block" id="Parameter"><a class="viewcode-back" href="../coder.html#coder.Parameter">[docs]</a><span class="k">class</span> <span class="nc">Parameter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class holds properties of a model parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        Name of the parameter</span>
<span class="sd">    units : str</span>
<span class="sd">        Units of the parameter</span>
<span class="sd">    expression : sympy.core.symbol.Symbol</span>
<span class="sd">        Instance of a SymPy symbol class equivalent to name</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    expression</span>
<span class="sd">    name</span>
<span class="sd">    units</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Class is utilized principally to store model parameters and model variables</span>
<span class="sd">    used by the Expression class to construct expressions for the Gibbs free</span>
<span class="sd">    energy or Helmholtz energy.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span> <span class="o">=</span> <span class="n">expression</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of the parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        String</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Units of the parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        String</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of a SymPy symbol class equivalent to property name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span></div>

<div class="viewcode-block" id="Expression"><a class="viewcode-back" href="../coder.html#coder.Expression">[docs]</a><span class="k">class</span> <span class="nc">Expression</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class holds properties of a model expression.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expression : sympy.core.symbol.Symbol</span>
<span class="sd">        Instance of a SymPy symbol class that contains the model expression</span>
<span class="sd">    params : array of instances of the Parameter class</span>
<span class="sd">        Parameter class instances provided are relevant to the expression</span>
<span class="sd">    exp_type : str</span>
<span class="sd">        &#39;unrestricted&#39; if the expression applies to the whole of (T,P) or (T,V)</span>
<span class="sd">        space</span>

<span class="sd">        &#39;restricted&#39; if the expression applies to a portion of (T,P) or (T,V)</span>
<span class="sd">        space, specified by lower_limits and upper_limits</span>
<span class="sd">    lower_limit_T : Number</span>
<span class="sd">        Lower limit of applicability of expression in T units</span>
<span class="sd">    lower_limit_PorV : Number</span>
<span class="sd">        Lower limit of applicability of expression in P or V units</span>
<span class="sd">    upper_limit_T : Number</span>
<span class="sd">        Upper limit of applicability of expression in T units</span>
<span class="sd">    upper_limit_PorV : Number</span>
<span class="sd">        Upper limit of applicability of expression in P or V units</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    exp_type</span>
<span class="sd">    expression</span>
<span class="sd">    lower_limit_PorV</span>
<span class="sd">    lower_limit_T</span>
<span class="sd">    params</span>
<span class="sd">    upper_limit_PorV</span>
<span class="sd">    upper_limit_T</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A generic expression class for defining a thermodynamic model. Multiple</span>
<span class="sd">    expressions may be used to construct the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;unrestricted&#39;</span><span class="p">,</span>
        <span class="n">lower_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">exp_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;unrestricted&#39;</span><span class="p">,</span> <span class="s1">&#39;restricted&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_exp_type</span> <span class="o">=</span> <span class="n">exp_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span> <span class="o">=</span> <span class="n">expression</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lower_limit_T</span> <span class="o">=</span> <span class="n">lower_limit_T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lower_limit_PorV</span> <span class="o">=</span> <span class="n">lower_limit_PorV</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_upper_limit_T</span> <span class="o">=</span> <span class="n">upper_limit_T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_upper_limit_PorV</span> <span class="o">=</span> <span class="n">upper_limit_PorV</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exp_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Type of expression</span>

<span class="sd">        - &#39;unrestricted&#39; if the expression applies to the whole of (T,P) or (T,V)</span>
<span class="sd">          space</span>
<span class="sd">        - &#39;restricted&#39; if the expression applies to a portion of (T,P) or (T,V)</span>
<span class="sd">          space, specified by lower_limits and upper_limits</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        String</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of a SymPy symbol class that contains the model expression</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of instances of the Parameter class</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Parameter class instances relevant to the expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lower_limit_T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lower limit of applicability of expression in temperature (K)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_limit_T</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lower_limit_PorV</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lower limit of applicability of expression in pressure (bars) or volume (J/bar)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_limit_PorV</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">upper_limit_T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upper limit of applicability of expression in temperature (K)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_limit_T</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">upper_limit_PorV</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upper limit of applicability of expression in pressure (bars) or volume (J/bar)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_limit_PorV</span></div>

<div class="viewcode-block" id="Implicit_Function"><a class="viewcode-back" href="../coder.html#coder.Implicit_Function">[docs]</a><span class="k">class</span> <span class="nc">Implicit_Function</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class holds properties of an Implicit Function</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    implicit_function : sympy.core.symbol.Symbol</span>
<span class="sd">        A SymPy expression for an implicit function in two independent (T,P or</span>
<span class="sd">        T,V) variables and one dependent variable (*f*). The function is equal</span>
<span class="sd">        to  zero; e.g., :math:`log(f) - f = 0`. This expression must be defined in</span>
<span class="sd">        terms of known parameters and Tr, Pr, T, P.</span>
<span class="sd">    dep_variable : sympy.core.symbol.Symbol</span>
<span class="sd">        A SymPy symbol for the dependent variable *f*</span>
<span class="sd">    initial_guess : sympy.core.symbol.Symbol</span>
<span class="sd">        A SymPy expression that initializes *f* in the iterative routine. This</span>
<span class="sd">        expression must be defined in terms of known parameters and Tr, Pr,</span>
<span class="sd">        T, P.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    function</span>
<span class="sd">    guess</span>
<span class="sd">    variable</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Implicit functions are solved prior to evaluating model expressions for the</span>
<span class="sd">    Gibbs free energy or Helmholtz energy.  They must be differentiable with</span>
<span class="sd">    respect to model parameters T and P, or T and V.  Typically, implicit</span>
<span class="sd">    functions are used to support expressions for equations of state, e.g.</span>
<span class="sd">    the Birch Murnaghan expression, which is implicit in V and T, when coupled</span>
<span class="sd">    with a reference pressure expression for the Gibbs free energy, which is</span>
<span class="sd">    explicit in T and P, requires an implicit function that solves for V given</span>
<span class="sd">    an input value of P.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">implicit_function</span><span class="p">,</span> <span class="n">dep_variable</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep_variable</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">implicit_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">dep_variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_guess</span> <span class="o">=</span> <span class="n">initial_guess</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A SymPy expression for an implicit function in two independent (T,P or</span>
<span class="sd">        T,V) variables and one dependent variable (*f*). The function is equal</span>
<span class="sd">        to zero; e.g., :math:`log(f) - f = 0`. This expression must be defined in</span>
<span class="sd">        terms of known parameters and Tr, Pr, T, P.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A SymPy symbol for the dependent variable *f*.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A SymPy expression that initializes *f* in the iterative routine. This</span>
<span class="sd">        expression must be defined in terms of known parameters and Tr, Pr,</span>
<span class="sd">        T, P.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guess</span></div>

<span class="c1">##################</span>
<span class="c1"># Public classes #</span>
<span class="c1">##################</span>

<div class="viewcode-block" id="StdStateModel"><a class="viewcode-back" href="../coder.html#coder.StdStateModel">[docs]</a><span class="k">class</span> <span class="nc">StdStateModel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class creates representation of standard state properties of pure phase.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_type : str</span>
<span class="sd">        Model type of &#39;TP&#39; implies that expressions are of the form of the Gibbs</span>
<span class="sd">        free energy.</span>

<span class="sd">        Model type of &#39;TV&#39; implies that expressions are of the form of the</span>
<span class="sd">        Helmholtz energy. This option is infrequently used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    a_list</span>
<span class="sd">    expression_parts</span>
<span class="sd">    g_list</span>
<span class="sd">    implicit_functions</span>
<span class="sd">    module</span>
<span class="sd">    params</span>
<span class="sd">    printer</span>
<span class="sd">    variables</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    add_expression_to_model</span>
<span class="sd">    create_calc_h_file</span>
<span class="sd">    create_calib_h_file</span>
<span class="sd">    create_code_module</span>
<span class="sd">    get_berman_std_state_database</span>
<span class="sd">    get_include_born_code</span>
<span class="sd">    get_include_debye_code</span>
<span class="sd">    get_model_param_names</span>
<span class="sd">    get_model_param_symbols</span>
<span class="sd">    get_model_param_units</span>
<span class="sd">    get_module_name</span>
<span class="sd">    get_symbol_for_p</span>
<span class="sd">    get_symbol_for_pr</span>
<span class="sd">    get_symbol_for_t</span>
<span class="sd">    get_symbol_for_tr</span>
<span class="sd">    get_symbol_for_v</span>
<span class="sd">    get_symbol_for_vr</span>
<span class="sd">    parse_formula</span>
<span class="sd">    set_include_born_code</span>
<span class="sd">    set_include_debye_code</span>
<span class="sd">    set_module_name</span>
<span class="sd">    set_reference_origin</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Class for creating a representation of the standard state properties of a</span>
<span class="sd">    stoichiometric phase.  The principal use of the class is to construct a</span>
<span class="sd">    model symbolically and to generate code that implements the model for model</span>
<span class="sd">    parameter calibration and thermodynamic property calculation.</span>

<span class="sd">    The class supports standard state models that involve integrals of the</span>
<span class="sd">    Debye function, implicit functions for equations of state, and models that</span>
<span class="sd">    require Born functions for estimation of the dielectric properties of</span>
<span class="sd">    water.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;TP&#39;</span><span class="p">):</span>
        <span class="n">function_d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Debye&quot;</span><span class="p">:</span><span class="s2">&quot;Debye&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span><span class="s2">&quot;born_B&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span><span class="s2">&quot;born_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">:</span><span class="s2">&quot;born_Q&quot;</span><span class="p">,</span>
        <span class="s2">&quot;X&quot;</span><span class="p">:</span><span class="s2">&quot;born_X&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span><span class="s2">&quot;born_U&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">:</span><span class="s2">&quot;born_N&quot;</span><span class="p">,</span> <span class="s2">&quot;dXdT&quot;</span><span class="p">:</span><span class="s2">&quot;born_dXdT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dUdT&quot;</span><span class="p">:</span><span class="s2">&quot;born_dUdT&quot;</span><span class="p">,</span> <span class="s2">&quot;dNdT&quot;</span><span class="p">:</span><span class="s2">&quot;born_dNdT&quot;</span><span class="p">,</span> <span class="s2">&quot;dUdP&quot;</span><span class="p">:</span><span class="s2">&quot;born_dUdP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dNdP&quot;</span><span class="p">:</span><span class="s2">&quot;born_dNdP&quot;</span><span class="p">,</span> <span class="s2">&quot;gSolvent&quot;</span><span class="p">:</span><span class="s2">&quot;gSolvent&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span> <span class="o">=</span> <span class="n">SubCodePrinter</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;user_functions&quot;</span><span class="p">:</span><span class="n">function_d</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dgdt&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dgdp&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dadt&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dadv&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2adt2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d2adtdv&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2adv2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adt3&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d3adt2dv&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adtdv2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adv3&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="s1">&#39;untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">=</span> <span class="n">model_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_T_r</span> <span class="o">=</span> <span class="mf">298.15</span> <span class="c1"># Kelvins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_P_r</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># bars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_V_r</span> <span class="o">=</span> <span class="mf">2.5</span>    <span class="c1"># J/bar</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">model_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span> <span class="s1">&#39;TV&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;P_r&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;V_r&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;ERROR: Unsupported model_type. Must be either &quot;TP&quot; or &quot;TV&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">DATADIR</span><span class="p">,</span>
            <span class="s1">&#39;elements.csv&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entropies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">DATADIR</span><span class="p">,</span>
            <span class="s1">&#39;entropies.csv&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_include_debye_code</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_include_born_code</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_h</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_h_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_h_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_c_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_c_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">a_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of tuples used internally by the class</span>

<span class="sd">        Each tuple contains the following entries:</span>

<span class="sd">        - [0] str - Function name for derivatives of the Helmholtz energy</span>
<span class="sd">        - [1] int - Order of temperature derivative</span>
<span class="sd">        - [2] int - Order of volume derivative</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span>

    <span class="nd">@a_list</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">a_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span> <span class="o">=</span> <span class="n">a_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of tuples used internally by the class</span>

<span class="sd">        Each tuple contains the following entries:</span>

<span class="sd">        - [0] str - Function name for derivatives of the Gibbs free energy</span>
<span class="sd">        - [1] int - Order of temperature derivative</span>
<span class="sd">        - [2] int - Order of pressure derivative</span>

<span class="sd">        Generally for internal use by the class</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span>

    <span class="nd">@g_list</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span> <span class="o">=</span> <span class="n">g_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expression_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Expression class instances</span>

<span class="sd">        A model is built by layering expression instances. Each instance may</span>
<span class="sd">        be applicable over all or a portion of the domain space of variables.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Expression class instances, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span>

    <span class="nd">@expression_parts</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">expression_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression_parts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span> <span class="o">=</span> <span class="n">expression_parts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implicit_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Implicit_Function class instances</span>

<span class="sd">        A model may require that one or more implicit function expressions be</span>
<span class="sd">        satisfied prior to evaluation of the model expressions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Implicit_Function class instances, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span>

    <span class="nd">@implicit_functions</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">implicit_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">implicit_functions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span> <span class="o">=</span> <span class="n">implicit_functions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of module</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Name of module (str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span>

    <span class="nd">@module</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">module</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Parameter class instances</span>

<span class="sd">        Parameters are calibrated quantities that define the model, like T_r</span>
<span class="sd">        and P_r.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Parameter class instances, [Parameter,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span>

    <span class="nd">@params</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="n">params</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of a SymPy code printer class used in code generation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        C99CodePrinter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span>

    <span class="nd">@printer</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span> <span class="o">=</span> <span class="n">printer</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Parameter class instances</span>

<span class="sd">        This property returns or sets an array of variables, either T, P, T_r and P_r</span>
<span class="sd">        (if model_type is TP) or T, V, T_r and V_r (if model type is equal to TV).</span>
<span class="sd">        Array elements are encapsulated as instances of the Parameter class object.</span>
<span class="sd">        This is simply done as a convenience wrapper. Note that SymPy symbols that are</span>
<span class="sd">        suitable for developing model expressions using these variables are probably</span>
<span class="sd">        more easily accessed using the methods:</span>

<span class="sd">        - get_symbol_for_t()</span>
<span class="sd">        - get_symbol_for_p()</span>

<span class="sd">        and so on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Parameter class instances, [Parameter,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

    <span class="nd">@variables</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_t"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_t">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for temperature.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : sympy.core.symbol.Symbol</span>
<span class="sd">            SymPy symbol for temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_p"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_p">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_p</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for pressure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        P : sympy symbol</span>
<span class="sd">            SymPy symbol for pressure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_v"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_v">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for volume.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V : sympy symbol</span>
<span class="sd">            SymPy symbol for volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_tr"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_tr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_tr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference temperature.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;T_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_pr"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_pr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_pr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference pressure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Pr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference pressure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;P_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_symbol_for_vr"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_symbol_for_vr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_vr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference volume.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Vr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;V_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="StdStateModel.get_module_name"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_module_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_module_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves module name.</span>

<span class="sd">        The module name is used in creating file names for coded functions.</span>
<span class="sd">        Maintained for backward compatibility.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        string : str</span>
<span class="sd">            The name of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span></div>

<div class="viewcode-block" id="StdStateModel.set_module_name"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.set_module_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_module_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves module name.</span>

<span class="sd">        The module name is used in creating file names for coded functions.</span>
<span class="sd">        Maintained for backward compatibility.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_s : str</span>
<span class="sd">            The name of the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">module_s</span></div>

<div class="viewcode-block" id="StdStateModel.set_reference_origin"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.set_reference_origin">[docs]</a>    <span class="k">def</span> <span class="nf">set_reference_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tr</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">Pr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Vr</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the reference conditions for the model.</span>

<span class="sd">        Tr must be specified along with one of Pr or Vr.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tr : float</span>
<span class="sd">             Reference temperature for the model (in Kelvins)</span>
<span class="sd">        Pr : float</span>
<span class="sd">             Reference pressure for the model (in bars)</span>
<span class="sd">        Vr : float</span>
<span class="sd">             Reference volume of the model (in J/bar)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_T_r</span> <span class="o">=</span> <span class="n">Tr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_P_r</span> <span class="o">=</span> <span class="n">Pr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_V_r</span> <span class="o">=</span> <span class="n">Vr</span></div>

<div class="viewcode-block" id="StdStateModel.get_include_debye_code"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_include_debye_code">[docs]</a>    <span class="k">def</span> <span class="nf">get_include_debye_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a boolean flag specifying whether a block of code</span>
<span class="sd">        implementing the Debye integral function will be generated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        boolean : bool</span>
<span class="sd">                  True or False (default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_debye_code</span></div>

<div class="viewcode-block" id="StdStateModel.set_include_debye_code"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.set_include_debye_code">[docs]</a>    <span class="k">def</span> <span class="nf">set_include_debye_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a boolean flag controlling the inclusion of a block of code</span>
<span class="sd">        implementing the Debye integral function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include : bool</span>
<span class="sd">                  True or False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_debye_code</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_debye_code</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="StdStateModel.get_include_born_code"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_include_born_code">[docs]</a>    <span class="k">def</span> <span class="nf">get_include_born_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a boolean flag specifying whether code implementing the Born</span>
<span class="sd">        functions will be linked to the generated module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        boolean : bool</span>
<span class="sd">                  True or False (default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_born_code</span></div>

<div class="viewcode-block" id="StdStateModel.set_include_born_code"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.set_include_born_code">[docs]</a>    <span class="k">def</span> <span class="nf">set_include_born_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a boolean flag controlling the inclusion of code implementing the</span>
<span class="sd">        Born functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include : bool</span>
<span class="sd">                  True or False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_born_code</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_born_code</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="StdStateModel.get_model_param_names"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_model_param_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of strings of model parameter names.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of str</span>
<span class="sd">            Names of model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="StdStateModel.get_model_param_units"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_model_param_units">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of strings of model parameter units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of str</span>
<span class="sd">            Units of model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="StdStateModel.get_model_param_symbols"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_model_param_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of SymPy symbols for model parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of sym.Symbol</span>
<span class="sd">            SymPy symbols for model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="StdStateModel.add_expression_to_model"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.add_expression_to_model">[docs]</a>    <span class="k">def</span> <span class="nf">add_expression_to_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
        <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;unrestricted&#39;</span><span class="p">,</span>
        <span class="n">lower_limits</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">upper_limits</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">implicit_functions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extend_restricted_functions</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an expression and associated parameters to the model.</span>

<span class="sd">        Adds an expression for the Gibbs or Helmholtz energy to the</span>
<span class="sd">        standard state model along with a description of expression parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expression : sympy.core.symbol.Symbol</span>
<span class="sd">            A SymPy expression for the Gibbs free energy (if model_type is &#39;TP&#39;)</span>
<span class="sd">            or the Helmholtz energy (if model_type is &#39;TV&#39;).</span>

<span class="sd">            The expression may contain an implicit variable, *f*, whose value</span>
<span class="sd">            is a function of T,P or T,V.  The value of *f* is determined</span>
<span class="sd">            numerically by solving the implicit_function expression (defined</span>
<span class="sd">            below) at runtime using Newton&#39;s method.</span>

<span class="sd">        params : An array of tuples</span>
<span class="sd">            Structure (string, string, SymPy expression):</span>

<span class="sd">            - [0] str - Name of the parameter</span>

<span class="sd">            - [1] str - Units of parameter</span>

<span class="sd">            - [2] sympy.core.symbol.Symbol - SymPy symbol for the parameter</span>

<span class="sd">        exp_type : str, default=&#39;unrestricted&#39;</span>
<span class="sd">            - &#39;unrestricted&#39; - Expression is applicable over the whole of T,P or T,V space.</span>

<span class="sd">            - &#39;restricted&#39; - Expression applies only between the specified</span>
<span class="sd">              lower_limits and upper_limits.</span>

<span class="sd">        lower_limits : tuple</span>
<span class="sd">            A tuple of SymPy expressions defining the inclusive lower (T,P) or</span>
<span class="sd">            (T,V) limit of applicability of the expression. Used only if</span>
<span class="sd">            exp_type is set to &#39;restricted&#39;.</span>

<span class="sd">        upper_limits : tuple</span>
<span class="sd">            A tuple of SymPy expressions defining the inclusive upper (T,P) or</span>
<span class="sd">            (T,V) limit of applicability of the expression. Used only if</span>
<span class="sd">            exp_type is set to &#39;restricted&#39;.</span>

<span class="sd">        implicit_functions : array of tuples</span>
<span class="sd">            A tuple element contains three parts:</span>

<span class="sd">            - [0] sympy.core.symbol.Symbol - SymPy expression for an implicit</span>
<span class="sd">              function in two independent (T,P or T,V) variables and one</span>
<span class="sd">              dependent variable (*f*). The function is equal to zero.</span>

<span class="sd">            - [1] sympy.core.symbol.Symbol - SymPy symbol for the dependent</span>
<span class="sd">              variable *f*.</span>

<span class="sd">            - [2] sympy.core.symbol.Symbol - SymPy expression that initializes *f*</span>
<span class="sd">              in the iterative routine. This expression must be defined in</span>
<span class="sd">              terms of known parameters and Tr, Pr, T, P.</span>

<span class="sd">        extend_restricted_functions : bool, default=True</span>
<span class="sd">            A boolean that controls whether a &quot;restricted&quot; *exp_type* is</span>
<span class="sd">            extended beyond its *upper_limits*. By default, temperature and</span>
<span class="sd">            pressure/volume derivatives of *expression* are evaluated at the</span>
<span class="sd">            *upper_limits*, and these constants are added as linear functions of</span>
<span class="sd">            *T* and *P/V* applicable and restricted to conditions *above* the</span>
<span class="sd">            *upper_limits*. You can disable the default behavior by setting</span>
<span class="sd">            *extend_restricted_functions* to *False*.  Note that, in general, the</span>
<span class="sd">            default behavior is desired as it allows entropic and volumetric</span>
<span class="sd">            contributions developed over the restricted domain of *expression*</span>
<span class="sd">            to contribute to the energy potential beyond the domain. Such</span>
<span class="sd">            behavior is consistent with SymPy Piecewise functions. Special</span>
<span class="sd">            circumstances, however, may require the default behavior to be</span>
<span class="sd">            disabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">l_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">l_exp</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span>
            <span class="n">exp_type</span><span class="o">=</span><span class="n">exp_type</span><span class="p">,</span>
            <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">lower_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">lower_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">upper_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l_exp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">implicit_functions</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">implicit_functions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Implicit_Function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">extend_restricted_functions</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">v</span> <span class="o">=</span>  <span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
                <span class="n">v</span> <span class="o">=</span>  <span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
                <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span></div>

<div class="viewcode-block" id="StdStateModel.create_calc_h_file"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.create_calc_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_calc_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s1">&#39;fast&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an include file implementing model calculations.</span>

<span class="sd">        Note that this include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model. See</span>
<span class="sd">        create_fast_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : str</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        module_type : str</span>
<span class="sd">            Generate code that executes &quot;fast&quot; but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_debye_code</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_code_for_debye_function</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_born_code</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_code_for_born_functions</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
            <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
            <span class="n">implicit_calls</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="c1"># list of lists [][], rows denote temperature derivatives, columns,</span>
            <span class="c1"># pressure derivatives</span>
            <span class="c1"># each element contains a tuple: (function, symbol for function,</span>
            <span class="c1"># sympy expression for function,</span>
            <span class="c1"># sympy expression for fully substituted function)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">imp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="p">):</span>
                    <span class="n">fn</span>       <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">function</span>
                    <span class="n">var</span>      <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">variable</span>
                    <span class="n">var_init</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">guess</span>
                    <span class="n">var_str</span>  <span class="o">=</span> <span class="s2">&quot;var&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">var_sym</span>  <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">var_str</span><span class="p">)</span>
                    <span class="n">fn_subs</span>  <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">var_sym</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span>
                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = -1.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">implicit_calls</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">var_str</span>
                        <span class="o">+</span> <span class="s2">&quot;(T, P);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">oT</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">oP</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">oT</span><span class="o">+</span><span class="n">oP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="c1"># definition of the primary implicit variable</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">var_str</span><span class="p">,</span> <span class="n">var_str</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                            <span class="k">elif</span> <span class="n">oT</span><span class="o">+</span><span class="n">oP</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                                <span class="n">var_diff</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">oP</span><span class="p">)</span>
                                <span class="n">fn_diff</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">oP</span><span class="p">),</span>
                                    <span class="n">var_diff</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="n">var_sym_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oT</span><span class="o">+</span><span class="n">oP</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;var&quot;</span>
                                    <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;d&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oT</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;Td&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oP</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;P&quot;</span><span class="p">))</span>
                                <span class="n">fn_sym_diff</span> <span class="o">=</span> <span class="n">fn_diff</span>
                                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">oo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="p">(</span><span class="n">aa</span><span class="p">,</span><span class="n">bb</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">dd</span><span class="p">)</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">:</span>
                                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">aa</span><span class="p">,</span><span class="n">cc</span><span class="p">))</span>
                                <span class="n">fn_sym_diff</span> <span class="o">=</span> <span class="n">fn_sym_diff</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">oT</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="p">(</span><span class="n">var_diff</span><span class="p">,</span> <span class="n">fn_diff</span><span class="p">,</span> <span class="n">var_sym_diff</span><span class="p">,</span>
                                        <span class="n">fn_sym_diff</span><span class="p">))</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static void &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">var_str</span>
                        <span class="o">+</span> <span class="s2">&quot;(double T, double P) {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    static double Told = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    static double Pold = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; == -1.0) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;        &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span>
                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    if ((T != Told) &amp;&amp; (P != Pold)) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        Told = T;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        Pold = P;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        double f = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        int iter = 0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        do {</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            f = &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">fn_subs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            double df = &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fn_subs</span><span class="p">,</span><span class="n">var_sym</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            if (df == 0.0) break;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; -= f/df;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; &lt;= 0.0) &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = 0.001;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            else if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; &gt;= 2.0*V_TrPr) &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = 2.0*V_TrPr;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            iter++;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        } while ((fabs(f) &gt; 0.001) &amp;&amp; (iter &lt; 200));</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">f</span>
                    <span class="o">+</span> <span class="s2">&quot;(double T, double P) {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">implicit_calls</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double result = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="c1">#</span>
                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ss_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oT</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
                        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oP</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">ooT</span><span class="p">,</span><span class="n">ooP</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ss_index</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ooT</span><span class="o">+</span><span class="n">ooP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="c1">#</span>
                <span class="n">inited</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">oP</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    result += &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;restricted&#39;</span><span class="p">:</span>
                        <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;    if(&quot;</span>
                        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">exp</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;((&quot;</span>
                                       <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                                       <span class="o">+</span> <span class="s2">&quot;) != 0.0)&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; || &quot;</span>
                        <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                        <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;        if(&quot;</span>
                        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &gt; (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(P &gt; (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &lt;= (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(P &lt;= (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;             result += &quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        }</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inited</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    result += 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
            <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
            <span class="n">implicit_calls</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="c1"># list of lists [][], rows denote temperature derivatives, columns,</span>
            <span class="c1"># volume derivatives</span>
            <span class="c1"># each element contains a tuple: (function, symbol for function,</span>
            <span class="c1"># sympy expression for function,</span>
            <span class="c1"># sympy expression for fully substituted function)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">imp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="p">):</span>
                    <span class="n">fn</span>       <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">function</span>
                    <span class="n">var</span>      <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">variable</span>
                    <span class="n">var_init</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">guess</span>
                    <span class="n">var_str</span> <span class="o">=</span> <span class="s2">&quot;var&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">var_sym</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">var_str</span><span class="p">)</span>
                    <span class="n">fn_subs</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">var_sym</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span>
                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = -1.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">implicit_calls</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">var_str</span>
                        <span class="o">+</span> <span class="s2">&quot;(T, V);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">oT</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">oV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">oT</span><span class="o">+</span><span class="n">oV</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="c1"># definition of the primary implicit variable</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">var_str</span><span class="p">,</span>
                                    <span class="n">var_str</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                            <span class="k">elif</span> <span class="n">oT</span><span class="o">+</span><span class="n">oV</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                                <span class="n">var_diff</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">oV</span><span class="p">)</span>
                                <span class="n">fn_diff</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">oV</span><span class="p">),</span>
                                    <span class="n">var_diff</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="n">var_sym_diff</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oT</span><span class="o">+</span><span class="n">oV</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;var&quot;</span>
                                    <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;d&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oT</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;Td&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oV</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>
                                <span class="n">fn_sym_diff</span> <span class="o">=</span> <span class="n">fn_diff</span>
                                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">oo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="p">(</span><span class="n">aa</span><span class="p">,</span><span class="n">bb</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">dd</span><span class="p">)</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">:</span>
                                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">aa</span><span class="p">,</span><span class="n">cc</span><span class="p">))</span>
                                <span class="n">fn_sym_diff</span> <span class="o">=</span> <span class="n">fn_sym_diff</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">oT</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">var_diff</span><span class="p">,</span> <span class="n">fn_diff</span><span class="p">,</span>
                                    <span class="n">var_sym_diff</span><span class="p">,</span> <span class="n">fn_sym_diff</span><span class="p">))</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static void &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot;(double T, double V) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    static double Told = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    static double Vold = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; == -1.0) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    if ((T != Told) &amp;&amp; (V != Vold)) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        Told = T;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        Vold = V;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        double f = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        int iter = 0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        do {</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            f = &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">fn_subs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            double df = &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fn_subs</span><span class="p">,</span><span class="n">var_sym</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            if (df == 0.0) break;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; -= f/df;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; &lt;= 0.0) &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = 0.001;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            else if (&quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; &gt;= 4.0*&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span>                  <span class="o">+</span><span class="s2">&quot;) &quot;</span> <span class="o">+</span> <span class="n">var_str</span> <span class="o">+</span> <span class="s2">&quot; = 4.0*&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">var_init</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            iter++;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        } while ((fabs(f) &gt; 0.001) &amp;&amp; (iter &lt; 200));</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oV</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_list</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">f</span>
                    <span class="o">+</span> <span class="s2">&quot;(double T, double V) {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">implicit_calls</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double result = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="c1">#</span>
                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ss_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oT</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
                        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oV</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">ooT</span><span class="p">,</span><span class="n">ooV</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ss_index</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ooT</span><span class="o">+</span><span class="n">ooV</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="c1">#</span>
                <span class="n">inited</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">oV</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    result += &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;restricted&#39;</span><span class="p">:</span>
                        <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;    if(&quot;</span>
                        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;((&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;) != 0.0)&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; || &quot;</span>
                        <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                        <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;        if(&quot;</span>
                        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &gt; (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(V &gt; (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &lt;= (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(V &lt;= (&quot;</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                        <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;             result += &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        }</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inited</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    result += 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Unsupported model_type: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_redundant_function_template</span><span class="p">(</span>
            <span class="n">model_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">v_initial_guess</span><span class="o">=</span><span class="s2">&quot;2.0&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="StdStateModel.create_calib_h_file"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.create_calib_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_calib_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a C-code include file implementing model calibration functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The calib_h include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model.</span>
<span class="sd">        See create_calib_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
            <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_dparam_&quot;</span> <span class="o">+</span> <span class="n">f</span>
                    <span class="o">+</span> <span class="s2">&quot;(double T, double P, int index) {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double result = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="c1">#</span>
                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ss_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oT</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
                        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oP</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">ooT</span><span class="p">,</span><span class="n">ooP</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ss_index</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ooT</span><span class="o">+</span><span class="n">ooP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooP</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="c1">#</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    switch (index) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;    case &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: /* &quot;</span>
                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; */ </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1">#</span>
                    <span class="n">inited</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">oP</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        result += &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;restricted&#39;</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;        if(&quot;</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">exp</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;((&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;) != 0.0)&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; || &quot;</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                            <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;            if(&quot;</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &gt; (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(P &gt; (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &lt;= (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(P &lt;= (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;                 result += &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            }</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        }</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="c1">#</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">inited</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        result += 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        break;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
            <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oV</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_list</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_dparam_&quot;</span> <span class="o">+</span> <span class="n">f</span>
                    <span class="o">+</span> <span class="s2">&quot;(double T, double V, int index) {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double result = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="c1">#</span>
                <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ss_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oT</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
                        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">oV</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">ooT</span><span class="p">,</span><span class="n">ooV</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ss_index</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ooT</span><span class="o">+</span><span class="n">ooV</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">ss_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">global_subs</span><span class="p">[</span><span class="n">ooT</span><span class="p">][</span><span class="n">ooV</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="c1">#</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    switch (index) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    case &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: /* &quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; */ </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="c1">#</span>
                    <span class="n">inited</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">oT</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">oV</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        result += &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;restricted&#39;</span><span class="p">:</span>
                            <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;        if(&quot;</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;((&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;) != 0.0)&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; || &quot;</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                            <span class="n">test_term</span> <span class="o">=</span> <span class="s2">&quot;            if(&quot;</span>
                            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &gt; (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_T</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(V &gt; (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">lower_limit_PorV</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(T &lt;= (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_T</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">test_term</span> <span class="o">+=</span> <span class="p">(</span><span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;(V &lt;= (&quot;</span>
                                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">upper_limit_PorV</span><span class="p">)</span>
                                    <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                                <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &amp;&amp; &quot;</span>
                            <span class="n">test_term</span> <span class="o">+=</span> <span class="s2">&quot;) {</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="n">test_term</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;                 result += &quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;            }</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        }</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="n">inited</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="c1">#</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">inited</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        result += 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        break;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_redundant_calib_TV_template</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Unsupported model_type: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Additional functions</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static int &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_get_param_number(void) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static const char *paramNames[&quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;] = {&quot;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;  };</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static const char *paramUnits[&quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;] = {&quot;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">param</span><span class="o">.</span><span class="n">units</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;  };</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static const char **&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_get_param_names(void) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return paramNames;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static const char **&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_get_param_units(void) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return paramUnits;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static void &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_get_param_values(double **values) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    (*values)[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;] = &quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static int &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_set_param_values(double *values) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;= values[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;];</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return 1;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_get_param_value(int index) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    double result = 0.0;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    switch (index) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    case &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        result = &quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        break;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;     default:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;         break;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;static int &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;_set_param_value(int index, double value) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    int result = 1;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    switch (index) {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    case &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot; = value;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;        break;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;     default:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;         break;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    }</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;    return result;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_h</span> <span class="o">=</span> <span class="n">s</span></div>

<div class="viewcode-block" id="StdStateModel.parse_formula"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.parse_formula">[docs]</a>    <span class="k">def</span> <span class="nf">parse_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula_string</span><span class="o">=</span><span class="s2">&quot;Si(1)O(2)&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses a chemical formula, and returns a molecular weight and an array of</span>
<span class="sd">        elemental concentrations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        formula_string : str</span>
<span class="sd">            Formula of compound specified in the standard form</span>
<span class="sd">            SiO2 -&gt; Si(1)O(2)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mw, elmvector : tuple</span>
<span class="sd">            - [0] mw is a float containing the molecular weight in grams.</span>

<span class="sd">            - [1] elmvector is a numpy array of length 120 containing the mole numbers</span>
<span class="sd">              of each element in the compound.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formula</span> <span class="o">=</span> <span class="n">formula_string</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">mw</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">elmvector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">[</span><span class="s1">&#39;Abbrv&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">mw</span> <span class="o">+=</span> <span class="n">element</span><span class="o">.</span><span class="n">MW</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">elmvector</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span></div>

<div class="viewcode-block" id="StdStateModel.get_berman_std_state_database"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.get_berman_std_state_database">[docs]</a>    <span class="k">def</span> <span class="nf">get_berman_std_state_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extend_defs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves priors from the thermodynamic database of Berman (1988).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        identifier : int</span>
<span class="sd">            Value may be None or an integer in the range (0, length of Berman</span>
<span class="sd">            database).</span>
<span class="sd">        extend_defs : bool</span>
<span class="sd">            False: The standard set of Berman parameters are retrieved.</span>

<span class="sd">            True: Additional parameters are computed, including &#39;K&#39; and</span>
<span class="sd">            &#39;K_P&#39;, the bulk modulus and its pressure derivative.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : variable</span>
<span class="sd">            If identifier is None, then the function returns an array of tuples,</span>
<span class="sd">            one for each phase in the database:</span>

<span class="sd">            - [0] database index</span>

<span class="sd">            - [1] name of the phase</span>

<span class="sd">            - [2] formula of the phase, in standard notation</span>

<span class="sd">            If identifier is an integer, then the function returns a dictionary</span>
<span class="sd">            with keys, corresponding parameter names, and values corresponding</span>
<span class="sd">            to parameter values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_TrPr&#39;</span><span class="p">,</span> <span class="s1">&#39;S_TrPr&#39;</span><span class="p">,</span> <span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">,</span> <span class="s1">&#39;k3&#39;</span><span class="p">,</span> <span class="s1">&#39;V_TrPr&#39;</span><span class="p">,</span>
            <span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;k_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;T_lambda_Pr&#39;</span><span class="p">,</span>
            <span class="s1">&#39;T_lambda_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;H_t&#39;</span><span class="p">,</span> <span class="s1">&#39;d0&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4&#39;</span><span class="p">,</span> <span class="s1">&#39;d5&#39;</span><span class="p">,</span> <span class="s1">&#39;T_D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;T_D_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;P_r&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span>
                <span class="n">DATADIR</span><span class="p">,</span> <span class="s1">&#39;berman_1988.json&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">[</span><span class="s1">&#39;T_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">298.15</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">[</span><span class="s1">&#39;P_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">if</span> <span class="n">extend_defs</span><span class="p">:</span>
                <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1000000.0</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;K_P&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">[</span><span class="s1">&#39;K_P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> \
                    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">[[</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span> <span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">)):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(1)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">identifier</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">identifier</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_berman_db</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="StdStateModel.create_code_module"><a class="viewcode-back" href="../coder.html#coder.StdStateModel.create_code_module">[docs]</a>    <span class="k">def</span> <span class="nf">create_code_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;Quartz&quot;</span><span class="p">,</span> <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Si(1)O(2)&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and writes an include and code file for a model instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : str</span>
<span class="sd">            Model instance title (e.g., phase name).  Used to name the generated</span>
<span class="sd">            function. Cannot contain blank spaces or special characters; underscore</span>
<span class="sd">            (&quot;_&quot;) is permitted. Convention capitalizes the first letter and the</span>
<span class="sd">            letter following an underscore (&quot;_&quot;) character.</span>
<span class="sd">        formula : str</span>
<span class="sd">            Chemical formula of the model instance, in standard notation.</span>
<span class="sd">            Standard notation is of the form: Element Symbol followed by</span>
<span class="sd">            parentheses enclosing a number, which may be decimalized.  E.g.,</span>
<span class="sd">            SiO2 is written as Si(1)O(2); CaMg1/2Ti1/2AlO6 is written as</span>
<span class="sd">            Ca(1)Mg(0.5)Ti(0.5)Al(1)Si(1)O(6); CaMg(CO3)2 is written as</span>
<span class="sd">            Ca(1)Mg(1)C(2)O(6).</span>
<span class="sd">        params : dict</span>
<span class="sd">            Parameter values for the model instance.</span>
<span class="sd">            The keys of this dictionary are validated against parameter symbols</span>
<span class="sd">            stored for the model.</span>
<span class="sd">        identifier : str</span>
<span class="sd">            A unique identifier for the model instance.</span>
<span class="sd">            Defaults to local date and time when module is created (rounded to</span>
<span class="sd">            the second).</span>
<span class="sd">        prefix : str</span>
<span class="sd">            Prefix to function names for Python bindings, e.g.,</span>
<span class="sd">            {prefix}_{phase}_{module}_g(T,P).</span>
<span class="sd">        module_type : str</span>
<span class="sd">            Generate code that executes &quot;fast&quot; but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        silent : bool</span>
<span class="sd">            Print (True) or do not print (False) status messages.</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language; &quot;C++&quot; is the C++ programming language.)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : Boolean</span>
<span class="sd">                 True if module is succesfully generated, False if some error occurred</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z0-9_]*$&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span>
                <span class="s2">&quot; is only allowed to have characters a-z, A-Z, 0-9, and _&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">okay</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: paramter key &quot;</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot; is missing from passed model parameter dictionary&quot;</span><span class="p">)</span>
                <span class="n">okay</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">okay</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error in params dictionary (see above)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="p">(</span><span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mw</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: parsing of the formula &quot;</span><span class="p">,</span> <span class="n">formula</span><span class="p">,</span>
                <span class="s2">&quot; retunred a molecular weight of zero&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_module_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;untitled&#39;</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: Please set module name before called this function&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic fast model code file string&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_calc_h_file</span><span class="p">(</span><span class="n">language</span><span class="p">,</span> <span class="n">module_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_h_template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model fast code template include file string&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fast_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_fast_h_template</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_c_template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model fast code template code file string&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fast_c_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_fast_c_template</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_h_template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model calib code template include file string&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calib_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_calib_h_template</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_c_template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model calib code template code file string&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calib_c_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_calib_c_template</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic calib model code file string&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create_calib_h_file</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: module_type must be set to either &#39;fast&#39; or &#39;calib&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating include file ...&quot;</span><span class="p">)</span>
        <span class="n">h_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">h_file_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
            <span class="n">h_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
            <span class="n">h_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_calc.h&quot;</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="n">h_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
            <span class="n">h_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_calib.h&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;... done!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating code file ...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>
        <span class="n">formula_condensed</span> <span class="o">=</span> <span class="n">formula</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(1)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">param_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                <span class="n">param_block</span> <span class="o">+=</span> <span class="s2">&quot;static const double &quot;</span> <span class="o">+</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span>
                <span class="n">param_block</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                <span class="n">param_block</span> <span class="o">+=</span> <span class="s2">&quot;static double &quot;</span> <span class="o">+</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span>
                <span class="n">param_block</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">param_values</span><span class="p">)</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">c_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">c_file_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
            <span class="n">c_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">formula</span><span class="o">=</span><span class="n">formula_condensed</span><span class="p">,</span> <span class="n">mw</span><span class="o">=</span><span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span><span class="o">=</span><span class="n">elmvector</span><span class="p">,</span>
                <span class="n">parameter_init_block</span><span class="o">=</span><span class="n">param_block</span><span class="p">,</span> <span class="n">git_identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
                <span class="n">include_calc_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span><span class="p">)</span>
            <span class="n">c_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_calc.c&quot;</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="n">c_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">formula</span><span class="o">=</span><span class="n">formula_condensed</span><span class="p">,</span> <span class="n">mw</span><span class="o">=</span><span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span><span class="o">=</span><span class="n">elmvector</span><span class="p">,</span>
                <span class="n">parameter_init_block</span><span class="o">=</span><span class="n">param_block</span><span class="p">,</span> <span class="n">git_identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
                <span class="n">include_calc_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span><span class="p">,</span> <span class="n">include_calib_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calib_h</span><span class="p">)</span>
            <span class="n">c_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;_calib.c&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;... done&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing include file to working directory ...&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">h_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">h_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing code file to working directory ...&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">c_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing pyxbld file to working directory ...&quot;</span><span class="p">)</span>
        <span class="n">pyxbld_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_pyxbld_template</span><span class="p">()</span>
        <span class="n">pyxbld_file</span> <span class="o">=</span> <span class="n">pyxbld_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_to_compile</span><span class="o">=</span><span class="n">c_file_name</span><span class="p">)</span>
        <span class="n">pyxbld_file_name</span> <span class="o">=</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;.pyxbld&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pyxbld_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pyxbld_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;writing pyx file to working directory ...&quot;</span><span class="p">)</span>
        <span class="n">pyx_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s2">&quot;fast&quot;</span><span class="p">:</span>
            <span class="n">pyx_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_fast_pyx_template</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s2">&quot;calib&quot;</span><span class="p">:</span>
            <span class="n">pyx_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_calib_pyx_template</span><span class="p">()</span>
        <span class="n">pyx_file</span> <span class="o">=</span> <span class="n">pyx_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">)</span>
        <span class="n">pyx_file_name</span> <span class="o">=</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;.pyx&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pyx_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pyx_file</span><span class="p">)</span>

        <span class="c1"># pyximport.install(pyximport=True, pyimport=False, build_dir=None,</span>
        <span class="c1"># build_in_temp=True, setup_args=None, reload_support=False,</span>
        <span class="c1"># load_py_module_on_import_failure=False, inplace=False,</span>
        <span class="c1"># language_level=None)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Compiling code and Python bindings ...&quot;</span><span class="p">)</span>
        <span class="n">pyximport</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">language_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Success! Import the module named &quot;</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>

<div class="viewcode-block" id="SimpleSolnModel"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel">[docs]</a><span class="k">class</span> <span class="nc">SimpleSolnModel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class creates a model of the thermodynamic properties of a simple solution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nc : int</span>
<span class="sd">        Number of thermodynamic components in the solution</span>
<span class="sd">    model_type : str</span>
<span class="sd">        Model type of &#39;TP&#39; implies that expressions are of the form of the Gibbs</span>
<span class="sd">        free energy.</span>

<span class="sd">        Model type of &#39;TV&#39; implies that expressions are of the form of the</span>
<span class="sd">        Helmholtz energy. This option is infrequently used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    a_list</span>
<span class="sd">    conversion_string</span>
<span class="sd">    d2n_g_list</span>
<span class="sd">    d3n_g_list</span>
<span class="sd">    dn_g_list</span>
<span class="sd">    expression_parts</span>
<span class="sd">    formula_string</span>
<span class="sd">    g_list</span>
<span class="sd">    implicit_functions</span>
<span class="sd">    module</span>
<span class="sd">    mu</span>
<span class="sd">    n</span>
<span class="sd">    nc</span>
<span class="sd">    nT</span>
<span class="sd">    params</span>
<span class="sd">    printer</span>
<span class="sd">    test_string</span>
<span class="sd">    variables</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    add_expression_to_model</span>
<span class="sd">    create_code_module</span>
<span class="sd">    create_conversion_code_block</span>
<span class="sd">    create_formula_code_block</span>
<span class="sd">    create_soln_calc_h_file</span>
<span class="sd">    create_soln_calib_h_file</span>
<span class="sd">    create_test_code_block</span>
<span class="sd">    get_include_dh_code</span>
<span class="sd">    get_model_param_names</span>
<span class="sd">    get_model_param_symbols</span>
<span class="sd">    get_model_param_units</span>
<span class="sd">    get_symbol_for_p</span>
<span class="sd">    get_symbol_for_pr</span>
<span class="sd">    get_symbol_for_t</span>
<span class="sd">    get_symbol_for_tr</span>
<span class="sd">    get_symbol_for_v</span>
<span class="sd">    get_symbol_for_vr</span>
<span class="sd">    set_include_dh_code</span>
<span class="sd">    set_reference_origin</span>
<span class="sd">    symmetric_index_from_2d_array</span>
<span class="sd">    symmetric_index_from_3d_array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This class is for creating a representation of the thermodynamic properties</span>
<span class="sd">    of a simple solution phase.  The principal use of the class is to construct</span>
<span class="sd">    a model symbolically and to generate code that implements the model for</span>
<span class="sd">    model parameter calibration and thermodynamic property calculation.</span>

<span class="sd">    A simple solution is one that does not contain implicit variables that need</span>
<span class="sd">    be determined via solution of conditions of homogeneous equilibrium.</span>
<span class="sd">    Examples of simple solutions include regular solutions, asymmetric binary</span>
<span class="sd">    and ternary Margules expansions, and high order Taylor series expansions of</span>
<span class="sd">    the Gibbs free energy of mixing.  Examples of solutions not compatible with</span>
<span class="sd">    this class are aqueous or liquid solutions involving complex formation</span>
<span class="sd">    (speciation) or solid solutions that include cation-ordering or composition</span>
<span class="sd">    dependent symmetry-breaking phase transitions.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;TP&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">nc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nc</span> <span class="o">=</span> <span class="n">nc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dgdt&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dgdp&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dadt&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;dadv&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2adt2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d2adtdv&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d2adv2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adt3&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;d3adt2dv&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adtdv2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d3adv3&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dn_g_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dgdn&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdndt&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdndp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdndt2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d3gdndtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdndp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndt2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdndtdp2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d4gdndp3&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d2n_g_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d2gdn2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdn2dt&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdn2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn2dt2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d4gdn2dtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn2dp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dt2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn2dtdp2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d5gdn2dp3&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d3n_g_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d3gdn3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn3dt&#39;</span><span class="p">,</span> <span class="s1">&#39;d4gdn3dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn3dt2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d5gdn3dtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d5gdn3dp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dt2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d6gdn3dtdp2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;d6gdn3dp3&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="s1">&#39;untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">=</span> <span class="n">model_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_T_r</span> <span class="o">=</span> <span class="mf">298.15</span> <span class="c1"># Kelvins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_P_r</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># bars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_V_r</span> <span class="o">=</span> <span class="mf">2.5</span>    <span class="c1"># J/bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">model_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span> <span class="s1">&#39;TV&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;P_r&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;V_r&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V_r&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_h</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_h</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_h_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_h_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_c_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_c_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formula_string</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conversion_string</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_string</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">component_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">endmember_dict</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;Agamma&quot;</span><span class="p">:</span><span class="s2">&quot;Agamma&quot;</span><span class="p">,</span> <span class="s2">&quot;Bgamma&quot;</span><span class="p">:</span><span class="s2">&quot;Bgamma&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AsubG&quot;</span><span class="p">:</span><span class="s2">&quot;AsubG&quot;</span><span class="p">,</span> <span class="s2">&quot;AsubH&quot;</span><span class="p">:</span><span class="s2">&quot;AsubH&quot;</span><span class="p">,</span> <span class="s2">&quot;AsubV&quot;</span><span class="p">:</span><span class="s2">&quot;AsubV&quot;</span><span class="p">,</span> <span class="s2">&quot;AsubJ&quot;</span><span class="p">:</span><span class="s2">&quot;AsubJ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AsubKappa&quot;</span><span class="p">:</span><span class="s2">&quot;AsubKappa&quot;</span><span class="p">,</span> <span class="s2">&quot;AsubEx&quot;</span><span class="p">:</span><span class="s2">&quot;AsubEx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BsubG&quot;</span><span class="p">:</span><span class="s2">&quot;BsubG&quot;</span><span class="p">,</span> <span class="s2">&quot;BsubH&quot;</span><span class="p">:</span><span class="s2">&quot;BsubH&quot;</span><span class="p">,</span> <span class="s2">&quot;BsubV&quot;</span><span class="p">:</span><span class="s2">&quot;BsubV&quot;</span><span class="p">,</span> <span class="s2">&quot;BsubJ&quot;</span><span class="p">:</span><span class="s2">&quot;BsubJ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BsubKappa&quot;</span><span class="p">:</span><span class="s2">&quot;BsubKappa&quot;</span><span class="p">,</span> <span class="s2">&quot;BsubEx&quot;</span><span class="p">:</span><span class="s2">&quot;BsubEx&quot;</span> <span class="p">}</span>
        <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">component_string</span> <span class="o">+=</span> <span class="s1">&#39;n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="n">ss_string</span> <span class="o">=</span> <span class="s1">&#39;mu&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">ss_string</span><span class="p">)(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">))</span>
            <span class="n">endmember_dict</span><span class="p">[</span><span class="n">ss_string</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].mu0)&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">component_string</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nT</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span> <span class="o">=</span> <span class="n">SubCodePrinter</span><span class="p">(</span>
            <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user_functions&#39;</span><span class="p">:</span><span class="n">endmember_dict</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_2d_symm_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_2d_symm_index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_3d_symm_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_3d_symm_index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>

        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of thermodynamic components in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Number of components (int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nc</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        1-d matrix of SymPy symbols for the mole numbers of thermodynamic</span>
<span class="sd">        components in the model</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SymPy Matrix object (sympy.Matrix)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SymPy expression for the total number of moles of all thermodynamic</span>
<span class="sd">        components in the solution (expressed as elements of n)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SymPy symbol object (sympy.Symbol)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nT</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        1-d matrix of SymPy symbols for the chemical potentials of thermodynamic</span>
<span class="sd">        components in the model</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SymPy Matrix object (sympy.Matrix)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">a_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of tuples used internally by the class</span>

<span class="sd">        Each tuple contains the following entries:</span>

<span class="sd">        - [0] str - Function name for derivatives of the Helmholtz energy</span>
<span class="sd">        - [1] int - Order of temperature derivative</span>
<span class="sd">        - [2] int - Order of volume derivative</span>

<span class="sd">        Generally for internal use by the class</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span>

    <span class="nd">@a_list</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">a_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a_list</span> <span class="o">=</span> <span class="n">a_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dn_g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of strings that identify first order compositional derivatives produced</span>
<span class="sd">        by the class</span>

<span class="sd">        The create_code_module(...) method generates temperature, pressure and</span>
<span class="sd">        compositional derivatives of the Gibbs free energy of solution. This property</span>
<span class="sd">        returns a list of all the first order compositional derivatives callable from</span>
<span class="sd">        the generated module. Some of these derivatives will evaluate to zero if the</span>
<span class="sd">        minimal_deriv_set method parameter is initialized to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of strings, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dn_g_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">d2n_g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of strings that identify second order compositional derivatives produced</span>
<span class="sd">        by the class</span>

<span class="sd">        The create_code_module(...) method generates temperature, pressure, and</span>
<span class="sd">        compositional derivatives of the Gibbs free energy of solution. This property</span>
<span class="sd">        returns a list of all the second order compositional derivatives callable from</span>
<span class="sd">        the generated module. The majority of these derivatives will evaluate to zero</span>
<span class="sd">        if the minimal_deriv_set method parameter is initialized to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of strings, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d2n_g_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">d3n_g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of strings that identify third order compositional derivatives produced</span>
<span class="sd">        by the class</span>

<span class="sd">        The create_code_module(...) method generates temperature, pressure, and</span>
<span class="sd">        compositional derivatives of the Gibbs free energy of solution. This property</span>
<span class="sd">        returns a list of all the third order compositional derivatives callable from</span>
<span class="sd">        the generated module. Most of these derivatives will evaluate to zero if the</span>
<span class="sd">        minimal_deriv_set method parameter is initialized to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of strings, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d3n_g_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of tuples used internally by the class</span>

<span class="sd">        Each tuple contains the following entries:</span>

<span class="sd">        - [0] str - Function name for derivatives of the Gibbs free energy</span>
<span class="sd">        - [1] int - Order of temperature derivative</span>
<span class="sd">        - [2] int - Order of pressure derivative</span>

<span class="sd">        Generally for internal use by the class</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span>

    <span class="nd">@g_list</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">g_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g_list</span> <span class="o">=</span> <span class="n">g_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expression_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Expression class instances</span>

<span class="sd">        Builds a model by layering expression instances. Each instance may be</span>
<span class="sd">        applicable over all or a portion of the domain space of variables.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Expression class instances, [Expression,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span>

    <span class="nd">@expression_parts</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">expression_parts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression_parts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span> <span class="o">=</span> <span class="n">expression_parts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implicit_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of ImplicitFunction class instances</span>

<span class="sd">        A model may require that one or more implicit function expressions be</span>
<span class="sd">        satisfied prior to evaluation of the model expressions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of ImplicitFunction class instances, [ImplicitFunction,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span>

    <span class="nd">@implicit_functions</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">implicit_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">implicit_functions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span> <span class="o">=</span> <span class="n">implicit_functions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of module</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Name of module (str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span>

    <span class="nd">@module</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">module</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Parameter class instances</span>

<span class="sd">        Parameters are calibrated quantities that define the model, like T_r and P_r.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Parameter class instances, [Parameter,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span>

    <span class="nd">@params</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="n">params</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of a SymPy code printer class used in code generation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        C99CodePrinter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span>

    <span class="nd">@printer</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span> <span class="o">=</span> <span class="n">printer</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of Parameter class instances</span>

<span class="sd">        This property returns or sets an array of variables, either T, P, T_r and P_r</span>
<span class="sd">        (if model_type is TP) or T, V, T_r and V_r  (if model type is TV).  Array</span>
<span class="sd">        elements are encapsulated as instances of the Parameter class object. This is</span>
<span class="sd">        done simply as a convenience wrapper. Note that SymPy symbols that are suitable</span>
<span class="sd">        for developing model expressions using these variables are probably more easily</span>
<span class="sd">        accessed using the methods:</span>

<span class="sd">        - get_symbol_for_t()</span>
<span class="sd">        - get_symbol_for_p()</span>

<span class="sd">        and so on</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of Parameter class instances, [Parameter,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

    <span class="nd">@variables</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formula_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        String that describes how the chemical formula of a phase will be displayed</span>

<span class="sd">        The formula string consists of a concatenation of descriptors that allow the</span>
<span class="sd">        formula of the phase to be generated from its bulk composition. An example is:</span>
<span class="sd">        &#39;Ca[Ca]Na[Na]K[K]Al[Al]Si[Si]O8&#39;, suitable for describing the compositions of</span>
<span class="sd">        feldspars in the system NaAlSi3O8 - CaAl2Si2O8 - KAlSi3O8. The terms in square</span>
<span class="sd">        brackets within the string must contain standard element symbols. These bracketed</span>
<span class="sd">        quantities are replaced by the actual number of moles of the indicated element</span>
<span class="sd">        present in one mole of the solution when the formula of the phase is requested</span>
<span class="sd">        in the generated module. Other than the bracketed quantities, the content of the</span>
<span class="sd">        string is arbitrary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formula_string</span>

    <span class="nd">@formula_string</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">formula_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula_string</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formula_string</span> <span class="o">=</span> <span class="n">formula_string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conversion_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of strings that describe how to assign mole numbers to phase components</span>

<span class="sd">        Each string in the list equates the bracketed component number to a mathematical</span>
<span class="sd">        expression involving mole numbers of elements in the bulk composition of the</span>
<span class="sd">        solution. For example, [&#39;[0]=[Na]&#39;, &#39;[1]=[Ca]&#39;, &#39;[2]=[K]&#39;], which says that all</span>
<span class="sd">        the sodium in the solution defines the moles of the 1st</span>
<span class="sd">        comment (components are indexed starting with 0), all the calcium the 2nd</span>
<span class="sd">        component, and all the potassium the 3rd.</span>

<span class="sd">        The righthand side of each expression in the list may be more complex,</span>
<span class="sd">        for example [Ca]-[Na]/2+[K], if appropriate. The conversion strings are used to</span>
<span class="sd">        convert bulk composition of the solution when expressed as elemental</span>
<span class="sd">        concentrations to concentrations of the endmember components.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of strings, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conversion_string</span>

    <span class="nd">@conversion_string</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">conversion_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conversion_string</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conversion_string</span> <span class="o">=</span> <span class="n">conversion_string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of strings that describe feasible limits on the mole numbers of phase</span>
<span class="sd">        components</span>

<span class="sd">        Each string in the list constrains the bracketed component number using a</span>
<span class="sd">        mathematical relation, e.g. [&#39;[0] &gt; 0.0&#39;, &#39;[1] &gt; 0.0&#39;, &#39;[2] &gt; 0.0&#39;],</span>
<span class="sd">        which says that the first endmember component (Components are indexed starting</span>
<span class="sd">        with 0) must always have a value greater than 0, and similarly for the 2nd and</span>
<span class="sd">        3rd components. The mathematical expressions may be complex, as &#39;[0]+[1] &gt; 0.0&#39;,</span>
<span class="sd">        or &#39;[0] - [1] &lt; 1/2&#39;, as required. The test strings are used to constrain</span>
<span class="sd">        feasible values of component mole numbers when the bulk composition of the</span>
<span class="sd">        solution is set.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of strings, [str,...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_test_string</span>

    <span class="nd">@test_string</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">test_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_string</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test_string</span> <span class="o">=</span> <span class="n">test_string</span>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_t"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_t">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for temperature.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : sympy.core.symbol.Symbol</span>
<span class="sd">            SymPy symbol for temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_p"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_p">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_p</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for pressure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        P : sympy symbol</span>
<span class="sd">            SymPy symbol for pressure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_v"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_v">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for volume.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V : sympy symbol</span>
<span class="sd">            SymPy symbol for volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_tr"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_tr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_tr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference temperature.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;T_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_pr"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_pr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_pr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference pressure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Pr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference pressure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;P_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_symbol_for_vr"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_symbol_for_vr">[docs]</a>    <span class="k">def</span> <span class="nf">get_symbol_for_vr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SymPy symbol for reference volume.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Vr : sympy symbol</span>
<span class="sd">             SymPy symbol for reference volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;V_r&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expression</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SimpleSolnModel.set_reference_origin"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.set_reference_origin">[docs]</a>    <span class="k">def</span> <span class="nf">set_reference_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tr</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">Pr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Vr</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the reference conditions for the model.</span>

<span class="sd">        Tr must be specified along with one of Pr or Vr.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tr : float</span>
<span class="sd">             Reference temperature for the model (in Kelvins)</span>
<span class="sd">        Pr : float</span>
<span class="sd">             Reference pressure for the model (in bars)</span>
<span class="sd">        Vr : float</span>
<span class="sd">             Reference volume of the model (in J/bar)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_T_r</span> <span class="o">=</span> <span class="n">Tr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_P_r</span> <span class="o">=</span> <span class="n">Pr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_V_r</span> <span class="o">=</span> <span class="n">Vr</span></div>

<div class="viewcode-block" id="SimpleSolnModel.symmetric_index_from_2d_array"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.symmetric_index_from_2d_array">[docs]</a>    <span class="k">def</span> <span class="nf">symmetric_index_from_2d_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elm</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a 2D array index, retrieves a 1D symmetric storage index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elm : tuple of int</span>
<span class="sd">            Two element tuple containing the array index</span>

<span class="sd">            Values must be in the range 1 to nc.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Index of 1D compact array corresponding to the specified element of the</span>
<span class="sd">        symmetric array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">elm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_2d_symm_index</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">elm</span><span class="p">)))</span></div>

<div class="viewcode-block" id="SimpleSolnModel.symmetric_index_from_3d_array"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.symmetric_index_from_3d_array">[docs]</a>    <span class="k">def</span> <span class="nf">symmetric_index_from_3d_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elm</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a 3D array index, retrieves a 1D symmetric storage index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elm : tuple of int</span>
<span class="sd">            Three element tuple containing the array index</span>

<span class="sd">            Values must be in the range 1 to nc.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Index of 1D compact array corresponding to the specified element of the</span>
<span class="sd">        symmetric array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">elm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elm</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">elm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_3d_symm_index</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">elm</span><span class="p">)))</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_model_param_names"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_model_param_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of strings of model parameter names.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of str</span>
<span class="sd">            Names of model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_model_param_units"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_model_param_units">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of strings of model parameter units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of str</span>
<span class="sd">            Units of model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_model_param_symbols"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_model_param_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_param_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of SymPy symbols for model parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : list of sym.Symbol</span>
<span class="sd">            SymPy symbols for model parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="SimpleSolnModel.get_include_dh_code"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.get_include_dh_code">[docs]</a>    <span class="k">def</span> <span class="nf">get_include_dh_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves boolean flag specifying whether code implementing the Debye-Hckel</span>
<span class="sd">        functions will be included in generated code.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        boolean :</span>
<span class="sd">                  True or False (default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span></div>

<div class="viewcode-block" id="SimpleSolnModel.set_include_dh_code"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.set_include_dh_code">[docs]</a>    <span class="k">def</span> <span class="nf">set_include_dh_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a boolean flag controlling the inclusion code implementing the</span>
<span class="sd">        Debye-Hckel functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include : bool</span>
<span class="sd">                  True or False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="SimpleSolnModel.add_expression_to_model"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.add_expression_to_model">[docs]</a>    <span class="k">def</span> <span class="nf">add_expression_to_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
        <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;unrestricted&#39;</span><span class="p">,</span>
        <span class="n">lower_limits</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">upper_limits</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">implicit_functions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an expression and associated parameters to the model.</span>

<span class="sd">        Adds an expression for the Gibbs or Helmholtz energy to the</span>
<span class="sd">        solution model along with a description of expression parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expression : sympy.core.symbol.Symbol</span>
<span class="sd">            A SymPy expression for the Gibbs free energy (if model_type is &#39;TP&#39;)</span>
<span class="sd">            or the Helmholtz energy (if model_type is &#39;TV&#39;).</span>

<span class="sd">            The expression may contain an implicit variable, *f*, whose value</span>
<span class="sd">            is a function of T,P or T,V.  The value of *f* is determined</span>
<span class="sd">            numerically by solving the implicit_function expression (defined</span>
<span class="sd">            below) at runtime using Newton&#39;s method.</span>

<span class="sd">        params : An array of tuples</span>
<span class="sd">            Structure (string, string, SymPy expression):</span>

<span class="sd">            - [0] str - Name of the parameter</span>

<span class="sd">            - [1] str - Units of parameter</span>

<span class="sd">            - [2] sympy.core.symbol.Symbol - SymPy symbol for the parameter</span>

<span class="sd">        exp_type : str, default=&#39;unrestricted&#39;</span>
<span class="sd">            - &#39;unrestricted&#39; - Expression is applicable over the whole of T,P or T,V space.</span>

<span class="sd">            - &#39;restricted&#39; - Expression applies only between the specified</span>
<span class="sd">              lower_limits and upper_limits.</span>

<span class="sd">        lower_limits : tuple, default (None, None)</span>
<span class="sd">            A tuple of SymPy expressions defining the inclusive lower (T,P) or</span>
<span class="sd">            (T,V) limit of applicability of the expression. Used only if</span>
<span class="sd">            exp_type is set to &#39;restricted&#39;.</span>

<span class="sd">        upper_limits : tuple, default (None, None)</span>
<span class="sd">            A tuple of SymPy expressions defining the inclusive upper (T,P) or</span>
<span class="sd">            (T,V) limit of applicability of the expression. Used only if</span>
<span class="sd">            exp_type is set to &#39;restricted&#39;.</span>

<span class="sd">        implicit_functions : Array of tuples</span>
<span class="sd">            A tuple element contains three parts:</span>

<span class="sd">            - [0] sympy.core.symbol.Symbol - SymPy expression for an implicit</span>
<span class="sd">              function in two independent (T,P or T,V) variables and one</span>
<span class="sd">              dependent variable (*f*). The function is equal to zero.</span>

<span class="sd">            - [1] sympy.core.symbol.Symbol - SymPy symbol for the dependent</span>
<span class="sd">              variable *f*.</span>

<span class="sd">            - [2] sympy.core.symbol.Symbol - SymPy expression that initializes *f*</span>
<span class="sd">              in the iterative routine. This expression must be defined in</span>
<span class="sd">              terms of known parameters and Tr, Pr, T, P.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">l_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Parameter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
        <span class="n">l_exp</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span>
            <span class="n">exp_type</span><span class="o">=</span><span class="n">exp_type</span><span class="p">,</span>
            <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">lower_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">lower_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">upper_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l_exp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">implicit_functions</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">implicit_functions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Implicit_Function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">v</span> <span class="o">=</span>  <span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
                    <span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">s</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_type</span> <span class="o">==</span> <span class="s1">&#39;TP&#39;</span><span class="p">:</span>
                <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
                <span class="n">v</span> <span class="o">=</span>  <span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">g</span> <span class="o">=</span>  <span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;TV&#39;</span><span class="p">:</span>
                <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_v</span><span class="p">()</span>
                <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Expression</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l_params</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span>
                        <span class="n">lower_limit_T</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">lower_limit_PorV</span><span class="o">=</span><span class="n">upper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">upper_limit_T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">upper_limit_PorV</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_soln_calc_h_file"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_soln_calc_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_soln_calc_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s1">&#39;fast&#39;</span><span class="p">,</span>
        <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an include file implementing model calculations.</span>

<span class="sd">        Note that this include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model. See</span>
<span class="sd">        create_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        module_type : string</span>
<span class="sd">            Generate code that executes &quot;fast&quot; but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        minimal_deriv_set : bool</span>
<span class="sd">            Generate a minimal set of compositional derivatives: dgdn, d2gdndt,</span>
<span class="sd">            d2gdndp, d3gdndt2, d3gdndtdp, d3gdndp2, d4gdndt3, d4gdndt2dp,</span>
<span class="sd">            d4gdndtdp2, d4gdndp3, d2gdn2, d3gdn2dt, d3gdn2dp, d3gdn3.  This is</span>
<span class="sd">            the subset of derivatives currently required for solution phases</span>
<span class="sd">            that are imported into the phases module. Remaining derivatives are</span>
<span class="sd">            returned with values of zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="c1"># Code for assigning mole numbers to components</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">moles_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = n[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">gen_expr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_code_for_dh_functions</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">solution_calc_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calc_template</span><span class="p">()</span>
        <span class="n">solution_derivative_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_deriv_template</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">):</span>
            <span class="c1">#print (idx, f, oT, oP)</span>
            <span class="c1"># Potential and T, P derivatives</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">exp</span><span class="o">.</span><span class="n">expression</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span>
            <span class="n">gen_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">solution_calc_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                <span class="n">g_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">),</span>
                <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>
            <span class="c1"># First compositional derivatives</span>
            <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">minimal_deriv_set</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                        <span class="o">+</span> <span class="s1">&#39;0.0&#39;</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#print (idx, f, oT, oP, j)</span>
                    <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span>
                        <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dn_g_list</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span>
                <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>
            <span class="c1"># Second compositional derivatives</span>
            <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">minimal_deriv_set</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                            <span class="o">+</span> <span class="s1">&#39;0.0&#39;</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#print (idx, f, oT, oP, j, k)</span>
                        <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span>
                            <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">d2n_g_list</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span>
                <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>
            <span class="c1"># Third compositional derivatives</span>
            <span class="n">derivative_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">minimal_deriv_set</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                                <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="s1">&#39;0.0&#39;</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1">#print (idx, f, oT, oP, j, k, l)</span>
                            <span class="n">derivative_code_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                                    <span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">l</span><span class="p">]),</span>
                                    <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">solution_derivative_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">d3n_g_list</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">derivative_code</span><span class="o">=</span><span class="n">derivative_code_text</span><span class="p">,</span>
                <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_g_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">gen_expr</span><span class="p">)</span>
        <span class="n">convenience_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_redun_template</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">convenience_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_soln_calib_h_file"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_soln_calib_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_soln_calib_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an include file implementing model parameter derivatives.</span>

<span class="sd">        Note that this include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model. See</span>
<span class="sd">        create_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="c1"># Code for assigning mole numbers to components</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">moles_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = n[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">solution_calib_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_template</span><span class="p">()</span>
        <span class="n">symparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_symbols</span><span class="p">()</span>
        <span class="n">G_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_g_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">)):</span>
            <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                <span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>

            <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">s</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;static void &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_dparam_dgdn(double T, double P, &#39;</span>
            <span class="o">+</span><span class="s1">&#39;double n[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;], int index, double result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="o">+</span> <span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;    switch (index) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">exp</span><span class="o">.</span><span class="n">expression</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;        &#39;</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span>
                        <span class="n">assign_to</span><span class="o">=</span><span class="s1">&#39;result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">switch_code_text</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    default:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">value_params</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))]</span>
        <span class="n">code_block_one_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_two_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_three_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_four_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">value_params</span><span class="p">)):</span>
            <span class="n">code_block_one_text</span>   <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    (*values)[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_two_text</span>   <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = values[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        result = &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_four_text</span>  <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = value;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">name_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_names</span><span class="p">()</span>
        <span class="n">unit_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_units</span><span class="p">()</span>
        <span class="n">extra_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_extra_template</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">extra_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_params</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
            <span class="n">names_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">name_params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span>
            <span class="n">units_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">unit_params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span>
            <span class="n">code_block_one</span><span class="o">=</span><span class="n">code_block_one_text</span><span class="p">,</span>
            <span class="n">code_block_two</span><span class="o">=</span><span class="n">code_block_two_text</span><span class="p">,</span>
            <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span>
            <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_formula_code_block"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_formula_code_block">[docs]</a>    <span class="k">def</span> <span class="nf">create_formula_code_block</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a block of code that computes a formula for this phase.</span>

<span class="sd">        The formula is formatted as specified in the property formula_string.</span>

<span class="sd">        The code block has access to the variables: T, P, and n, where</span>
<span class="sd">        n is a numpy array containing mole numbers of endmember components.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text : str</span>
<span class="sd">               A block of C code that renders the formula</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The formula string looks like: Ca[Ca]Na[Na]K[K]Al[Al]Si[Si]O8</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula_string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">elm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">chem</span><span class="o">.</span><span class="n">PERIODIC_ORDER</span><span class="p">)</span>
            <span class="n">format_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formula_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
            <span class="n">ne</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
                <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span>
                <span class="n">format_str</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">elm</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">format_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1">&#39;</span>
                    <span class="n">ne</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">text</span>  <span class="o">=</span> <span class="s1">&#39;    double sum, elm[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_nc</span><span class="p">):</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    const double *end&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].elements)();</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    int i;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    const char *fmt = &quot;&#39;</span> <span class="o">+</span> <span class="n">format_str</span> <span class="o">+</span> <span class="s1">&#39;&quot;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    char *result = (char *) malloc(&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">format_str</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;*sizeof(char));</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0, sum=0.0; i&lt;nc; i++) sum += n[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    if (sum == 0.0) return result;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">ne</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">format_out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">format_dlm</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">format_out</span> <span class="o">+=</span> <span class="n">format_dlm</span> <span class="o">+</span> <span class="s1">&#39;elm[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                    <span class="n">format_dlm</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    elm[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_nc</span><span class="p">):</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="n">delim</span> <span class="o">+</span> <span class="s1">&#39;end&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;*n[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]/sum&#39;</span>
                        <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">ne</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    sprintf(result, fmt, &#39;</span> <span class="o">+</span> <span class="n">format_out</span> <span class="o">+</span> <span class="s1">&#39;);</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    return result;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span>  <span class="o">=</span> <span class="s1">&#39;    char *result = (char *)malloc(sizeof(char));</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    return result;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_conversion_code_block"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_conversion_code_block">[docs]</a>    <span class="k">def</span> <span class="nf">create_conversion_code_block</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a block of code that computes moles of endmember components</span>
<span class="sd">        from moles of elements according to a specified recipe.</span>

<span class="sd">        The recipe is read from the property conversion_string.</span>

<span class="sd">        The code block has access to the variables: T, P, and e, where</span>
<span class="sd">        e is a numpy array containing mole numbers of elements.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text : str</span>
<span class="sd">               A block of C code that renders the conversion</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The recipe looks like: [&#39;[0]=[Na]&#39;, &#39;[1]=[Ca]&#39;, &#39;[2]=[K]&#39;],</span>
<span class="sd">        a list whose elements describe how to assign moles to each endmember.</span>
<span class="sd">        The entries in the list may contain algebraic combinations of elements</span>
<span class="sd">        [Na] and moles of endmember components [0].</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">elm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">chem</span><span class="o">.</span><span class="n">PERIODIC_ORDER</span><span class="p">)</span>
            <span class="n">text</span>  <span class="o">=</span> <span class="s1">&#39;    double *n = (double *) malloc(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nc</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;*sizeof(double));</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conversion_string</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;n[&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;e[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elm</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span>  <span class="o">=</span> <span class="s1">&#39;    double *n = (double *) calloc(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nc</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;*sizeof(double));</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    return n;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_test_code_block"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_test_code_block">[docs]</a>    <span class="k">def</span> <span class="nf">create_test_code_block</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a block of code that tests moles of endmember components</span>
<span class="sd">        according to a specified recipe to ensure that values are viable.</span>

<span class="sd">        The recipe is read from the property test_string.</span>

<span class="sd">        The code block has access to the variables: T, P, and n, where</span>
<span class="sd">        n is a numpy array containing moles of endmember components.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text : str</span>
<span class="sd">               A block of C code that renders the testing</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The recipe looks like: [&#39;[0] &gt; 0.0&#39;, &#39;[1] &gt; 0.0&#39;, &#39;[2] &gt; 0.0&#39;],</span>
<span class="sd">        a list whose elements describe how to assign moles to each endmember.</span>
<span class="sd">        The entries in the list may contain algebraic combinations of moles of</span>
<span class="sd">        endmember components [0], and the length of the list (i.e., the</span>
<span class="sd">        number of tests) is unbounded.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span>  <span class="o">=</span> <span class="s1">&#39;    int result = 1;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_test_string</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    result &amp;= (&#39;</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;n[&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;    return result;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="SimpleSolnModel.create_code_module"><a class="viewcode-back" href="../coder.html#coder.SimpleSolnModel.create_code_module">[docs]</a>    <span class="k">def</span> <span class="nf">create_code_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;Feldspar&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">endmembers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates include and code file for a model instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : str</span>
<span class="sd">            Model instance title (e.g., phase name).  Used to name the generated</span>
<span class="sd">            function. Cannot contain blank spaces or special characters; underscore</span>
<span class="sd">            (&quot;_&quot;) is permitted. Convention capitalizes the first letter and letter</span>
<span class="sd">            following an underscore (&quot;_&quot;) character.</span>
<span class="sd">        params : dict</span>
<span class="sd">            Parameter values for the model instance.</span>
<span class="sd">            The keys of this dictionary are validated against parameter symbols</span>
<span class="sd">            stored for the model.</span>
<span class="sd">        endmembers : list of str</span>
<span class="sd">            A list of prefixes for standard state property functions for the</span>
<span class="sd">            endmember components of this solution. E.g., &quot;Albite_berman&quot; will</span>
<span class="sd">            be used to call functions with names like Albite_berman_g(...)</span>
<span class="sd">            If the standard state property routines are coded by the</span>
<span class="sd">            StdStateModel Class in this module, all required functions will be</span>
<span class="sd">            generated and they will automatically be compliant with this naming</span>
<span class="sd">            convention.</span>
<span class="sd">        identifier : str</span>
<span class="sd">            A unique identifier for the model instance.</span>
<span class="sd">            Defaults to local when module is created (rounded to the second).</span>
<span class="sd">        prefix : str</span>
<span class="sd">            Prefix to function names for Python bindings, e.g.,</span>
<span class="sd">            {prefix}_{phase}_{module}_g(T,P)</span>
<span class="sd">        module_type : str</span>
<span class="sd">            Generate code that executes &quot;fast&quot;, but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        silent : bool</span>
<span class="sd">            Do not print status messages.</span>
<span class="sd">        language : str</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        minimal_deriv_set : bool</span>
<span class="sd">            Generate a minimal set of compositional derivatives: dgdn, d2gdndt,</span>
<span class="sd">            d2gdndp, d3gdndt2, d3gdndtdp, d3gdndp2, d4gdndt3, d4gdndt2dp,</span>
<span class="sd">            d4gdndtdp2, d4gdndp3, d2gdn2, d3gdn2dt, d3gdn2dp, d3gdn3.  This is</span>
<span class="sd">            the subset of derivatives currently required for solution phases</span>
<span class="sd">            that are imported into the phases module. Remaining derivatives are</span>
<span class="sd">            returned with values of zero.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : Boolean</span>
<span class="sd">                 True if module is succesfully generated, False if some error occurred</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z0-9_]*$&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span>
                <span class="s2">&quot; is only allowed to have characters a-z, A-Z, 0-9, and _&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">okay</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: paramter key &quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot; is missing from passed model parameter dictionary&quot;</span><span class="p">)</span>
                <span class="n">okay</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">okay</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error in params dictionary (see above)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
        <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;untitled&#39;</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: Please set module name before called this function&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">endmembers</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">endmembers</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating generic fast model code file string&quot;</span><span class="p">)</span>
        <span class="n">calc_h_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_soln_calc_h_file</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">module_type</span><span class="o">=</span><span class="n">module_type</span><span class="p">,</span> <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="n">minimal_deriv_set</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing include file to working directory ...&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calc.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">calc_h_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model fast code&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;template include file string&quot;</span><span class="p">)</span>
            <span class="n">fast_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_fast_include_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model fast code&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;template code file string&quot;</span><span class="p">)</span>
            <span class="n">fast_c_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_fast_code_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="n">ss_xx</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model calib code&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;template include file string&quot;</span><span class="p">)</span>
            <span class="n">calib_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_include_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating (once only) generic model calib code&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;template code file string&quot;</span><span class="p">)</span>
            <span class="n">calib_c_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_code_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating generic calib model code file string&quot;</span><span class="p">)</span>
            <span class="n">calib_h_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_soln_calib_h_file</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing include file to working directory ...&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">calib_h_file</span><span class="p">)</span>
            <span class="n">ss_xx</span> <span class="o">=</span> <span class="s1">&#39;_calib&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error: module_type must be set to either &#39;fast&#39; or &#39;calib&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating code blocks for standard state properties.&quot;</span><span class="p">)</span>
        <span class="n">code_block_three_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_four_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">endmembers</span><span class="p">)):</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;  {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_name,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_formula,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_mw,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_elements,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_g,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_dgdt,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_dgdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdt2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdtdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt3,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt2dp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdtdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdp3</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="s1">&#39;  },</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                <span class="n">code_block_four_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;#include &quot;&#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s1">&#39;_calc.h&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                <span class="n">code_block_four_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;#include &quot;&#39;</span> <span class="o">+</span> <span class="n">endmembers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s1">&#39;_calib.h&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">code_block_five_text</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_formula_code_block</span><span class="p">()</span>
        <span class="n">code_block_six_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_conversion_code_block</span><span class="p">()</span>
        <span class="n">code_block_seven_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_test_code_block</span><span class="p">()</span>

        <span class="n">code_block_one_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_two_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">sym_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_symbols</span><span class="p">()</span>
        <span class="n">name_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_names</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym_params</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">name_params</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">code_block_one_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;static const double &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span>
                <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_two_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;static double &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span>
                <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">c_file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">h_file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">symparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_symbols</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating fast code and include files ...&quot;</span><span class="p">)</span>
            <span class="n">std_state_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_std_state_include_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="n">c_file</span> <span class="o">+=</span> <span class="n">std_state_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span>
                <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">)</span>
            <span class="n">c_file</span> <span class="o">+=</span> <span class="n">fast_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> <span class="n">param_values</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                <span class="n">git_identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
                <span class="n">number_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span>
                <span class="n">code_block_one</span><span class="o">=</span><span class="n">code_block_one_text</span><span class="p">,</span>
                <span class="n">code_block_five</span><span class="o">=</span><span class="n">code_block_five_text</span><span class="p">,</span>
                <span class="n">code_block_six</span><span class="o">=</span><span class="n">code_block_six_text</span><span class="p">,</span>
                <span class="n">code_block_seven</span><span class="o">=</span><span class="n">code_block_seven_text</span><span class="p">)</span>
            <span class="n">h_file</span> <span class="o">+=</span> <span class="n">fast_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">)</span>
            <span class="n">h_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_calc.h&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing include file to working directory ...&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">h_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">h_file</span><span class="p">)</span>
            <span class="n">c_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_calc.c&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing code file to working directory ...&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">c_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c_file</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Creating calib code and include files ...&quot;</span><span class="p">)</span>
            <span class="n">std_state_h_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_std_state_include_template</span><span class="p">(</span>
                <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="n">c_file</span> <span class="o">+=</span> <span class="n">std_state_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span>
                <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">)</span>
            <span class="n">c_file</span> <span class="o">+=</span> <span class="n">calib_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> <span class="n">param_values</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                <span class="n">git_identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
                <span class="n">number_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span>
                <span class="n">code_block_two</span><span class="o">=</span><span class="n">code_block_two_text</span><span class="p">,</span>
                <span class="n">code_block_five</span><span class="o">=</span><span class="n">code_block_five_text</span><span class="p">,</span>
                <span class="n">code_block_six</span><span class="o">=</span><span class="n">code_block_six_text</span><span class="p">,</span>
                <span class="n">code_block_seven</span><span class="o">=</span><span class="n">code_block_seven_text</span><span class="p">)</span>
            <span class="n">h_file</span> <span class="o">+=</span> <span class="n">calib_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">)</span>
            <span class="n">h_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_calib.h&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing include file to working directory ...&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">h_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">h_file</span><span class="p">)</span>
            <span class="n">c_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_calib.c&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing code file to working directory ...&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">c_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;... done&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Writing pyxbld file to working directory ...&quot;</span><span class="p">)</span>
        <span class="n">pyxbld_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_pyxbld_template</span><span class="p">()</span>
        <span class="n">pyx_file_list</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">c_file_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">endmembers</span><span class="p">:</span>
            <span class="n">pyx_file_list</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span>
            <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                <span class="n">pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calc.c&#39;&quot;</span>
            <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                <span class="n">pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calib.c&#39;&quot;</span>
        <span class="n">pyxbld_file</span> <span class="o">=</span> <span class="n">pyxbld_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files_to_compile</span><span class="o">=</span><span class="n">pyx_file_list</span><span class="p">)</span>
        <span class="n">pyxbld_file_name</span> <span class="o">=</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;.pyxbld&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pyxbld_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pyxbld_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;writing pyx file to working directory ...&quot;</span><span class="p">)</span>
        <span class="n">pyx_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s2">&quot;fast&quot;</span><span class="p">:</span>
            <span class="n">pyx_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_fast_pyx_template</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s2">&quot;calib&quot;</span><span class="p">:</span>
            <span class="n">pyx_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_pyx_template</span><span class="p">()</span>
        <span class="n">pyx_file</span> <span class="o">=</span> <span class="n">pyx_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">number_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="n">number_species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">)</span>
        <span class="n">pyx_file_name</span> <span class="o">=</span> <span class="n">module</span> <span class="o">+</span> <span class="s2">&quot;.pyx&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pyx_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pyx_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Compiling code and Python bindings ...&quot;</span><span class="p">)</span>
        <span class="n">pyximport</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">language_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Success! Import the module named &quot;</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>

<div class="viewcode-block" id="Ordering_Functions"><a class="viewcode-back" href="../coder.html#coder.Ordering_Functions">[docs]</a><span class="k">class</span> <span class="nc">Ordering_Functions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class holds properties of implicit functions that describe homogeneous</span>
<span class="sd">    equilibria via cation ordering or speciation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ordering_functions : list[sympy.core.symbol.Symbol]</span>
<span class="sd">        A list of SymPy expressions defining a system of implicit multi-variable</span>
<span class="sd">        functions having 2+nc independent variables (T,P, and moles of endmember</span>
<span class="sd">        components) and one or more dependent variables (ordering parameters).</span>
<span class="sd">        The number of implicit equations in the system must equal the number of</span>
<span class="sd">        ordering parameters. The implicit function expressions must all be equal</span>
<span class="sd">        to zero; e.g., :math:`log(f) - f = 0`. The list of expressions must be</span>
<span class="sd">        defined in terms of known parameters and Tr, Pr, T, P, n.</span>
<span class="sd">    dep_variables : list[sympy.core.symbol.Symbol]</span>
<span class="sd">        A list of SymPy symbols for the dependent variables, i.e., the ordering</span>
<span class="sd">        parameters or species mole fractions</span>
<span class="sd">    initial_guesses : list[sympy.core.symbol.Symbol]</span>
<span class="sd">        SymPy expressions that initialize the ordering parameters in the</span>
<span class="sd">        iterative routines that solve the system. These expression must be</span>
<span class="sd">        defined in terms of known solution parameters and Tr, Pr, T, P, n.</span>
<span class="sd">    bounds : sympy.logic.boolalg.And</span>
<span class="sd">        An instance of the And class, as output from reduce_inequalities(),</span>
<span class="sd">        which holds a logical expression that embodies bound constraints on</span>
<span class="sd">        the ordering parameters</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bounds</span>
<span class="sd">    function</span>
<span class="sd">    guess</span>
<span class="sd">    variable</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This system of equations is solved for the ordering parameters prior to</span>
<span class="sd">    evaluating model expressions for the Gibbs free energy and its derivatives.</span>
<span class="sd">    The equations must be differentiable with respect to model parameters T and</span>
<span class="sd">    P.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ordering_functions</span><span class="p">,</span> <span class="n">dep_variables</span><span class="p">,</span> <span class="n">initial_guesses</span><span class="p">,</span>
        <span class="n">dep_bounds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">ordering_functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">dep_variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_guess</span> <span class="o">=</span> <span class="n">initial_guesses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="n">dep_bounds</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Storage for the ordering_functions parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Storage for the dep_variables parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Storage for the initial_guesses parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.core.symbol.Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guess</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Storage for the bounds parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sympy.logic.boolalg.And</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span></div>

<div class="viewcode-block" id="ComplexSolnModel"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel">[docs]</a><span class="k">class</span> <span class="nc">ComplexSolnModel</span><span class="p">(</span><span class="n">SimpleSolnModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class creates a model of the thermodynamic properties of a complex solution.</span>

<span class="sd">    Inherits all methods and functionality of the Simple Solution Model class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nc : int</span>
<span class="sd">        Number of thermodynamic components in the solution</span>
<span class="sd">    ns : int</span>
<span class="sd">        Number of ordering parameters in the solution</span>
<span class="sd">    nw : int</span>
<span class="sd">        Number of species in the solution</span>
<span class="sd">    model_type : str</span>
<span class="sd">        Model type of &#39;TP&#39; implies that expressions are of the form of the Gibbs</span>
<span class="sd">        free energy.</span>

<span class="sd">        Model type of &#39;TV&#39; implies that expressions are of the form of the</span>
<span class="sd">        Helmholtz energy. This option is infrequently used.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ns</span>
<span class="sd">    nw</span>
<span class="sd">    order_sub</span>
<span class="sd">    s</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    add_expression_to_model</span>
<span class="sd">    create_code_module</span>
<span class="sd">    create_ordering_code</span>
<span class="sd">    create_soln_calc_h_file</span>
<span class="sd">    create_soln_calib_h_file</span>
<span class="sd">    eval_asymmetric_regular_param</span>
<span class="sd">    eval_endmember</span>
<span class="sd">    eval_regular_param</span>
<span class="sd">    eval_ternary_param</span>
<span class="sd">    exchange_indices</span>
<span class="sd">    taylor_expansion</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This class is for creating a representation of the thermodynamic properties</span>
<span class="sd">    of a complex solution phase.  The principal use of the class is to construct</span>
<span class="sd">    a model symbolically and to generate code that implements the model for</span>
<span class="sd">    model parameter calibration and thermodynamic property calculation.</span>

<span class="sd">    A complex solution is one that does not contain implicit variables that need</span>
<span class="sd">    be determined via solution of conditions of homogeneous equilibrium.</span>
<span class="sd">    Examples of complex solutions include aqueous or liquid solutions involving</span>
<span class="sd">    complex formation (speciation) or solid solutions that include</span>
<span class="sd">    cation-ordering or composition dependent symmetry-breaking phase transitions.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;TP&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nc</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="n">model_type</span><span class="p">)</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="n">nc</span> <span class="k">if</span> <span class="n">nw</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">nw</span>
        <span class="k">assert</span> <span class="n">nw</span> <span class="o">&gt;=</span> <span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;Parameter nw must be equal to or exceed nc.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ns</span> <span class="o">=</span> <span class="n">ns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nw</span> <span class="o">=</span> <span class="n">nw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">component_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">ns</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">component_string</span> <span class="o">+=</span> <span class="s1">&#39;s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">component_string</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">)])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_order_sub</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
            <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_order_sub</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v</span><span class="p">,</span><span class="n">f</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order_sub</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of ordering parameters in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Number of ordering parameters in the solution (int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ns</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        1-d matrix of SymPy symbols for the ordering parameters in the model</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SymPy Matrix object (sympy.Matrix)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">order_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_sub</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of species in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Number of species in the solution (int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nw</span>

<div class="viewcode-block" id="ComplexSolnModel.taylor_expansion"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.taylor_expansion">[docs]</a>    <span class="k">def</span> <span class="nf">taylor_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mod_type</span><span class="o">=</span><span class="s1">&#39;non-convergent&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Contructs a Taylor expansion of the non-configurational Gibbs free</span>
<span class="sd">        energy of specified order using the SymPy symbols in the list var.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : int</span>
<span class="sd">            Order of the Taylor expansion. Second order is the default.</span>
<span class="sd">            The maximum order is 4.</span>
<span class="sd">        mod_type : str</span>
<span class="sd">            1) &#39;convergent&#39;: order parameter expansion only has symmetric terms</span>
<span class="sd">            2) &#39;non-convergent&#39;: order parameter expansion has all terms</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : tuple</span>
<span class="sd">            1) Number of terms in the expansion</span>
<span class="sd">            2) Taylor expansion as a SymPy expression</span>
<span class="sd">            3) List of SymPy symbols for energetic terms in the expansion</span>
<span class="sd">            4) List of SymPy expressions multiplying energetic terms in the</span>
<span class="sd">               expansion</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="k">assert</span> <span class="n">order</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Minimum order of Taylor expansion is 1.&#39;</span>
        <span class="k">assert</span> <span class="n">order</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Maximum order of Taylor expansion is 4.&#39;</span>
        <span class="k">assert</span> <span class="n">nc</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span><span class="s1">&#39;There must be at least two components in the solution.&#39;</span>
        <span class="k">assert</span> <span class="n">ns</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;There must be at least one ordering parameter &#39;</span><span class="o">+</span> \
            <span class="s1">&#39;in this solution.&#39;</span>
        <span class="k">assert</span> <span class="n">mod_type</span> <span class="o">==</span> <span class="s1">&#39;convergent&#39;</span> <span class="ow">or</span> <span class="n">mod_type</span> <span class="o">==</span> <span class="s1">&#39;non-convergent&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;mod_type must be one of &quot;convergent&quot; or &quot;non-convergent&quot;.&#39;</span>
        <span class="n">asymmetric</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">mod_type</span> <span class="o">==</span> <span class="s1">&#39;non-convergent&#39;</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">nTot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nT</span>
        <span class="n">var</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">nTot</span><span class="p">)</span> <span class="c1">#form r variables; nc-1 of these</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">taylor_coeff</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;G0&#39;</span><span class="p">)]</span>
        <span class="n">taylor_terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
        <span class="n">taylor</span> <span class="o">=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Gr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
            <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Gs&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
                <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span>
                <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Grr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)))</span>
                    <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Grs&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)))</span>
                        <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Gss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)))</span>
                    <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                            <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                <span class="s1">&#39;Grrr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>
                            <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                      <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                    <span class="s1">&#39;Grrs&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>
                                <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                          <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span>
                                <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">])</span>
                                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                            <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                <span class="s1">&#39;Grss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>
                            <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                      <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">])</span>
                            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                    <span class="s1">&#39;Gsss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>
                                <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                          <span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span>
                                <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">])</span>
                                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                                    <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                        <span class="s1">&#39;Grrrr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
                                    <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                      <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                    <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                        <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                            <span class="s1">&#39;Grrrs&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
                                        <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                           <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">]</span>
                                        <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                            <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">])</span>
                                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                    <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                        <span class="s1">&#39;Grrss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
                                    <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                        <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">]</span>
                                    <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">])</span>
                                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">asymmetric</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                        <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                            <span class="s1">&#39;Grsss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
                                        <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                        <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">]</span>
                                        <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                            <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">])</span>
                                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                    <span class="n">taylor_coeff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
                                        <span class="s1">&#39;Gssss&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>
                                    <span class="n">taylor</span> <span class="o">+=</span> <span class="n">taylor_coeff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">*</span> \
                                        <span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">]</span>
                                    <span class="n">taylor_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">var</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="p">])</span>
                                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="n">taylor</span><span class="p">,</span><span class="n">taylor_coeff</span><span class="p">,</span><span class="n">taylor_terms</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComplexSolnModel.eval_endmember"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.eval_endmember">[docs]</a>    <span class="k">def</span> <span class="nf">eval_endmember</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_val</span><span class="p">,</span> <span class="n">s_val</span><span class="p">,</span> <span class="n">taylor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates a Taylor expansion of the molar non-configurational Gibbs free</span>
<span class="sd">        energy at the specified composition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        s_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        taylor : str</span>
<span class="sd">            A SymPy expression for Taylor expansion of the non-configurational</span>
<span class="sd">            Gibbs free energy interms of the elements of n and s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            A SymPy expression for the evaluated Taylor series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;n_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;s_val must have length ns.&#39;</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>

        <span class="n">sub_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">n_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">s_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComplexSolnModel.eval_regular_param"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.eval_regular_param">[docs]</a>    <span class="k">def</span> <span class="nf">eval_regular_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nA_val</span><span class="p">,</span> <span class="n">sA_val</span><span class="p">,</span> <span class="n">nB_val</span><span class="p">,</span> <span class="n">sB_val</span><span class="p">,</span>
        <span class="n">taylor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates a Taylor expansion of the molar non-configurational Gibbs free</span>
<span class="sd">        energy equivalent to a regular solution parameter for the A-B join.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nA_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember A</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sA_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember A</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        nB_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember B</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sB_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember B</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        taylor : str</span>
<span class="sd">            A SymPy expression for Taylor expansion of the non-configurational</span>
<span class="sd">            Gibbs free energy interms of the elements of n and s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            A SymPy expression for the evaluated Taylor series</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        join A-B ==&gt;  4 ( G(A/2+B/2) - G(A)/2 - G(B)/2 )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nA_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nB_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sA_val must have length ns.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sB_val must have length ns.&#39;</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>

        <span class="n">sub_A_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_B_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_AB_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">gA</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_A_list</span><span class="p">)</span>
        <span class="n">gB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_B_list</span><span class="p">)</span>
        <span class="n">gAB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_AB_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">4</span><span class="o">*</span><span class="n">gAB</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">gA</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">gB</span></div>

<div class="viewcode-block" id="ComplexSolnModel.eval_asymmetric_regular_param"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.eval_asymmetric_regular_param">[docs]</a>    <span class="k">def</span> <span class="nf">eval_asymmetric_regular_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nA_val</span><span class="p">,</span> <span class="n">sA_val</span><span class="p">,</span> <span class="n">nB_val</span><span class="p">,</span> <span class="n">sB_val</span><span class="p">,</span>
        <span class="n">taylor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates a Taylor expansion of the molar non-configurational Gibbs free</span>
<span class="sd">        energy equivalent to an asymmetric regular solution parameter.</span>

<span class="sd">        This method yields a quantity DW, related to the asymmetric regular</span>
<span class="sd">        solution parameters, W112 and W122, as W + DW and W - DW:</span>

<span class="sd">        dW = (27/2)G(2A/3+B/3) - 12G(A/2+B/2) - 3G(A) + 3G(B)/2</span>

<span class="sd">        See method eval_regular_param to obtain W.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nA_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember A</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sA_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember A</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        nB_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember B</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sB_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember B</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        taylor : str</span>
<span class="sd">            A SymPy expression for Taylor expansion of the non-configurational</span>
<span class="sd">            Gibbs free energy interms of the elements of n and s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            A SymPy expression for the evaluated Taylor series</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        join A-B ==&gt;  (1/3)(2/3)(W + dW(2/3-1/3)) =  G(2A/3+B/3)-2G(A)/3-G(B)/3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nA_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nB_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sA_val must have length ns.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sB_val must have length ns.&#39;</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>

        <span class="n">sub_A_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_B_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_AB_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_2AB_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_2AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_2AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="n">gA</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_A_list</span><span class="p">)</span>
        <span class="n">gB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_B_list</span><span class="p">)</span>
        <span class="n">gAB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_AB_list</span><span class="p">)</span>
        <span class="n">g2AB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_2AB_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">g2AB</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">gAB</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">gA</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gB</span></div>

<div class="viewcode-block" id="ComplexSolnModel.eval_ternary_param"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.eval_ternary_param">[docs]</a>    <span class="k">def</span> <span class="nf">eval_ternary_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nA_val</span><span class="p">,</span> <span class="n">sA_val</span><span class="p">,</span> <span class="n">nB_val</span><span class="p">,</span> <span class="n">sB_val</span><span class="p">,</span> <span class="n">nC_val</span><span class="p">,</span> <span class="n">sC_val</span><span class="p">,</span>
        <span class="n">taylor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates a Taylor expansion of the molar non-configurational Gibbs free energy equivalent to a strict ternary solution parameter.</span>

<span class="sd">        WT = 27G(A/3+B/3+C/3) - 12G(A/2+B/2) - 12G(A/2,C/2) - 12G(B/2,C/2) + 3G(A) +</span>
<span class="sd">        3G(B) + 3G(C)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nA_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember A</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sA_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember A</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        nB_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember B</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sB_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember B</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        nC_val : []</span>
<span class="sd">            List of SymPy constants providing composition in terms of solution</span>
<span class="sd">            components of endmember C</span>

<span class="sd">            Must have length nc</span>
<span class="sd">        sC_val : []</span>
<span class="sd">            List of SymPy constants providing values of ordering parameters for</span>
<span class="sd">            the specified composition of endmember C</span>

<span class="sd">            Must have length ns</span>
<span class="sd">        taylor : str</span>
<span class="sd">            A SymPy expression for Taylor expansion of the non-configurational</span>
<span class="sd">            Gibbs free energy interms of the elements of n and s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            A SymPy expression for the evaluated Taylor series</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A-B-C ==&gt; (1/27) W(A,B,C) + (1/9) W(A,B) + (1/9) W(A,C) + (1/9) W(B,C)</span>
<span class="sd">               = G(A/3+B/3+C/3) - G(A)/3 - G(B)/3 - G(C)/3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nA_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nB_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nC_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;nC_val must have length nc.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sA_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sA_val must have length ns.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sB_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sB_val must have length ns.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sC_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span> <span class="s1">&#39;sC_val must have length ns.&#39;</span>

        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>

        <span class="n">sub_A_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_B_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_C_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_AB_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_AC_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_BC_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_ABC_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_C_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nC_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_AC_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_BC_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_ABC_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">nA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">nC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">sub_A_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_B_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_C_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sC_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">sub_AB_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_AC_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_BC_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">sub_ABC_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="n">sA_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sB_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sC_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="n">gA</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_A_list</span><span class="p">)</span>
        <span class="n">gB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_B_list</span><span class="p">)</span>
        <span class="n">gC</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_C_list</span><span class="p">)</span>
        <span class="n">gAB</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_AB_list</span><span class="p">)</span>
        <span class="n">gAC</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_AC_list</span><span class="p">)</span>
        <span class="n">gBC</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_BC_list</span><span class="p">)</span>
        <span class="n">gABC</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_ABC_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">27</span><span class="o">*</span><span class="n">gABC</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">gAB</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">gAC</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">gBC</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">gA</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">gB</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">gC</span></div>

<div class="viewcode-block" id="ComplexSolnModel.add_expression_to_model"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.add_expression_to_model">[docs]</a>    <span class="k">def</span> <span class="nf">add_expression_to_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
        <span class="n">ordering_functions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an expression and associated parameters to the model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expression : sympy.core.symbol.Symbol</span>
<span class="sd">            A SymPy expression for the Gibbs free energy (if model_type is &#39;TP&#39;)</span>
<span class="sd">            or the Helmholtz energy (if model_type is &#39;TV&#39;).</span>

<span class="sd">            The expression may contain an implicit variable, *f*, whose value</span>
<span class="sd">            is a function of T,P or T,V.  The value of *f* is determined</span>
<span class="sd">            numerically by solving the implicit_function expression (defined</span>
<span class="sd">            below) at runtime using Newton&#39;s method.</span>

<span class="sd">        params : An array of tuples</span>
<span class="sd">            Structure (string, string, SymPy expression):</span>

<span class="sd">            - [0] str - Name of the parameter</span>

<span class="sd">            - [1] str - Units of parameter</span>

<span class="sd">            - [2] sympy.core.symbol.Symbol - SymPy symbol for the parameter</span>

<span class="sd">        ordering_functions : tuple</span>
<span class="sd">            A tuple element contains four parts:</span>

<span class="sd">            - [0] [sympy.core.symbol.Symbol] - List of SymPy expressions for a</span>
<span class="sd">              system of implicit functions in independent variables T,P,n, and one</span>
<span class="sd">              or more dependent variables (ordering parameters). Each of the functions</span>
<span class="sd">              in the system must evaluate to zero.</span>

<span class="sd">            - [1] [sympy.core.symbol.Symbol] - List of SymPy symbols for the</span>
<span class="sd">              dependent variables in the specified system.</span>

<span class="sd">            - [2] [sympy.core.symbol.Symbol] - List of SymPy expressions that</span>
<span class="sd">              initialize the ordering parameters in the iterative routine that</span>
<span class="sd">              solve the system of implicit functions.</span>

<span class="sd">            - [3] [sympy.logic.boolalg.And] - An instance of the And class, as</span>
<span class="sd">              output from reduce_inequalities(), that holds a logical expression</span>
<span class="sd">              that embodies bound constraints on the ordering parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ComplexSolnModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_expression_to_model</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ordering_functions</span><span class="p">:</span>
            <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">ordering_functions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span> <span class="o">=</span> <span class="n">Ordering_Functions</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComplexSolnModel.create_ordering_code"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.create_ordering_code">[docs]</a>    <span class="k">def</span> <span class="nf">create_ordering_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moles_assign_text</span><span class="p">,</span> <span class="n">order_assign_text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates ordering function code for a complex solution model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        moles_assign_text : str</span>
<span class="sd">            Text string containing C code for assigning moles of each</span>
<span class="sd">            component (n1, n2, ..., nc) from a vector of moles, n.</span>

<span class="sd">        order_assign_text : str</span>
<span class="sd">            Text string containing C code for assigning values of each</span>
<span class="sd">            ordering variable (s1, s2, ..., ss) from a vector, s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            String of code that implements ordering functions and derivatives.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">n</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">s</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>

        <span class="n">iter_max</span> <span class="o">=</span> <span class="mi">200</span>

        <span class="n">cb_0</span> <span class="o">=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;    double &#39;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">cb_0</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39;s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
        <span class="n">cb_0</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">cb_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">cb_2</span> <span class="o">+=</span> <span class="s1">&#39;        s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = s[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_3</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">cb_4</span>  <span class="o">=</span> <span class="s1">&#39;        do { </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_4</span> <span class="o">+=</span> <span class="s1">&#39;            steplength /= 2.0;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="n">order_assign_text</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="c1"># (fabs(sNew[0]-sOld[0]) &gt; 10.0*DBL_EPSILON) ||</span>
            <span class="n">cb_1</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39;(fabs(s[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]-sOld[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="s1">&#39;]) &gt; 10.0*DBL_EPSILON)&#39;</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39; || &#39;</span>
            <span class="c1"># dgds[0] = DGDS0;</span>
            <span class="n">cb_2</span> <span class="o">+=</span> <span class="s1">&#39;        dgds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">cb_2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="c1"># invd2gds2[0][0] = D2GDS0S0;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">cb_3</span> <span class="o">+=</span> <span class="s1">&#39;        invd2gds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">cb_3</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">cb_3</span> <span class="o">+=</span> <span class="s1">&#39;        invd2gds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                            <span class="s1">&#39;] = invd2gds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="c1">###########################################</span>
            <span class="c1"># bound constraints on ordering parameters#</span>
            <span class="c1">###########################################</span>
            <span class="n">cb_4</span> <span class="o">+=</span> <span class="s1">&#39;            s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = sOld[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> \
                   <span class="o">+</span> <span class="s1">&#39;]+ steplength*deltaS[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">cb_3</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cb_3</span> <span class="o">+=</span> <span class="s1">&#39;        invd2gds2[0][0] = 1.0/invd2gds2[0][0];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cb_3</span> <span class="o">+=</span> <span class="s1">&#39;        gaussj(invd2gds2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_4</span> <span class="o">+=</span> <span class="s1">&#39;        } while(!(&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> \
              <span class="o">+</span> <span class="s1">&#39;) &amp;&amp; (steplength &gt; DBL_EPSILON));</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_4</span> <span class="o">+=</span> <span class="s1">&#39;        if (steplength &lt;= DBL_EPSILON) iter = 200;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">cb_5</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_5</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_6</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_6</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_7</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_7</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_8</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdn2ds[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_8</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_9</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdndsdt[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;], d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_9</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>

        <span class="n">cb_10</span> <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdndsdp[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_11</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_12</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                 <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_13</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                 <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="c1"># d2gdnds[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdnds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_5</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="c1"># d3gdndsdt[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdndsdt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_9</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="c1"># d3gdndsdp[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdndsdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="c1"># d3gdn2ds[{NC}][{NC}][{NS}]</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> \
                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_8</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">cb_8</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="c1"># d3gdnds2[{NC}][{NS}][{NS}]</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> \
                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                        <span class="n">cb_8</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">cb_9</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">cb_10</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                 <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                 <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="c1"># d2gdsdt[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_6</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d2gdsdp[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_7</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdt2[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdtdp[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">))</span> \
               <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdp2[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="c1"># d3gds2dt[{NS}][{NS}]</span>
                <span class="n">a</span>  <span class="o">=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">cb_9</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                          <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_11</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1"># d3gds2dp[{NS}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_13</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="c1"># d3gds3[{NS}][{NS}][{NS}]</span>
                    <span class="n">a</span>  <span class="o">=</span> <span class="s1">&#39;    d3gds3[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> \
                         <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
                    <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_ordering_code_template</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">NS</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">NC</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">MAX_ITER</span><span class="o">=</span><span class="n">iter_max</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_ZERO</span><span class="o">=</span><span class="n">cb_0</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_ONE</span><span class="o">=</span><span class="n">cb_1</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_TWO</span><span class="o">=</span><span class="n">cb_2</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_THREE</span><span class="o">=</span><span class="n">cb_3</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_FOUR</span><span class="o">=</span><span class="n">cb_4</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_FIVE</span><span class="o">=</span><span class="n">cb_5</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_SIX</span><span class="o">=</span><span class="n">cb_6</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_SEVEN</span><span class="o">=</span><span class="n">cb_7</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_EIGHT</span><span class="o">=</span><span class="n">cb_8</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_NINE</span><span class="o">=</span><span class="n">cb_9</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_TEN</span><span class="o">=</span><span class="n">cb_10</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_ELEVEN</span><span class="o">=</span><span class="n">cb_11</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_TWELVE</span><span class="o">=</span><span class="n">cb_12</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_THIRTEEN</span><span class="o">=</span><span class="n">cb_13</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComplexSolnModel.exchange_indices"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.exchange_indices">[docs]</a>    <span class="k">def</span> <span class="nf">exchange_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reassigns indices in a derivative tensor to generate dependent entries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        i,j,k : int</span>
<span class="sd">            Indices, i &lt;= j &lt;= k, of a tensor derivative</span>

<span class="sd">        var : str</span>
<span class="sd">            Name of tensor</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            Code fragment (in C) that assigns name[i][j][k] to redundant</span>
<span class="sd">            elements of the tensor, e.g. name[k][j][i]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
            <span class="c1"># i,k,j and k,i,j must equal i,j,k</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
            <span class="c1"># j,i,k and j,k,i must equal i,j,k</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># j,i,k and k,i,j and j,k,i and k,j,i must equal i,j,k</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                       <span class="o">+</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="ComplexSolnModel.create_soln_calc_h_file"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.create_soln_calc_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_soln_calc_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s1">&#39;fast&#39;</span><span class="p">,</span>
        <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an include file implementing model calculations.</span>

<span class="sd">        Note that this include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model. See</span>
<span class="sd">        create_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        module_type : string</span>
<span class="sd">            Generate code that executes &quot;fast&quot; but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        minimal_deriv_set : bool</span>
<span class="sd">            Generate a minimal set of compositional derivatives: dgdn, d2gdndt,</span>
<span class="sd">            d2gdndp, d3gdndt2, d3gdndtdp, d3gdndp2, d4gdndt3, d4gdndt2dp,</span>
<span class="sd">            d4gdndtdp2, d4gdndp3, d2gdn2, d3gdn2dt, d3gdn2dp, d3gdn3.  This is</span>
<span class="sd">            the subset of derivatives currently required for solution phases</span>
<span class="sd">            that are imported into the phases module. Remaining derivatives are</span>
<span class="sd">            returned with values of zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="c1"># Code for assigning mole numbers to components</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">moles_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = n[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">gen_expr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include_dh_code</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_code_for_dh_functions</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">order_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">order_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = s[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">order_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_ordering_gaussj_template</span><span class="p">(</span><span class="n">language</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">NS</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;#include &lt;float.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_ordering_code</span><span class="p">(</span><span class="n">moles_assign_text</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                                           <span class="n">order_assign_text</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">):</span>
            <span class="c1"># Potential and T, P derivatives</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">exp</span><span class="o">.</span><span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;unrestricted&#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">exp</span><span class="o">.</span><span class="n">expression</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">oT</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">oP</span><span class="p">)</span>
            <span class="n">gen_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">gen_expr</span><span class="p">)</span>

        <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
        <span class="n">order_initial_guess_text</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                <span class="n">sFunc</span><span class="o">.</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
        <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="s1">&#39;}&#39;</span>

        <span class="n">complx_soln_calc_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_complx_soln_calc_template</span><span class="p">()</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span>
        <span class="n">dgdn_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gdndt_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gdndp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gdn2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gdnds_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdn3_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdn2dt_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdn2dp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdn2ds_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdndt2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdndtdp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdndp2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdndsdt_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdndsdp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdnds2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">dgdn_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    dgdn[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">dgdn_code_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">dgdn_code_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d2gdndt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdndt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d2gdndt_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d2gdndt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d2gdndp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdndp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d2gdndp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d2gdndp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdndt2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdndt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdndt2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdndt2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdndtdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdndtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdndtdp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdndtdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdndp2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdndp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdndp2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdndp2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                <span class="n">d2gdn2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdn2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d2gdn2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d2gdn2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gdn2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gdn2dt_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gdn2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gdn2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gdn2dp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gdn2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">d2gdn2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdn2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d2gdn2_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d2gdn2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gdn2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gdn2dt_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gdn2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gdn2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gdn2dp_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gdn2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">d3gdn3_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                      <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gdn3_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                    <span class="n">d3gdn3_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gdn3_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;d3gdn3&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">d3gdn2ds_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gdn2ds_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                    <span class="n">d3gdn2ds_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">d3gdn2ds_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                            <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">d3gdn2ds_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gdn2ds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                            <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">d2gdnds_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d2gdnds_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d2gdnds_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gdndsdt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdndsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gdndsdt_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gdndsdt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gdndsdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdndsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gdndsdp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gdndsdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">d3gdnds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> \
                                        <span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gdnds2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                    <span class="n">d3gdnds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                        <span class="n">d3gdnds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                            <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">d3gdnds2_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                            <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">d2gdsdt_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gdsdp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d2gds2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdsdt2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdsdtdp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gdsdp2_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gds2dt_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gds2dp_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">d3gds3_fill_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">d2gdsdt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d2gdsdt_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d2gdsdt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d2gdsdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d2gdsdp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d2gdsdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdsdt2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdsdt2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdsdt2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdsdtdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdsdtdp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdsdtdp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">d3gdsdp2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">d3gdsdp2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">d3gdsdp2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">d2gds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d2gds2_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d2gds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gds2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gds2dt_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gds2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">d3gds2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">d3gds2dp_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">d3gds2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">d2gds2_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d2gds2_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gds2dt_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gds2dt_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gds2dp_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gds2dp_fill_text</span> <span class="o">+=</span>     <span class="s1">&#39;d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">d3gds3_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span> \
                                        <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">d3gds3_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                    <span class="n">d3gds3_fill_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">d3gds3_fill_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">complx_soln_calc_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">number_symmetric_hessian_terms</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nc</span><span class="o">+</span><span class="n">nc</span><span class="o">*</span><span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">number_symmetric_tensor_terms</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nc</span><span class="o">*</span><span class="p">(</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nc</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">order_assign_text</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">g_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="p">),</span>
            <span class="n">dgdt_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)),</span>
            <span class="n">dgdp_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)),</span>
            <span class="n">dgdn_code</span><span class="o">=</span><span class="n">dgdn_code_text</span><span class="p">,</span>
            <span class="n">d2gdt2_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
            <span class="n">d2gdtdp_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)),</span>
            <span class="n">d2gdp2_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
            <span class="n">d3gdt3_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
            <span class="n">d3gdt2dp_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)),</span>
            <span class="n">d3gdtdp2_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
            <span class="n">d3gdp3_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
            <span class="n">fillD2GDNDT</span><span class="o">=</span><span class="n">d2gdndt_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDNDP</span><span class="o">=</span><span class="n">d2gdndp_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDN2</span><span class="o">=</span><span class="n">d2gdn2_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDNDS</span><span class="o">=</span><span class="n">d2gdnds_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDSDT</span><span class="o">=</span><span class="n">d2gdsdt_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDSDP</span><span class="o">=</span><span class="n">d2gdsdp_fill_text</span><span class="p">,</span>
            <span class="n">fillD2GDS2</span><span class="o">=</span><span class="n">d2gds2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDN3</span><span class="o">=</span><span class="n">d3gdn3_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDN2DT</span><span class="o">=</span><span class="n">d3gdn2dt_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDN2DP</span><span class="o">=</span><span class="n">d3gdn2dp_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDN2DS</span><span class="o">=</span><span class="n">d3gdn2ds_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDT2</span><span class="o">=</span><span class="n">d3gdndt2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDTDP</span><span class="o">=</span><span class="n">d3gdndtdp_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDP2</span><span class="o">=</span><span class="n">d3gdndp2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDSDT</span><span class="o">=</span><span class="n">d3gdndsdt_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDSDP</span><span class="o">=</span><span class="n">d3gdndsdp_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDNDS2</span><span class="o">=</span><span class="n">d3gdnds2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDSDT2</span><span class="o">=</span><span class="n">d3gdsdt2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDSDTDP</span><span class="o">=</span><span class="n">d3gdsdtdp_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDSDP2</span><span class="o">=</span><span class="n">d3gdsdp2_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDS2DT</span><span class="o">=</span><span class="n">d3gds2dt_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDS2DP</span><span class="o">=</span><span class="n">d3gds2dp_fill_text</span><span class="p">,</span>
            <span class="n">fillD3GDS3</span><span class="o">=</span><span class="n">d3gds3_fill_text</span>
            <span class="p">)</span>

        <span class="n">convenience_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_redun_template</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">convenience_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">nc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span></div>

<div class="viewcode-block" id="ComplexSolnModel.create_soln_calib_h_file"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.create_soln_calib_h_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_soln_calib_h_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an include file implementing model parameter derivatives.</span>

<span class="sd">        Note that this include file contains code for functions that implement</span>
<span class="sd">        the model for the generic case. It is meant to be included into a file</span>
<span class="sd">        that implements a specific parameterized instance of the model. See</span>
<span class="sd">        create_code_module().</span>

<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        language : string</span>
<span class="sd">            Language syntax for generated code. (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span>
        <span class="n">SpMdClass</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;SpeciationSolnModel&#39;</span> \
            <span class="k">else</span> <span class="kc">False</span>

        <span class="c1"># Code for assigning mole numbers to components</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">moles_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = n[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>

        <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
        <span class="n">order_initial_guess_text</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                <span class="n">sFunc</span><span class="o">.</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
        <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="s1">&#39;}&#39;</span>

        <span class="n">order_assign_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">order_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = s[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">order_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">solution_calib_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_complx_soln_calib_template</span><span class="p">()</span>
        <span class="n">symparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_symbols</span><span class="p">()</span>
        <span class="n">G_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_g_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">np</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>

        <span class="c1">##########################</span>
        <span class="c1"># Block of code for dgdw #</span>
        <span class="c1">##########################</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">order_assign_text</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># dsdw                #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_dsdw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> \
                     <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> \
                     <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            dsdw[j][i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) dsdw[j][i] += &#39;</span> \
             <span class="o">+</span> <span class="s1">&#39;- invd2gds2[j][k]*d2gdsdw[k][i];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}&#39;</span>

        <span class="c1">#############################</span>
        <span class="c1"># Block of code for d2gdtdw #</span>
        <span class="c1">#############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>


        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += d2gdsdt[i]*dsdw[i][&#39;</span> \
                <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;result += d2gds2[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># Block of code for d2gdpdw #</span>
        <span class="c1">#############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>


        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += d2gdsdp[i]*dsdw[i][&#39;</span> \
                <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;result += d2gds2[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># Block of code for d2gdndw #</span>
        <span class="c1">#############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdn[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdn[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdn(T, P, n, s, invd2gds2, dsdn);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdn[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;static void &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_dparam_dgdn(double T, double P, &#39;</span>
            <span class="o">+</span><span class="s1">&#39;double n[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;], int index, double result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="o">+</span> <span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;    static double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="n">order_initial_guess_text</span> \
           <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;    double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;    order_s(T, P, n, s, invd2gds2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">extraCb</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">extraCa</span>
        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;    switch (index) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">jjj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;        result[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">jjj</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;+= d2gdsdn[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39; + d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdn[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;result[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] += d2gds2[i][j]*dsdn[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jjj</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>


            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">switch_code_text</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;    default:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d2sdtdw             #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_d2sdtdw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;], dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,ll;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                 <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> \
                     <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> \
                              <span class="o">+</span><span class="s1">&#39;] = d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> \
                             <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        dsdt[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) dsdt[i] += &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;- invd2gds2[i][j]*d2gdsdt[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            dsdw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>              <span class="s1">&#39;dsdw[i][ll] += - invd2gds2[i][j]*d2gdsdw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] = d3gdsdtdw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dt[j][k]*dsdw[k][ll] &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                              <span class="s1">&#39;+ d3gds2dw[j][k][ll]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) temp[j] += &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                         <span class="s1">&#39;d3gds3[j][k][l]*dsdt[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            d2sdtdw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>              <span class="s1">&#39;d2sdtdw[i][ll] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">##############################</span>
        <span class="c1"># Block of code for d3gdt2dw #</span>
        <span class="c1">##############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> \
                         <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> \
                  <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="s1">&#39;d3gdsdt2[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d2gdsdt[i]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdt2[i] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d3gdsdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dt[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gds2[i][j]*d2sdt2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d2gds2[i][j]*dsdt[i]*d2sdtdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdt[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;1; k++) &#39;</span> \
            <span class="s1">&#39;result += d3gds3[i][j][k]*dsdt[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d2sdpdw             #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_d2sdpdw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;], dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,ll;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                 <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> \
                     <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> \
                              <span class="o">+</span><span class="s1">&#39;] = d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> \
                             <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        dsdp[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) dsdp[i] += &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;- invd2gds2[i][j]*d2gdsdp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            dsdw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>              <span class="s1">&#39;dsdw[i][ll] += - invd2gds2[i][j]*d2gdsdw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] = d3gdsdpdw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dp[j][k]*dsdw[k][ll] &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                              <span class="s1">&#39;+ d3gds2dw[j][k][ll]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) temp[j] += &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                         <span class="s1">&#39;d3gds3[j][k][l]*dsdp[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            d2sdpdw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>              <span class="s1">&#39;d2sdpdw[i][ll] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">###############################</span>
        <span class="c1"># Block of code for d3gdtdpdw #</span>
        <span class="c1">###############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> \
                         <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> \
                         <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> \
                  <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> \
                  <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="s1">&#39;d3gdsdtdp[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gdsdt[i]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gdsdp[i]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdtdp[i] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gdsdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gdsdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;d3gds2dt[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gds2dp[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gds2[i][j]*d2sdtdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gds2[i][j]*dsdp[i]*d2sdtdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gds2[i][j]*dsdt[i]*d2sdpdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;1; k++) &#39;</span> \
            <span class="s1">&#39;result += d3gds3[i][j][k]*dsdt[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1"># Block of code for d3gdp2dw #</span>
        <span class="c1">##############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> \
                         <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span>    <span class="s1">&#39; d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> \
                    <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> \
                  <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="s1">&#39;d3gdsdp2[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d2gdsdp[i]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdp2[i] &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d3gdsdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dp[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d2gds2[i][j]*d2sdp2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ 2.0*d2gds2[i][j]*dsdp[i]*d2sdpdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;+ d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i]*dsdp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;1; k++) &#39;</span> \
            <span class="s1">&#39;result += d3gds3[i][j][k]*dsdp[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d3sdt2dw, d3sdt3    #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_d3sdt2dw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double d3sdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m,ll;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] = d4gdsdt2dw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds2dt2[j][k]*dsdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d4gds2dtdw[j][k][ll]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d3gds2dt[j][k]*d2sdtdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dw[j][k][ll]*d2sdt2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += 2.0*d4gds3dt[j][k][l]*dsdt[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds3dw[j][k][l][ll]*dsdt[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += 2.0*d3gds3[j][k][l]*d2sdtdw[k][ll]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d3gds3[j][k][l]*d2sdt2[k]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                            temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                              <span class="s1">&#39;dsdt[k]*dsdt[l]*dsdw[m][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            d3sdt2dw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                <span class="s1">&#39;d3sdt2dw[i][ll] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;static void order_d3sdt3(double T, double P,&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span>  <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double d3sdt3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdt3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            temp[j] = d4gdsdt3[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 3.0*d4gds2dt2[j][k]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 3.0*d3gds2dt[j][k]*d2sdt2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 3.0*d4gds3dt[j][k][l]*dsdt[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 3.0*d3gds3[j][k][l]*d2sdt2[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;dsdt[k]*dsdt[l]*dsdt[m];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        d3sdt3[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;d3sdt3[i] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">##############################</span>
        <span class="c1"># Block of code for d4gdt3dw #</span>
        <span class="c1">##############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d4gdsdt3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdt3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdt3(T, P, n, s, invd2gds2, d3sdt3);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdt2dw(T, P, n, s, invd2gds2, d3sdt2dw);</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;    d4gdsdt3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gdsdt2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdt3[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gdsdt2[i]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gdsdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdt2[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d2gdsdt[i]*d3sdt2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d3sdt3[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds2dt2[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds2dtdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;6.0*d3gds2dt[i][j]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds2dt[i][j]*d2sdt2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdt2[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d2gds2[i][j]*d2sdt2[i]*d2sdtdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds3dt[i][j][k]*dsdt[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dw[i][j][k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdt[j]*dsdt[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds3[i][j][k]*d2sdt2[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds3[i][j][k]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;result += d4gds4[i][j][k][l]*dsdt[i]*dsdt[j]*dsdt[k]*dsdw[l][&#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d3sdtdpdw, d3sdt2dp #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_d3sdtdpdw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double d3sdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m,ll;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] = d4gdsdtdpdw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds2dtdp[j][k]*dsdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds2dtdw[j][k][ll]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds2dpdw[j][k][ll]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dt[j][k]*d2sdpdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dp[j][k]*d2sdtdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dw[j][k][ll]*d2sdtdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds3dt[j][k][l]*dsdp[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds3dp[j][k][l]*dsdt[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds3dw[j][k][l][ll]*dsdt[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d3gds3[j][k][l]*d2sdpdw[k][ll]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d3gds3[j][k][l]*d2sdtdw[k][ll]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d3gds3[j][k][l]*d2sdtdp[k]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                            temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                              <span class="s1">&#39;dsdt[k]*dsdp[l]*dsdw[m][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            d3sdtdpdw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                <span class="s1">&#39;d3sdtdpdw[i][ll] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;static void order_d3sdt2dp(double T, double P,&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
             <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double d3sdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                 <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            temp[j] = d4gdsdt2dp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += d4gds2dt2[j][k]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 2.0*d4gds2dtdp[j][k]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 2.0*d3gds2dt[j][k]*d2sdtdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += d3gds2dp[j][k]*d2sdt2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d4gds3dt[j][k][l]*dsdt[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds3dp[j][k][l]*dsdt[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d3gds3[j][k][l]*d2sdtdp[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds3[j][k][l]*d2sdt2[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;dsdt[k]*dsdt[l]*dsdp[m];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        d3sdt2dp[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;d3sdt2dp[i] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">################################</span>
        <span class="c1"># Block of code for d4gdt2dpdw #</span>
        <span class="c1">################################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d4gdsdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdt2dp(T, P, n, s, invd2gds2, d3sdt2dp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdt2dw(T, P, n, s, invd2gds2, d3sdt2dw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdtdpdw(T, P, n, s, invd2gds2, d3sdtdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;    d4gdsdt2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdt2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gdsdtdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdt2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdt2dp[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gdsdt2[i]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gdsdtdp[i]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gdsdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdtdp[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gdsdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdt2[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d2gdsdt[i]*d3sdtdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdp[i]*d3sdt2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d3sdt2dp[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds2dt2[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds2dtdp[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds2dtdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds2dpdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dt[i][j]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dt[i][j]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dt[i][j]*d2sdtdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dp[i][j]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds2dp[i][j]*d2sdt2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdt2[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdtdp[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d2gds2[i][j]*d2sdtdp[i]*d2sdtdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gds2[i][j]*d2sdt2[i]*d2sdpdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds3dt[i][j][k]*dsdp[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dp[i][j][k]*dsdt[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dw[i][j][k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdt[j]*dsdp[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds3[i][j][k]*d2sdt2[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds3[i][j][k]*d2sdtdp[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds3[i][j][k]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j]*dsdp[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds3[i][j][k]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;result += d4gds4[i][j][k][l]*dsdt[i]*dsdt[j]*dsdp[k]*dsdw[l][&#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d3sdp2dw, d3sdtdp2  #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span> <span class="o">=</span> <span class="s1">&#39;static void order_d3sdp2dw(double T, double P,&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span> <span class="s1">&#39; double d3sdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m,ll;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (ll=0; ll&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; ll++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] = d4gdsdp2dw[j][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds2dp2[j][k]*dsdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d4gds2dpdw[j][k][ll]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d3gds2dp[j][k]*d2sdpdw[k][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds2dw[j][k][ll]*d2sdp2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += 2.0*d4gds3dp[j][k][l]*dsdp[k]*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds3dw[j][k][l][ll]*dsdp[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += 2.0*d3gds3[j][k][l]*d2sdpdw[k][ll]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d3gds3[j][k][l]*d2sdp2[k]&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;*dsdw[l][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                            temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                              <span class="s1">&#39;dsdp[k]*dsdp[l]*dsdw[m][ll];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            d3sdp2dw[i][ll] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                <span class="s1">&#39;d3sdp2dw[i][ll] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;static void order_d3sdtdp2(double T, double P,&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
             <span class="o">+</span> <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
             <span class="o">+</span> <span class="s1">&#39; double d3sdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                 <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            temp[j] = d4gdsdtdp2[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += d4gds2dp2[j][k]*dsdt[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 2.0*d4gds2dtdp[j][k]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 2.0*d3gds2dp[j][k]*d2sdtdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += d3gds2dt[j][k]*d2sdp2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d4gds3dp[j][k][l]*dsdt[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d4gds3dt[j][k][l]*dsdp[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 2.0*d3gds3[j][k][l]*d2sdtdp[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += d3gds3[j][k][l]*d2sdp2[k]*dsdt[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;dsdp[k]*dsdp[l]*dsdt[m];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        d3sdtdp2[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;d3sdtdp2[i] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">################################</span>
        <span class="c1"># Block of code for d4gdtdp2dw #</span>
        <span class="c1">################################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d4gdsdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdt(T, P, n, s, invd2gds2, dsdt);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdtdp2(T, P, n, s, invd2gds2, d3sdtdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdp2dw(T, P, n, s, invd2gds2, d3sdp2dw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdtdpdw(T, P, n, s, invd2gds2, d3sdtdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;    d4gdsdtdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdtdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dtdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gdsdtdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdp2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdtdp2[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gdsdp2[i]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gdsdtdp[i]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gdsdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdtdp[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gdsdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdp2[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d2gdsdp[i]*d3sdtdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdt[i]*d3sdp2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d3sdtdp2[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds2dp2[i][j]*dsdt[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds2dtdp[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds2dpdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds2dtdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dp[i][j]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dp[i][j]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dp[i][j]*d2sdtdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dt[i][j]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds2dt[i][j]*d2sdp2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdp2[i]*dsdt[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdtdp[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d2gds2[i][j]*d2sdtdp[i]*d2sdpdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gds2[i][j]*d2sdp2[i]*d2sdtdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d4gds3dp[i][j][k]*dsdt[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dt[i][j][k]*dsdp[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dw[i][j][k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdt[i]*dsdp[j]*dsdp[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds3[i][j][k]*d2sdp2[i]*dsdt[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds3[i][j][k]*d2sdtdp[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;2.0*d3gds3[i][j][k]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j]*dsdt[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d3gds3[i][j][k]*d2sdtdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;result += d4gds4[i][j][k][l]*dsdp[i]*dsdp[j]*dsdt[k]*dsdw[l][&#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># Extra ordering code #</span>
        <span class="c1"># d3sdp3              #</span>
        <span class="c1">#######################</span>
        <span class="n">eCB</span>  <span class="o">=</span> <span class="s1">&#39;static void order_d3sdp3(double T, double P,&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double n[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="p">(</span><span class="s1">&#39; double b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> <span class="k">if</span> <span class="n">SpMdClass</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
            <span class="o">+</span>  <span class="s1">&#39; double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],&#39;</span> \
            <span class="o">+</span>  <span class="s1">&#39; double d3sdp3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l,m;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdp3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double temp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">SpMdClass</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="n">order_assign_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> \
                         <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                        <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            temp[j] = d4gdsdp3[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 3.0*d4gds2dp2[j][k]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                temp[j] += 3.0*d3gds2dp[j][k]*d2sdp2[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 3.0*d4gds3dp[j][k][l]*dsdp[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    temp[j] += 3.0*d3gds3[j][k][l]*d2sdp2[k]*dsdp[l];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    for (m=0; m&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; m++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                        temp[j] += d4gds4[j][k][l][m]*&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>                          <span class="s1">&#39;dsdp[k]*dsdp[l]*dsdp[m];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        d3sdp3[i] = 0.0;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;        for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) &#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span>            <span class="s1">&#39;d3sdp3[i] += - invd2gds2[i][j]*temp[j];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;    }</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">eCB</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">##############################</span>
        <span class="c1"># Block of code for d4gdp3dw #</span>
        <span class="c1">##############################</span>
        <span class="n">extraCb</span>  <span class="o">=</span> <span class="s1">&#39;    double d4gdsdp3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double dsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d2sdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdp3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    double d3sdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    int i,j,k,l;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdp(T, P, n, s, invd2gds2, dsdp);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_dsdw(T, P, n, s, invd2gds2, dsdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdp3(T, P, n, s, invd2gds2, d3sdp3);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">extraCb</span> <span class="o">+=</span> <span class="s1">&#39;    order_d3sdp2dw(T, P, n, s, invd2gds2, d3sdp2dw);</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">extraCa</span>  <span class="o">=</span> <span class="s1">&#39;    d4gdsdp3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
            <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gdsdp2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdsdpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gdsdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span>
                <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds4[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds3dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span> \
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">ll</span><span class="p">]))</span>
                        <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d4gds2dpdw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dw[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
                    <span class="n">extraCa</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">)]</span>

        <span class="n">switch_code_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        result += &#39;</span> <span class="o">+</span> <span class="n">G_jac_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gdsdp2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gdsdp3[i]*dsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gdsdp2[i]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gdsdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdp2[i] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d2gdsdp[i]*d3sdp2dw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d2gdsdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d3sdp3[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            for (j=0; j&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; j++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds2dp2[i][j]*dsdp[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds2dpdw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;6.0*d3gds2dp[i][j]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds2dp[i][j]*d2sdp2[i]*dsdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds2dw[i][j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*d2sdp2[i]*dsdp[j] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d2gds2[i][j]*d2sdp2[i]*d2sdpdw[j][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                for (k=0; k&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; k++) {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    result += &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d4gds3dp[i][j][k]*dsdp[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;    d4gds3dw[i][j][k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[i]*dsdp[j]*dsdp[k] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds3[i][j][k]*d2sdp2[i]*dsdp[j]*dsdw[k][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] + &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;3.0*d3gds3[i][j][k]*d2sdpdw[i][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]*dsdp[j]*dsdp[k];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                    for (l=0; l&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; l++) &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;result += d4gds4[i][j][k][l]*dsdp[i]*dsdp[j]*dsdp[k]*dsdw[l][&#39;</span> \
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;                }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;            }</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        }</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">switch_code_text</span> <span class="o">+=</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">w</span> <span class="o">+=</span> <span class="n">solution_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_components</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">switch_code</span><span class="o">=</span><span class="n">switch_code_text</span><span class="p">,</span> <span class="n">moles_assign</span><span class="o">=</span><span class="n">moles_assign_text</span><span class="p">,</span>
            <span class="n">number_ordering</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">order_initial_guess</span><span class="o">=</span><span class="n">order_initial_guess_text</span><span class="p">,</span>
            <span class="n">order_assign</span><span class="o">=</span><span class="n">extraCb</span><span class="o">+</span><span class="n">order_assign_text</span><span class="o">+</span><span class="n">extraCa</span><span class="p">,</span>
            <span class="n">extra_ordering_code</span><span class="o">=</span><span class="n">eCB</span><span class="p">)</span>

        <span class="c1">########</span>
        <span class="c1"># Done #</span>
        <span class="c1">########</span>

        <span class="n">value_params</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))]</span>
        <span class="n">code_block_one_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_two_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_three_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_four_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">value_params</span><span class="p">)):</span>
            <span class="n">code_block_one_text</span>   <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    (*values)[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_two_text</span>   <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = values[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_three_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        result = &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">code_block_four_text</span>  <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    case &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        &#39;</span> <span class="o">+</span> <span class="n">value_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; = value;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="o">+</span> <span class="s1">&#39;        break;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">name_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_names</span><span class="p">()</span>
        <span class="n">unit_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_param_units</span><span class="p">()</span>
        <span class="n">extra_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_soln_calib_extra_template</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">extra_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="n">number_params</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
            <span class="n">names_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">name_params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span>
            <span class="n">units_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">unit_params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span>
            <span class="n">code_block_one</span><span class="o">=</span><span class="n">code_block_one_text</span><span class="p">,</span>
            <span class="n">code_block_two</span><span class="o">=</span><span class="n">code_block_two_text</span><span class="p">,</span>
            <span class="n">code_block_three</span><span class="o">=</span><span class="n">code_block_three_text</span><span class="p">,</span>
            <span class="n">code_block_four</span><span class="o">=</span><span class="n">code_block_four_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">w</span></div>

<div class="viewcode-block" id="ComplexSolnModel.create_code_module"><a class="viewcode-back" href="../coder.html#coder.ComplexSolnModel.create_code_module">[docs]</a>    <span class="k">def</span> <span class="nf">create_code_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;Feldspar&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">endmembers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">add_code_to_access_order_paramater</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates include and code file for a model instance.</span>

<span class="sd">        See documentation for superclass.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        add_code_to_access_order_paramater : bool</span>
<span class="sd">            Generates additional functions to output values of order parameters</span>
<span class="sd">            as a function of composition, temperature and pressure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ComplexSolnModel</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">create_code_module</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
            <span class="n">endmembers</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">module_type</span><span class="p">,</span> <span class="n">silent</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span>
            <span class="n">minimal_deriv_set</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add_code_to_access_order_paramater</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Generating additional methods for order parameter &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;access.&#39;</span><span class="p">)</span>
                <span class="n">h_file_name</span>  <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
                <span class="n">h_file_name</span> <span class="o">+=</span> <span class="s1">&#39;_calib.h&#39;</span> <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span> <span class="k">else</span> <span class="s1">&#39;.h&#39;</span>
                <span class="n">c_file_name</span>  <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
                <span class="n">c_file_name</span> <span class="o">+=</span> <span class="s1">&#39;_calib.c&#39;</span> <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span> <span class="k">else</span> <span class="s1">&#39;.c&#39;</span>
                <span class="n">pyx_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;.pyx&#39;</span>
                <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
                <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>

                <span class="n">func_signature</span>  <span class="o">=</span> <span class="s1">&#39;void &#39;</span> <span class="o">+</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>
                <span class="n">func_signature</span> <span class="o">+=</span> <span class="s1">&#39;order_params(double T, double P, &#39;</span>
                <span class="n">func_signature</span> <span class="o">+=</span> <span class="s1">&#39;double n[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;], &#39;</span>
                <span class="n">func_signature</span> <span class="o">+=</span> <span class="s1">&#39;double result[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;])&#39;</span>

                <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
                <span class="n">order_initial_guess_text</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span>
                <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">sFunc</span><span class="o">.</span><span class="n">guess</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
                <span class="n">order_initial_guess_text</span> <span class="o">+=</span> <span class="s1">&#39;}&#39;</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">h_file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">func_signature</span><span class="o">+</span><span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">c_file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">func_signature</span><span class="o">+</span><span class="s1">&#39; {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">fc</span>  <span class="o">=</span> <span class="s1">&#39;    double s[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;] = &#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="n">order_initial_guess_text</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    double invd2gds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    int i;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    order_s(T, P, n, s, invd2gds2);</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    for (i=0; i&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; i++) result[i] = s[i];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pyx_file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">fc</span>  <span class="o">=</span> <span class="s1">&#39;cdef extern from &quot;&#39;</span> <span class="o">+</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;calib.h&#39;</span> <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span> <span class="k">else</span> <span class="s1">&#39;.h&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;&quot;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">func_signature</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;def &#39;</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;_order_params(double t, double p, np_array):</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    cdef double *m = &lt;double *&gt;malloc(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> \
                        <span class="o">+</span> <span class="s1">&#39;*sizeof(double))</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    cdef double *r = &lt;double *&gt;malloc(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> \
                        <span class="o">+</span> <span class="s1">&#39;*sizeof(double))</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    for i in range(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;):</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;        m[i] = np_array[i]</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;order_params(&lt;double&gt; t, &lt;double&gt; p, &lt;double *&gt; m, &#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;&lt;double *&gt; r)</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="c1">#fc += &#39;    print(r[0])\n&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    r_np_array = np.zeros(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    for i in range(0,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;):</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;        r_np_array[i] = r[i]</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    free(m)</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    free(r)</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">fc</span> <span class="o">+=</span> <span class="s1">&#39;    return r_np_array</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="f_mu_e"><a class="viewcode-back" href="../coder.html#coder.f_mu_e">[docs]</a><span class="k">class</span> <span class="nc">f_mu_e</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A placeholder class that creates a SymPy function that accepts three</span>
<span class="sd">    arguments and returns a value of zero/</span>

<span class="sd">    This class is used by the SpeciationSolnModel class to initial functions</span>
<span class="sd">    that return excess chemical potentials for an ideal solution.</span>

<span class="sd">    Extends:</span>
<span class="sd">        sym.Function</span>

<span class="sd">    Variables:</span>
<span class="sd">        nargs {number} -- Number of arguments to the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="f_mu_e.eval"><a class="viewcode-back" href="../coder.html#coder.f_mu_e.eval">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span></div></div>

<div class="viewcode-block" id="SpeciationSolnModel"><a class="viewcode-back" href="../coder.html#coder.SpeciationSolnModel">[docs]</a><span class="k">class</span> <span class="nc">SpeciationSolnModel</span><span class="p">(</span><span class="n">ComplexSolnModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class creates a model of the thermodynamic properties of a speciated solution.</span>

<span class="sd">    Inherits all methods and functionality of the Complex Solution Model class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nc : int</span>
<span class="sd">        Number of thermodynamic components in the solution</span>
<span class="sd">    nb : int</span>
<span class="sd">        Number of basis species in the solution (usually, nb == nc)</span>
<span class="sd">    ns : int</span>
<span class="sd">        Number of non-basis species in the solution</span>
<span class="sd">    Cb : numpy 2-d array</span>
<span class="sd">        An array of nb rows and ne columns that maps the composition of basis</span>
<span class="sd">        species to moles of endmember components. Often, this matrix is the</span>
<span class="sd">        identity matrix, but that condition is not required. Cb must be an</span>
<span class="sd">        invertible matrix.</span>
<span class="sd">    Cs : numpy 2-d array</span>
<span class="sd">        An array of ns rows and ne columns that maps the composition of</span>
<span class="sd">        non-basis species to moles of endmember components.</span>
<span class="sd">    R : SymPy Matrix, (ns,nb)</span>
<span class="sd">        A SymPy Matrix with ns rows and nb columns containing reaction</span>
<span class="sd">        coefficients that map basis to non-basis species. This matrix need be</span>
<span class="sd">        provided only if an expression added to the model utilizes a SymPy</span>
<span class="sd">        indexed symbol (e.g., the *r* property of this class).  Otherwise,</span>
<span class="sd">        the quanity is unreferenced.</span>
<span class="sd">    model_type : (str, opt ...)</span>
<span class="sd">        Type of speciation model. Default is (&#39;ideal&#39;) implying ideal mixing</span>
<span class="sd">        between basis and non-basis species.</span>
<span class="sd">        Acceptable alternatives are:</span>

<span class="sd">        - (&#39;debye-huckel-limit&#39;, []) - Non-ideal interactions are described by</span>
<span class="sd">          the Debye-Hckel limiting law and the mole fraction -&gt; molality</span>
<span class="sd">          conversion term. The second element of the tuple is a list of charges</span>
<span class="sd">          associated with the basis plus non-basis species; anions have negative</span>
<span class="sd">          values, cations have positive values, neutral species have zero values.</span>

<span class="sd">        - (&#39;debye-huckel&#39;, [], []) - Non-ideal interactions are described</span>
<span class="sd">          by the full version of Debye-Hckel theory (including the denominator</span>
<span class="sd">          term) and the mole fraction -&gt; molality conversion term. The second</span>
<span class="sd">          element of the tuple is a list of charges associated with the basis</span>
<span class="sd">          plus non-basis species. The third term in the tuple is a list of</span>
<span class="sd">          constants associated with the azero contribution to the Debye-Hckel</span>
<span class="sd">          term for each basis and non-basis species.</span>

<span class="sd">        - (&#39;debye-huckel-ext&#39;, [], [], []) - Non-ideal interactions are</span>
<span class="sd">          described by the full version of Debye-Hckel theory (including the</span>
<span class="sd">          denominator term) plus the mole fraction -&gt; molality conversion term</span>
<span class="sd">          and an extended term. The second element of the tuple is a list of</span>
<span class="sd">          charges associated with the basis plus non-basis species. The third</span>
<span class="sd">          term in the tuple is a list of constants associated with the azero</span>
<span class="sd">          contribution to the Debye-Hckel term for each basis and non-basis</span>
<span class="sd">          species. The fourth term is a list of constant coefficients that pre-</span>
<span class="sd">          multiply the species molality and define an extended term contribution</span>
<span class="sd">          to the excess Gibbs energy.</span>
<span class="sd">    debug_print : bool</span>
<span class="sd">        Print debug messages from root solvers in generated C code</span>
<span class="sd">    multiroot_method : str</span>
<span class="sd">        Method to use in GNU Scientific Library (GSL) solver for homogeneous</span>
<span class="sd">        equilibrium speciation. Options are:</span>

<span class="sd">        gsl_multiroot_fdfsolver_hybridsj</span>

<span class="sd">        gsl_multiroot_fdfsolver_hybridj</span>

<span class="sd">        gsl_multiroot_fdfsolver_newton</span>

<span class="sd">        gsl_multiroot_fdfsolver_gnewton (default)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    a_list (inherited from super class)</span>
<span class="sd">    b_list</span>
<span class="sd">    Cb</span>
<span class="sd">    Cs</span>
<span class="sd">    debug_print</span>
<span class="sd">    expression_parts (inherited from super class)</span>
<span class="sd">    g_list (inherited from super class)</span>
<span class="sd">    i</span>
<span class="sd">    implicit_functions (inherited from super class)</span>
<span class="sd">    j</span>
<span class="sd">    k</span>
<span class="sd">    module (inherited from super class)</span>
<span class="sd">    mu (overrides super class)</span>
<span class="sd">    multiroot_method</span>
<span class="sd">    mu_e</span>
<span class="sd">    mu_ex</span>
<span class="sd">    mu_s</span>
<span class="sd">    n (inherited from super class)</span>
<span class="sd">    nb</span>
<span class="sd">    nc (inherited from super class)</span>
<span class="sd">    ns</span>
<span class="sd">    nT (inherited from super class)</span>
<span class="sd">    params (inherited from super class)</span>
<span class="sd">    printer (inherited from super class)</span>
<span class="sd">    r</span>
<span class="sd">    s (inherited from super class)</span>
<span class="sd">    R</span>
<span class="sd">    Rg</span>
<span class="sd">    variables (inherited from super class)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The property mu declared by the SimpleSolnModel subclass is modified by</span>
<span class="sd">    this class to return a 1-d SymPy Matrix of symbols for endmember chemical</span>
<span class="sd">    potentials of all solution species, nb+ns, numbered as 1 ... nb+ns</span>

<span class="sd">    This class is for creating a representation of the thermodynamic properties</span>
<span class="sd">    of a speciated solution phase.  The principal use of the class is to</span>
<span class="sd">    construct a model symbolically, and to generate code that implements the</span>
<span class="sd">    model for model parameter calibration and thermodynamic property calculation.</span>

<span class="sd">    A speciated solution is one that contains implicit concentration variables</span>
<span class="sd">    that need to be determined via solution of conditions of homogeneous</span>
<span class="sd">    equilibrium.  Examples of speciated solutions include aqueous solutions with</span>
<span class="sd">    complexes or gas solutions with multiple species.</span>

<span class="sd">    Model specification:</span>

<span class="sd">    - A model may be contructed in a manner similar to the SimpleSolnModel</span>
<span class="sd">      class by adding an expression for the total Gibbs free energy of solution</span>
<span class="sd">      using the add_expression_to_model() method.  This methoid of construction is</span>
<span class="sd">      suitable if the specification is compact and does not involve iteration over</span>
<span class="sd">      a common expression. Alternatively,</span>

<span class="sd">    - A model may be formed by adding a basis species and non-basis species</span>
<span class="sd">      contribution, where the non-basis species contribution is specified as an</span>
<span class="sd">      implicit sum over a parameterized exprression of fixed mathematical form.</span>
<span class="sd">      A model of this kind is constructed by adding multiple terms using the</span>
<span class="sd">      add_expression_to_model() method. Typically, the terms are:</span>
<span class="sd">        - A SymPy expression for the ideal Gibbs free energy of solution</span>
<span class="sd">          contribution of the basis species. This expression should include</span>
<span class="sd">          standard state, and configurational contributions</span>

<span class="sd">        - A SymPy expression for the ideal Gibbs free energy of solution</span>
<span class="sd">          contribution of the non-basis species. This sympy expression</span>
<span class="sd">          represents a term that involves an implicit summation over non-basis</span>
<span class="sd">          species. This expression may be parameterized using SymPy</span>
<span class="sd">          IndexedBase-class symbols and a sympy function describing the standard</span>
<span class="sd">          state chemical potential of the non-basis species.</span>

<span class="sd">        - A SymPy expression for the non-ideal Gibbs free energy of solution.</span>
<span class="sd">          The expression may be parameterized using an arbitrary number of SymPy</span>
<span class="sd">          IndexedBase-class symbols.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">model_type</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ideal&#39;</span><span class="p">),</span> <span class="n">debug_print</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">multiroot_method</span><span class="o">=</span><span class="s2">&quot;gsl_multiroot_fdfsolver_gnewton&quot;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">Cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Cb must be set.&#39;</span>
        <span class="k">assert</span> <span class="n">Cs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Cs must be set.&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nc</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">nw</span><span class="o">=</span><span class="n">nc</span><span class="o">+</span><span class="n">ns</span><span class="p">)</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="n">nc</span> <span class="k">if</span> <span class="n">nb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">nb</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ns</span>
        <span class="k">assert</span> <span class="n">nb</span> <span class="o">&gt;=</span> <span class="n">nc</span><span class="p">,</span> <span class="s1">&#39;Parameter nb must be equal to or exceed nc.&#39;</span>
        <span class="k">assert</span> <span class="n">ns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Parameter ns must be greater than zero.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nb</span> <span class="o">=</span> <span class="n">nb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ns</span> <span class="o">=</span> <span class="n">ns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Rgas</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Rgas&#39;</span><span class="p">)</span>

        <span class="c1"># Update standard state chemical potentials to include species</span>
        <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ns_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ss_string</span> <span class="o">=</span> <span class="s1">&#39;mu&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">nc</span><span class="p">)</span>
            <span class="n">ss_func</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">ss_string</span><span class="p">)(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss_func</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="o">.</span><span class="n">known_functions</span><span class="p">[</span><span class="n">ss_string</span><span class="p">]</span> <span class="o">=</span> \
            <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;].mu0)&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">.</span><span class="n">row_insert</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ss_list</span><span class="p">))</span>

        <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span><span class="o">+</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ss_string</span> <span class="o">=</span> <span class="s1">&#39;mu_e&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_mu_e</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu_ex</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu_e</span> <span class="o">=</span> <span class="n">f_mu_e</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_Cb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Cb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Cs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_R</span> <span class="o">=</span> <span class="n">R</span>

        <span class="c1"># Create basis species mole fractions</span>
        <span class="n">print_subs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nT</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">nT</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">entry</span> <span class="o">-=</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">print_subs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">entry</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print_subs</span> <span class="o">=</span> <span class="n">print_subs</span>

        <span class="c1"># Create index variables and functions for loop constructions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu_s</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;mu_s&#39;</span><span class="p">)(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_i</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_j</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ns</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_k</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span><span class="o">+</span><span class="n">ns</span><span class="p">))</span>
        <span class="n">ss_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="o">.</span><span class="n">known_functions</span><span class="p">[</span><span class="s1">&#39;mu_s&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="s1">&#39;(*endmember[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+j-1].mu0)&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="o">.</span><span class="n">nBasis</span> <span class="o">=</span> <span class="n">nb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="o">.</span><span class="n">forIndex</span> <span class="o">=</span> <span class="s1">&#39;j&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_debug_print</span> <span class="o">=</span> <span class="n">debug_print</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multiroot_method</span> <span class="o">=</span> <span class="n">multiroot_method</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">b_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Symbolic definitions of basis species</span>

<span class="sd">        A list of SymPy expressions that define the mole fractions of basis</span>
<span class="sd">        species (the elements of b_list) in terms of moles of endmember</span>
<span class="sd">        components and mole fractions of non-basis species (elements of s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of SymPy expressions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Cb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stoichiometric array mapping basis species to elements</span>

<span class="sd">        An array of nb rows and ne columns that maps the composition of basis</span>
<span class="sd">        species to moles of endmember components. Often, this matrix is the</span>
<span class="sd">        identity matrix, but that condition is not required. Cb must be an</span>
<span class="sd">        invertible matrix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Numpy 2d array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Cb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Cs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stoichiometric array mapping non-basis species to elements</span>

<span class="sd">        [description]</span>

<span class="sd">        Returns:</span>
<span class="sd">            [type] -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Cs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">debug_print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print debug messages from root solvers in generated C code</span>

<span class="sd">        Passed to code generation routines to flag generation of output related</span>
<span class="sd">        to the functioning of root finding and related numerical methods for</span>
<span class="sd">        speciation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug_print</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">i</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Index variable for looping over basis species</span>

<span class="sd">        A SymPy instance of the class Idx that is used to loop over terms in</span>
<span class="sd">        the Gibbs free energy that describe properties of basis species. The</span>
<span class="sd">        range of the index is 1 to nb+1. Use this symbol as an index for</span>
<span class="sd">        summation or product terms in the potential.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy.Idx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_j</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">j</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Index variable for looping over non-basis species</span>

<span class="sd">        A SymPy instance of the class Idx that is used to loop over terms in</span>
<span class="sd">        the Gibbs free energy that describe properties of non-basis species.</span>
<span class="sd">        The range of the index is 1 to ns+1. Use this symbol as an index for</span>
<span class="sd">        summation or product terms in the potential.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy.Idx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_j</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">k</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Index variable for looping over all species</span>

<span class="sd">        A SymPy instance of the class Idx that is used to loop over terms in</span>
<span class="sd">        the Gibbs free energy that describe properties of species. The range</span>
<span class="sd">        of the index is 1 to nb+ns+1. Use this symbol as an index for summation</span>
<span class="sd">        or product terms in the potential.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy.Idx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_j</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        1-d matrix of SymPy symbols for the chemical potentials of basis and</span>
<span class="sd">        non-basis species in the model</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The property definition is changed from that of the underlying Simple</span>
<span class="sd">        Solution superclass</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SymPy Matrix object (sympy.Matrix)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">multiroot_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to use in GNU Scientific Library (GSL) multiroot solver</span>

<span class="sd">        The gsl_multiroot_fdfsolver_type. Options are:</span>

<span class="sd">        &quot;gsl_multiroot_fdfsolver_hybridsj&quot;</span>

<span class="sd">        &quot;gsl_multiroot_fdfsolver_hybridj&quot;</span>

<span class="sd">        &quot;gsl_multiroot_fdfsolver_newton&quot;</span>

<span class="sd">        &quot;gsl_multiroot_fdfsolver_gnewton&quot; (default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multiroot_method</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mu_e</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic excess chemical potential of a non-basis species</span>

<span class="sd">        A SymPy instance of the class Function that is used to represent the</span>
<span class="sd">        value of the excess chemical potential of a non-basis species in an</span>
<span class="sd">        expression that loops species properties.  In such a loop, values</span>
<span class="sd">        of mu_e are replaced with specific entries of mu_ex[...] when the code</span>
<span class="sd">        is printed. The instance is a function of T, P, and n.</span>

<span class="sd">        By default, for an ideal solution this function returns a value of zero.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu_e</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mu_ex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A SymPy matrix of SymPy functions that calculate the excess chemical</span>
<span class="sd">        potential of each species in solution</span>

<span class="sd">        The functions must have arguments T, P and n, where T is temperature,</span>
<span class="sd">        P is pressure and n is a vector of mole numbers of basis species in</span>
<span class="sd">        solution.  The matrix has shape (nb+ns, 1)</span>

<span class="sd">        By default, for an ideal solution each function returns a value of zero.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy Matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu_ex</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mu_s</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic standard state chemical potenial of a non-basis species</span>

<span class="sd">        A SymPy instance of the class Function that is used to represent the</span>
<span class="sd">        value of the standard state Gibbs free energy of a non-basis species</span>
<span class="sd">        in an expression that loops species properties.  In such a loop, values</span>
<span class="sd">        of mu_s are replaced with specific entries of mu[...] when the code is</span>
<span class="sd">        printed. The instance is a function of T and P.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy.Function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu_s</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of basis species</span>

<span class="sd">        The number of basis spcies is generally equal to the number of</span>
<span class="sd">        thermodynamic components (nc) required to describe the solution phase.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of non-basis species</span>

<span class="sd">        The number of non-basis species is strictly positive but unbounded.</span>
<span class="sd">        Concentrations of non-basis species are determined by solution of mass</span>
<span class="sd">        action expressions corresponding to conditions of homogeneous</span>
<span class="sd">        equilibrium.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ns</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vector of SymPy symbols for indexed stoichiometric reaction coefficients</span>

<span class="sd">        A SymPy Matrix of length *nc* whose elements are instances of the</span>
<span class="sd">        SymPy class IndexedBase. These symbols are used to parameterize model</span>
<span class="sd">        Gibbs free energy expressions that require coefficients that map the</span>
<span class="sd">        stoichiometry of basis species to that of non-basis species; i.e.,</span>
<span class="sd">        (moles of non-basis species) = r[0]*(moles of 1st basis species) + ...</span>
<span class="sd">        r[nc-1]*(moles of nc-1 basis species).  Numerical values for these</span>
<span class="sd">        symbols will be assigned by letting r[...] denote rows of the numpy</span>
<span class="sd">        matrix R, where R is given by Cs (Cb)^-1. Cb is an array of nb rows and</span>
<span class="sd">        ne columns (ne is the number of elements; generally ne = nb) that maps</span>
<span class="sd">        the composition of basis species to moles of endmember components. Cs is</span>
<span class="sd">        an array of ns rows and ne columns that maps the composition of</span>
<span class="sd">        non-basis species to moles of endmember components. Numpy matrices Cb</span>
<span class="sd">        and Cs are provided to the class at the code generation step when</span>
<span class="sd">        calling the create_code_module() method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy.Matrix -- length nb</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SymPy Matrix of stoichiometric reaction coefficients</span>

<span class="sd">        A SymPy Matrix of shape (ns, nb) whose elements are constants that map</span>
<span class="sd">        the stoichiometry of basis species to that of non-basis species. The</span>
<span class="sd">        constants are SymPy compatible rational numbers. The columns of R are</span>
<span class="sd">        assigned to the elements of r at code generation.  See the description</span>
<span class="sd">        of the r property for further explanation as to how R is defined.</span>

<span class="sd">        R need be specified only if one or more of the expressions added to the</span>
<span class="sd">        model contain a SymPy IndexedBase variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy Matrix (ns,nb)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_R</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Rgas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sympy symbol for the Universal gas constant</span>

<span class="sd">        The universal gas constant used as a parameter in constructing expresions</span>
<span class="sd">        for the Gibbs free energy. Must be given units and a parameter value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SymPy Symbol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Rgas</span>

<div class="viewcode-block" id="SpeciationSolnModel.create_ordering_code"><a class="viewcode-back" href="../coder.html#coder.SpeciationSolnModel.create_ordering_code">[docs]</a>    <span class="k">def</span> <span class="nf">create_ordering_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moles_assign_text</span><span class="p">,</span> <span class="n">order_assign_text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates ordering function code for a speciation solution model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        moles_assign_text : str</span>
<span class="sd">            Text string containing C code for assigning moles of each</span>
<span class="sd">            component (n1, n2, ..., nc) from a vector of moles, n.</span>

<span class="sd">        order_assign_text : str</span>
<span class="sd">            Text string containing C code for assigning values of each</span>
<span class="sd">            ordering variable (s1, s2, ..., ss) from a vector, s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : str</span>
<span class="sd">            String of code that implements ordering functions and derivatives.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The user does not normally call this function directly.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">n</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>
        <span class="n">s</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;    double b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; = b[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="n">order_assign_text</span>

        <span class="n">cb_5</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_5</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_6</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_6</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_7</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_7</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_8</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdn2ds[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_8</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_9</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdndsdt[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;], d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_9</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>

        <span class="n">cb_10</span> <span class="o">=</span> <span class="s1">&#39;    double d2gdnds[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdndsdp[&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdnds2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_11</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdsdt2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_12</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gdsdtdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds2dt[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                 <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>
        <span class="n">cb_13</span>  <span class="o">=</span> <span class="s1">&#39;    double d2gdsdp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gdsdp2[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> \
                 <span class="s1">&#39;],d3gds2dp[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;],d3gds3[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;][&#39;</span><span class="o">+</span> \
                 <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;][&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">moles_assign_text</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="c1"># d2gdnds[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdnds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_5</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="c1"># d3gdndsdt[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdndsdt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_9</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="c1"># d3gdndsdp[{NC}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdndsdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                    <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="c1"># d3gdn2ds[{NC}][{NC}][{NS}]</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> \
                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_8</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">cb_8</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdn2ds[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="c1"># d3gdnds2[{NC}][{NS}][{NS}]</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> \
                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span>
                        <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                        <span class="n">cb_8</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">cb_9</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">cb_10</span> <span class="o">+=</span> <span class="s1">&#39;    d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> \
                                 <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = d3gdnds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                 <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="c1"># d2gdsdt[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdsdt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_6</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d2gdsdp[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d2gdsdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_7</span>  <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdt2[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdt2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdtdp[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdtdp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">))</span> \
               <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="c1"># d3gdsdp2[{NS}]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gdsdp2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="c1"># d3gds2dt[{NS}][{NS}]</span>
                <span class="n">a</span>  <span class="o">=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">cb_9</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                          <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_11</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dt[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1"># d3gds2dp[{NS}][{NS}]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">cb_13</span> <span class="o">+=</span> <span class="s1">&#39;    d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span> \
                           <span class="o">+</span> <span class="s1">&#39;d3gds2dp[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="c1"># d3gds3[{NS}][{NS}][{NS}]</span>
                    <span class="n">a</span>  <span class="o">=</span> <span class="s1">&#39;    d3gds3[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> \
                         <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">a</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_indices</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;d3gds3&#39;</span><span class="p">)</span>
                    <span class="n">cb_8</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_9</span>  <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_10</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_11</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_12</span> <span class="o">+=</span> <span class="n">a</span>
                    <span class="n">cb_13</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_speciation_ordering_code_template</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">NS</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">NC</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_FIVE</span><span class="o">=</span><span class="n">cb_5</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_SIX</span><span class="o">=</span><span class="n">cb_6</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_SEVEN</span><span class="o">=</span><span class="n">cb_7</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_EIGHT</span><span class="o">=</span><span class="n">cb_8</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_NINE</span><span class="o">=</span><span class="n">cb_9</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_TEN</span><span class="o">=</span><span class="n">cb_10</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_ELEVEN</span><span class="o">=</span><span class="n">cb_11</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_TWELVE</span><span class="o">=</span><span class="n">cb_12</span><span class="p">,</span>
            <span class="n">ORDER_CODE_BLOCK_THIRTEEN</span><span class="o">=</span><span class="n">cb_13</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpeciationSolnModel.create_code_module"><a class="viewcode-back" href="../coder.html#coder.SpeciationSolnModel.create_code_module">[docs]</a>    <span class="k">def</span> <span class="nf">create_code_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;IdealGas&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">endmembers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="s2">&quot;fast&quot;</span><span class="p">,</span>
        <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates include and code file for a model instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : str</span>
<span class="sd">            Model instance title (e.g., phase name).  Used to name the generated</span>
<span class="sd">            function. Cannot contain blanks or special characters; underscore</span>
<span class="sd">            (&quot;_&quot;) is permitted. Convention capitalizes the first letter and letter</span>
<span class="sd">            following a &quot;_&quot; character.</span>
<span class="sd">        params : dict</span>
<span class="sd">            Parameter values for the model instance.</span>
<span class="sd">            The keys of this dictionary are validated against parameter symbols</span>
<span class="sd">            stored for the model.</span>
<span class="sd">        endmembers : list of str</span>
<span class="sd">            A list of prefixes for standard state property functions for the</span>
<span class="sd">            endmember components of this solution. e.g., &quot;Albite_berman&quot; will</span>
<span class="sd">            be used to call functions with names like Albite_berman_g(...)</span>
<span class="sd">            If the standard state property routines are coded by the</span>
<span class="sd">            StdStateModel Class in this module, all required functions will be</span>
<span class="sd">            generated and they will automatically be compliant with this naming</span>
<span class="sd">            convention. There must be nc+ns entries in this list, i.e.,</span>
<span class="sd">            list elements must include basis + non-basis species in an order</span>
<span class="sd">            that is internally consistent with specification of the G function.</span>
<span class="sd">        identifier : str</span>
<span class="sd">            A unique identifier for the model instance.</span>
<span class="sd">            Defaults to date/time when module is created (rounded to the second).</span>
<span class="sd">        prefix : str</span>
<span class="sd">            Prefix to function names for python bindings, e.g.,</span>
<span class="sd">            {prefix}_{phase}_{module}_g(T,P)</span>
<span class="sd">        module_type : str</span>
<span class="sd">            Generate code that executes &quot;fast&quot;, but does not expose hooks for</span>
<span class="sd">            model parameter calibration. Alternately, generate code suitable for</span>
<span class="sd">            &quot;calib&quot;ration of parameters in the model, which executes more slowly</span>
<span class="sd">            and exposes additional functions that allow setting of parameters</span>
<span class="sd">            and generation of derivatives of thermodynamic functions with</span>
<span class="sd">            respect to model parameters.</span>
<span class="sd">        silent : bool</span>
<span class="sd">            Do not print status messages.</span>
<span class="sd">        language : str</span>
<span class="sd">            Language syntax for generated code, (&quot;C&quot; is the C99 programming</span>
<span class="sd">            language.)</span>
<span class="sd">        minimal_deriv_set : bool</span>
<span class="sd">            Generate a minimal set of compositional derivatives: dgdn, d2gdndt,</span>
<span class="sd">            d2gdndp, d3gdndt2, d3gdndtdp, d3gdndp2, d4gdndt3, d4gdndt2dp,</span>
<span class="sd">            d4gdndtdp2, d4gdndp3, d2gdn2, d3gdn2dt, d3gdn2dp, d3gdn3.  This is</span>
<span class="sd">            the subset of derivatives currently required for solution phases</span>
<span class="sd">            that are imported into the phases module. Remaining derivatives are</span>
<span class="sd">            returned with values of zero.</span>
<span class="sd">        debug : int</span>
<span class="sd">            Level of debugging output generated by module:</span>
<span class="sd">            0 : None</span>
<span class="sd">            1 : Informational messages</span>
<span class="sd">            2 : Informational plus normal debugging messages</span>
<span class="sd">            3 : Verbose informational and debugging messages</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : Boolean</span>
<span class="sd">                 True if module is succesfully generated, False if some error</span>
<span class="sd">                 occurred</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method overrides that of the super class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ns</span>

        <span class="c1"># Generate Simple Solution code files</span>
        <span class="n">success</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SpeciationSolnModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">create_code_module</span><span class="p">(</span>
            <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">endmembers</span><span class="o">=</span><span class="n">endmembers</span><span class="p">[:</span><span class="n">nc</span><span class="p">],</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">module_type</span><span class="o">=</span><span class="n">module_type</span><span class="p">,</span>
            <span class="n">silent</span><span class="o">=</span><span class="n">silent</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">minimal_deriv_set</span><span class="o">=</span><span class="n">minimal_deriv_set</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># Updates to fast calc_h file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Updating code blocks for speciation code.&quot;</span><span class="p">)</span>

        <span class="c1"># Use this text to search for code injection points</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
        <span class="c1"># Generate code to inject after these lines</span>
        <span class="n">Cb_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">Cs_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nb</span><span class="p">):</span>
                <span class="n">Cb_text</span> <span class="o">+=</span> <span class="s1">&#39;        gsl_matrix_set(params.Cb, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;);</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">Cs_text</span> <span class="o">+=</span> <span class="s1">&#39;        gsl_matrix_set(params.Cs, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;);</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">speciation_template</span> <span class="o">=</span> <span class="n">tpl</span><span class="o">.</span><span class="n">create_speciation_code_template</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
        <span class="c1"># generate fill_invd2gds2 for speciation insert</span>
        <span class="n">moles_assign_text</span>  <span class="o">=</span> <span class="s1">&#39;    double T = t;</span><span class="se">\n</span><span class="s1">    double P = p;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double n&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = e[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="n">moles_assign_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">invd2gds2_text</span> <span class="o">=</span> <span class="n">moles_assign_text</span> <span class="o">+</span> <span class="s1">&#39;    double &#39;</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39;s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
        <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;    s&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = s[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">sFunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordering_functions</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
            <span class="c1"># invd2gds2[0][0] = D2GDS0S0;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;    invd2gds2[&#39;</span>
                <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = &#39;</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sFunc</span><span class="o">.</span><span class="n">function</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;    invd2gds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;][&#39;</span>
                    <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = invd2gds2[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;][&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;    invd2gds2[0][0] = 1.0/invd2gds2[0][0];</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">invd2gds2_text</span> <span class="o">+=</span> <span class="s1">&#39;    gaussj(invd2gds2);&#39;</span>
        <span class="n">code_to_inject</span> <span class="o">=</span> <span class="n">speciation_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_components</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span>
            <span class="n">number_non_basis</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">gsl_multiroot_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiroot_method</span><span class="p">,</span>
            <span class="n">fill_Cb</span><span class="o">=</span><span class="n">Cb_text</span><span class="p">,</span>
            <span class="n">fill_Cs</span><span class="o">=</span><span class="n">Cs_text</span><span class="p">,</span>
            <span class="n">fill_invd2gds2</span><span class="o">=</span><span class="n">invd2gds2_text</span><span class="p">)</span>

        <span class="c1"># Retreive the file to modify</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calc.h&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">code_to_inject</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>

        <span class="c1"># Use this text to search for code injection points</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;    order_s(T, P, n, s, invd2gds2);</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># Add code to call speciation routine</span>
        <span class="n">code_to_add</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;    double b[</span><span class="si">{nc}</span><span class="s2">];</span>
<span class="s2">    speciate(T, P, n, b, s, invd2gds2, </span><span class="si">{debug}</span><span class="s2">);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">debug</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span><span class="n">nc</span><span class="o">=</span><span class="n">nc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">code_to_add</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;    double b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; = b[&#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;];&#39;</span><span class="p">)</span>
            <span class="n">code_to_add</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">code_to_add</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>

        <span class="c1">#order parameter derivatives</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdt(T, P, n, s, invd2gds2, dsdt)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_dsdt(T, P, n, b, s, invd2gds2, dsdt)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdp(T, P, n, s, invd2gds2, dsdp)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_dsdp(T, P, n, b, s, invd2gds2, dsdp)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdn(T, P, n, s, invd2gds2, dsdn)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_dsdn(T, P, n, b, s, invd2gds2, dsdn)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdt2(T, P, n, b, s, invd2gds2, d2sdt2)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdtdp(T, P, n, b, s, invd2gds2, d2sdtdp)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdp2(T, P, n, b, s, invd2gds2, d2sdp2)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdndt(T, P, n, s, invd2gds2, d2sdndt)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdndt(T, P, n, b, s, invd2gds2, d2sdndt)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdndp(T, P, n, s, invd2gds2, d2sdndp)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdndp(T, P, n, b, s, invd2gds2, d2sdndp)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdn2(T, P, n, s, invd2gds2, d2sdn2)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;order_d2sdn2(T, P, n, b, s, invd2gds2, d2sdn2)&#39;</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>

        <span class="c1"># Write modified code</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calc.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fnew</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1">#</span>
        <span class="c1"># Update the _calib.h files if it was generated</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">fold</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">code_to_add</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="c1">#order parameter derivatives</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdt(T, P, n, s, invd2gds2, dsdt)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_dsdt(T, P, n, b, s, invd2gds2, dsdt)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdp(T, P, n, s, invd2gds2, dsdp)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_dsdp(T, P, n, b, s, invd2gds2, dsdp)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdn(T, P, n, s, invd2gds2, dsdn)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_dsdn(T, P, n, b, s, invd2gds2, dsdn)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_dsdw(T, P, n, s, invd2gds2, dsdw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_dsdw(T, P, n, b, s, invd2gds2, dsdw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdt2(T, P, n, s, invd2gds2, d2sdt2)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdt2(T, P, n, b, s, invd2gds2, d2sdt2)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdtdp(T, P, n, s, invd2gds2, d2sdtdp)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdtdp(T, P, n, b, s, invd2gds2, d2sdtdp)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdtdw(T, P, n, s, invd2gds2, d2sdtdw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdtdw(T, P, n, b, s, invd2gds2, d2sdtdw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdp2(T, P, n, s, invd2gds2, d2sdp2)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdp2(T, P, n, b, s, invd2gds2, d2sdp2)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdpdw(T, P, n, s, invd2gds2, d2sdpdw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdpdw(T, P, n, b, s, invd2gds2, d2sdpdw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdndt(T, P, n, s, invd2gds2, d2sdndt)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdndt(T, P, n, b, s, invd2gds2, d2sdndt)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdndp(T, P, n, s, invd2gds2, d2sdndp)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdndp(T, P, n, b, s, invd2gds2, d2sdndp)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d2sdn2(T, P, n, s, invd2gds2, d2sdn2)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d2sdn2(T, P, n, b, s, invd2gds2, d2sdn2)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdt3(T, P, n, s, invd2gds2, d3sdt3)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdt3(T, P, n, b, s, invd2gds2, d3sdt3)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdt2dp(T, P, n, s, invd2gds2, d3sdt2dp)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdt2dp(T, P, n, b, s, invd2gds2, d3sdt2dp)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdt2dw(T, P, n, s, invd2gds2, d3sdt2dw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdt2dw(T, P, n, b, s, invd2gds2, d3sdt2dw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdtdp2(T, P, n, s, invd2gds2, d3sdtdp2)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdtdp2(T, P, n, b, s, invd2gds2, d3sdtdp2)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdtdpdw(T, P, n, s, invd2gds2, d3sdtdpdw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdtdpdw(T, P, n, b, s, invd2gds2, d3sdtdpdw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdp3(T, P, n, s, invd2gds2, d3sdp3)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdp3(T, P, n, b, s, invd2gds2, d3sdp3)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;order_d3sdp2dw(T, P, n, s, invd2gds2, d3sdp2dw)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;order_d3sdp2dw(T, P, n, b, s, invd2gds2, d3sdp2dw)&#39;</span><span class="p">)</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span><span class="o">+</span><span class="s1">&#39;_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fnew</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1">#</span>
        <span class="c1"># Updates to calc_c file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Updating code blocks for standard state properties.&quot;</span><span class="p">)</span>

        <span class="n">code_block_find_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">code_block_repl_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">incl_block_find_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">incl_block_repl_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">ss_xx</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span> <span class="k">else</span> <span class="s1">&#39;_calib&#39;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">endmembers</span><span class="p">):</span>
            <span class="n">code_block_text</span>  <span class="o">=</span> <span class="s1">&#39;  {</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_name,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_formula,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_mw,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_elements,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_g,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_dgdt,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_dgdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdt2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdtdp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d2gdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt3,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdt2dp,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdtdp2,</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;_d3gdp3</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code_block_text</span> <span class="o">+=</span> <span class="s1">&#39;  },</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                <span class="n">incl_block_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;#include &quot;&#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s1">&#39;_calc.h&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                <span class="n">incl_block_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;#include &quot;&#39;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s1">&#39;_calib.h&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nc</span><span class="p">:</span>
                <span class="n">code_block_find_text</span> <span class="o">+=</span> <span class="n">code_block_text</span>
                <span class="n">incl_block_find_text</span> <span class="o">+=</span> <span class="n">incl_block_text</span>
            <span class="n">code_block_repl_text</span> <span class="o">+=</span> <span class="n">code_block_text</span>
            <span class="n">incl_block_repl_text</span> <span class="o">+=</span> <span class="n">incl_block_text</span>

        <span class="c1"># Open file and replace code</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;.c&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">code_block_find_text</span><span class="p">,</span> <span class="n">code_block_repl_text</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">incl_block_find_text</span><span class="p">,</span> <span class="n">incl_block_repl_text</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>
        <span class="n">x</span>   <span class="o">=</span> <span class="s1">&#39;static int nc = (sizeof endmember / sizeof(struct _endmembers));&#39;</span>
        <span class="n">rx</span>  <span class="o">=</span> <span class="s1">&#39;static int nc = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="s1">&#39;static int ns = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>
        <span class="n">fold</span><span class="o">=</span><span class="n">fnew</span>

        <span class="c1"># Add R matrix constants for loop code</span>
        <span class="n">add_R_code</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_parts</span><span class="p">:</span>
            <span class="n">add_R_code</span> <span class="o">|=</span> <span class="n">exp</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add_R_code</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> \
                <span class="s1">&#39;R must be specified because an expression contains an &#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;IndexedBase SymPy symbol.&#39;</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">ns</span><span class="p">,</span><span class="n">nb</span><span class="p">),</span> \
                <span class="s1">&#39;R has shape &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> \
                <span class="s1">&#39;when it should have shape &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">ns</span><span class="p">,</span><span class="n">nb</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;static const double R=8.3143;&#39;</span>
            <span class="n">rx</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nb</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">rx</span> <span class="o">+=</span> <span class="s1">&#39;static const double r&#39;</span>
                <span class="n">rx</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;] = {&#39;</span>
                <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39; 0, &#39;</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ns</span><span class="p">):</span>
                    <span class="n">rx</span> <span class="o">+=</span> <span class="n">delim</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span>
                <span class="n">rx</span> <span class="o">+=</span> <span class="s1">&#39; };</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>

        <span class="c1"># Write modified code</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span> <span class="o">+</span> <span class="n">ss_xx</span> <span class="o">+</span> <span class="s1">&#39;.c&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fnew</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1">#</span>
        <span class="c1"># Updates to pyxbld file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Updating _pyxbld file.&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;.pyxbld&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">x</span>   <span class="o">=</span> <span class="s2">&quot;=[&#39;-O3&#39;]&quot;</span>
        <span class="n">rx</span>  <span class="o">=</span> <span class="s2">&quot;=[&#39;-O3&#39;],</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="s2">&quot;                     libraries=[&#39;gsl&#39;, &#39;speciation&#39;],</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="s2">&quot;                     library_dirs=[&#39;/usr/local/lib&#39;],</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="s2">&quot;                     runtime_library_dirs=[&#39;/usr/local/lib&#39;]&quot;</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">fnew</span>

        <span class="n">c_file_name</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">module</span>
        <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
            <span class="n">c_file_name</span> <span class="o">+=</span> <span class="s1">&#39;_calib.c&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_file_name</span> <span class="o">+=</span> <span class="s1">&#39;_calc.c&#39;</span>
        <span class="n">new_pyx_file_list</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">c_file_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="n">old_pyx_file_list</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">c_file_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">endmembers</span><span class="p">):</span>
            <span class="n">new_pyx_file_list</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span>
            <span class="n">old_pyx_file_list</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nc</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;fast&#39;</span><span class="p">:</span>
                <span class="n">new_pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calc.c&#39;&quot;</span>
                <span class="n">old_pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calc.c&#39;&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nc</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="n">module_type</span> <span class="o">==</span> <span class="s1">&#39;calib&#39;</span><span class="p">:</span>
                <span class="n">new_pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calib.c&#39;&quot;</span>
                <span class="n">old_pyx_file_list</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_calib.c&#39;&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nc</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">fnew</span> <span class="o">=</span> <span class="n">fold</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_pyx_file_list</span><span class="p">,</span> <span class="n">new_pyx_file_list</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">module</span> <span class="o">+</span> <span class="s1">&#39;.pyxbld&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fnew</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Updates completed.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">success</span></div></div>

<span class="c1">###############</span>
<span class="c1"># end of file #</span>
<span class="c1">###############</span>
</pre></div>

          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>