<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>phases &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../None"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="../index.html" >
    <link rel="up" title="Module code" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="ENKI" src="../_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="../index.html">Thermoengine 1.0.1 documentation</a></li>
	
          <li class="active"><a href="index.html" accesskey="U">Module code</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <h1>Source code for phases</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides Python wrappers to individual and collections of phases.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># from thermoengine.core import *</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">chem</span>

<span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;data/phases&#39;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">import_module</span><span class="p">,</span> <span class="n">invalidate_caches</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># specialized numerical imports</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">optim</span>

<span class="c1"># __all__ = [&#39;Rxn&#39;,&#39;Assemblage&#39;,&#39;PurePhase&#39;,&#39;SolutionPhase&#39;,&#39;get_phaselist&#39;]</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rxn&#39;</span><span class="p">,</span><span class="s1">&#39;Assemblage&#39;</span><span class="p">,</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span><span class="s1">&#39;PurePhase&#39;</span><span class="p">,</span><span class="s1">&#39;SolutionPhase&#39;</span><span class="p">,</span><span class="s1">&#39;get_phaselist&#39;</span><span class="p">]</span>

<span class="n">PURE_PHASE_FILE</span> <span class="o">=</span> <span class="s1">&#39;PurePhaseList.csv&#39;</span>
<span class="n">SOLUTION_PHASE_FILE</span> <span class="o">=</span> <span class="s1">&#39;SolutionPhaseList.csv&#39;</span>

<span class="c1"># inputs</span>
<span class="c1">#</span>
<span class="c1"># * P=1, T=1, mol=1</span>
<span class="c1"># * P=N_PTX, T=1, mol=1</span>
<span class="c1"># * P=1, T=N_PTX, mol=1</span>
<span class="c1"># * P=1, T=1, mol = N_PTX</span>
<span class="c1"># * P=N_PTX, T=N_PTX, mol=N_PTX</span>
<span class="c1">#</span>
<span class="c1"># qty</span>
<span class="c1">#</span>
<span class="c1"># * N_endmem (deriv_type)</span>
<span class="c1"># * N_rxn</span>
<span class="c1"># * N_phase</span>
<span class="c1">#</span>
<span class="c1"># outputs</span>
<span class="c1">#</span>
<span class="c1"># * N_PTX,</span>
<span class="c1"># * N_PTX, N_endmem</span>
<span class="c1"># * N_PTX, N_endmem, N_endmem</span>
<span class="c1">#</span>
<span class="c1"># * N_phase,</span>
<span class="c1"># * N_rxn, N_phase</span>
<span class="c1"># * N_rxn, N_phase, N_PTX</span>
<span class="c1">#</span>
<span class="c1"># * reduce dimensions if N_PTX=1</span>
<span class="c1">#===================================================</span>
<span class="k">def</span> <span class="nf">get_phase_info</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get acceptable table of basic phase info</span>
<span class="sd">        (e.g., name, abbrev, formula, members, etc.).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    phase_table : dict</span>
<span class="sd">        Dictionary containing phase information.</span>
<span class="sd">            - &#39;purephases&#39; : pandas dataframe</span>
<span class="sd">            - &#39;purefilenm&#39; : str defining source file for pure phase info</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">phase_info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">phase_info</span><span class="p">[</span><span class="s1">&#39;pure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_read_phase_info</span><span class="p">(</span><span class="n">PURE_PHASE_FILE</span><span class="p">)</span>
    <span class="n">phase_info</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_read_phase_info</span><span class="p">(</span><span class="n">SOLUTION_PHASE_FILE</span><span class="p">)</span>

    <span class="n">info_files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info_files</span><span class="p">[</span><span class="s1">&#39;pure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PURE_PHASE_FILE</span>
    <span class="n">info_files</span><span class="p">[</span><span class="s1">&#39;solution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SOLUTION_PHASE_FILE</span>
    <span class="k">return</span> <span class="n">phase_info</span><span class="p">,</span> <span class="n">info_files</span>

<span class="k">def</span> <span class="nf">_read_phase_info</span><span class="p">(</span><span class="n">filenm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read phase info tables</span>

<span class="sd">    Internal method to read phase abbreviations and names from csv files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parentpath</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="n">pathname</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parentpath</span><span class="p">,</span><span class="n">DATADIR</span><span class="p">,</span><span class="n">filenm</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
       <span class="n">phases_info_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pathname</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span><span class="s1">&#39;The &#39;</span><span class="o">+</span><span class="n">pathname</span><span class="o">+</span><span class="s1">&#39; file cannot be found. &#39;</span>\
            <span class="s1">&#39;It is needed to define the standard phase abbreviations.&#39;</span>

    <span class="k">return</span> <span class="n">phases_info_df</span>
<span class="c1">#===================================================</span>
<span class="k">class</span> <span class="nc">FixedRxnSet</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_symbols</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span>
                 <span class="n">phases_dict</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">,):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_init_rxn_set</span><span class="p">(</span><span class="n">phase_symbols</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span>
                           <span class="n">phases_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_exp_cond</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_rxn_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_symbols</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span>
                      <span class="n">phases_dict</span><span class="p">):</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
            <span class="p">[</span><span class="n">sym</span> <span class="ow">in</span> <span class="n">phases_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">phase_symbols</span> <span class="p">]),</span> <span class="p">(</span>
                <span class="s1">&#39;phase symbols must appear in phase_obj_dict&#39;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span> <span class="o">=</span> <span class="n">phase_symbols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_ids</span> <span class="o">=</span> <span class="n">endmember_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rxn_coefs</span> <span class="o">=</span> <span class="n">rxn_coefs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phases_dict</span> <span class="o">=</span> <span class="n">phases_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rxn_num</span> <span class="o">=</span> <span class="n">rxn_coefs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_num</span> <span class="o">=</span> <span class="n">rxn_coefs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_init_exp_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">):</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span>

        <span class="c1"># validate mols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mol_input</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
            <span class="p">[</span><span class="n">sym</span> <span class="ow">in</span> <span class="n">phase_symbols</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">mols</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),(</span>
                <span class="s1">&#39;molar composition must be defines for every phase&#39;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mols</span> <span class="o">=</span> <span class="n">mols</span>

    <span class="k">def</span> <span class="nf">_validate_mol_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">mols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mols</span>

        <span class="n">phases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_symbols</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">phase_symbols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">mols</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">symbol</span> <span class="ow">in</span> <span class="n">phase_symbols</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">mols</span><span class="o">.</span><span class="n">keys</span><span class="p">()])),</span> <span class="p">(</span>
                <span class="s1">&#39;Invalid phase symbol(s) used to define phase &#39;</span>
                <span class="s1">&#39;composition in mols. Only use valid phase symbols &#39;</span>
                <span class="s1">&#39;found in rxn.phase_symbols.&#39;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">mols</span>

    <span class="k">def</span> <span class="nf">affinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rxn_coefs</span>

        <span class="n">phase_chem_potentials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_chem_potentials</span><span class="p">()</span>
        <span class="n">chem_potentials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endmem_chem_potentials</span><span class="p">(</span>
            <span class="n">phase_chem_potentials</span><span class="p">)</span>

        <span class="n">affinities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">,</span> <span class="n">chem_potentials</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">affinities</span>

    <span class="k">def</span> <span class="nf">endmem_chem_potentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_chem_potentials</span><span class="p">):</span>
        <span class="n">endmember_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_num</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span>
        <span class="n">endmember_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_ids</span>

        <span class="n">chem_potentials</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">endmember_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="p">(</span><span class="n">phs_sym</span><span class="p">,</span> <span class="n">endmem_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">phase_symbols</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">)):</span>
            <span class="n">chem_potentials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase_chem_potentials</span><span class="p">[</span><span class="n">phs_sym</span><span class="p">][</span><span class="n">endmem_id</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">chem_potentials</span>

    <span class="k">def</span> <span class="nf">phase_chem_potentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">phases_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases_dict</span>

        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_T</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_P</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mols</span>

        <span class="n">phase_chem_potentials</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">phs_sym</span> <span class="ow">in</span> <span class="n">phases_dict</span><span class="p">:</span>
            <span class="n">phs</span> <span class="o">=</span> <span class="n">phases_dict</span><span class="p">[</span><span class="n">phs_sym</span><span class="p">]</span>
            <span class="n">phase_chem_potentials</span><span class="p">[</span><span class="n">phs_sym</span><span class="p">]</span> <span class="o">=</span> <span class="n">phs</span><span class="o">.</span><span class="n">chem_pot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">phase_chem_potentials</span>




<span class="c1">#===================================================</span>
<div class="viewcode-block" id="Rxn"><a class="viewcode-back" href="../phases.html#phases.Rxn">[docs]</a><span class="k">class</span> <span class="nc">Rxn</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that defines identity/properties of a specific phase reaction.</span>

<span class="sd">    Reactions occur between phases (either pure or solution) and are</span>
<span class="sd">    defined in terms of the participating endmembers, indicating which atoms</span>
<span class="sd">    are exchanged between phases during the reaction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase_objs : array of Phase Objects</span>
<span class="sd">        Defines which phases participate in the reaction.</span>
<span class="sd">    endmember_ids : int array</span>
<span class="sd">        Indicates the endmember of each phase that participates in the reaction.</span>
<span class="sd">        This array must have the same order as the phase array (phase_objs).</span>
<span class="sd">    rxn_coefs : double array</span>
<span class="sd">        Defines the stoichiometric rxn coefficient, where negative values</span>
<span class="sd">        are reactants and positive values are products. The reaction must be</span>
<span class="sd">        balanced (obeying mass conservation).</span>
<span class="sd">        This array must have the same order as the phase array (phase_objs).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    endmember_ids</span>
<span class="sd">    endmember_names</span>
<span class="sd">    phase_num</span>
<span class="sd">    phase_symbols</span>
<span class="sd">    phases</span>
<span class="sd">    product_phases</span>
<span class="sd">    reactant_phases</span>
<span class="sd">    rxn_coefs</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * The phases themselves may be pure or have realistic</span>
<span class="sd">      intermediate compositions (if they are solution phases).</span>
<span class="sd">    * The reaction is defined in terms of the exchange of endmembers between</span>
<span class="sd">      the participating phases.</span>
<span class="sd">    * Reaction coefficients correspond to a balanced stoichiometric reaction.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span>
                 <span class="n">coefs_per_atom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_inputs</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_rxn</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span>
                              <span class="n">coefs_per_atom</span><span class="p">)</span>

        <span class="c1"># TK</span>
        <span class="c1"># self._validate_rxn_balance</span>

        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_validate_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">):</span>
        <span class="n">Nphase</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">)</span>
        <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">endmember_ids</span><span class="p">)</span> <span class="o">==</span> <span class="n">Nphase</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;endmember_ids must provide endmember index for &#39;</span>
            <span class="s1">&#39;every reaction phase. &#39;</span>
            <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">)</span> <span class="o">==</span> <span class="n">Nphase</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;rxn_coefs must provide stoichiometric &#39;</span>
            <span class="s1">&#39;coefficients for every reaction phase.&#39;</span>
            <span class="p">)</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span>
            <span class="s1">&#39;rxn_coefs must indicate reactants with negative &#39;</span>
            <span class="s1">&#39;sign and products with positive sign. Currently, &#39;</span>
            <span class="s1">&#39;none of the stoichiometric coefficients are negative.&#39;</span>
            <span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span>
            <span class="s1">&#39;rxn_coefs must indicate reactants with negative &#39;</span>
            <span class="s1">&#39;sign and products with positive sign. Currently, &#39;</span>
            <span class="s1">&#39;none of the stoichiometric coefficients are positive.&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_rxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">,</span> <span class="n">coefs_per_atom</span><span class="p">):</span>
        <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trim_absent_rxn_phases</span><span class="p">(</span>
                <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">))</span>

        <span class="n">phase_objs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">)</span>
        <span class="n">endmember_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">endmember_ids</span><span class="p">)</span>

        <span class="n">Nphase</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">)</span>
        <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">)</span>

        <span class="n">all_atom_nums</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">phs</span><span class="p">,</span> <span class="n">endmember_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">):</span>
            <span class="n">endmember_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">endmember_id</span><span class="p">)</span>
            <span class="n">iatom_num</span> <span class="o">=</span> <span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;atom_num&#39;</span><span class="p">][</span><span class="n">endmember_id</span><span class="p">]</span>
            <span class="n">all_atom_nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iatom_num</span><span class="p">)</span>
        <span class="n">all_atom_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_atom_nums</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coefs_per_atom</span><span class="p">:</span>
            <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="n">rxn_coefs</span><span class="o">/</span><span class="n">all_atom_nums</span>

        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">endmember_names</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">phase_obj</span><span class="p">,</span> <span class="n">iendmember_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">):</span>
            <span class="n">phase_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">phase_obj</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">])</span>

            <span class="n">endmember_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">phase_obj</span><span class="o">.</span><span class="n">endmember_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">iendmember_id</span><span class="p">)])</span>



        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phase_symbols</span><span class="p">)</span>

        <span class="c1"># indsort = np.argsort(phase_symbols)</span>
        <span class="c1"># self._set_phase_assemblage(</span>
        <span class="c1">#     phase_objs[indsort], phase_symbols[indsort],</span>
        <span class="c1">#     obj_is_classnm=obj_is_classnm)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_num</span> <span class="o">=</span> <span class="n">Nphase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span> <span class="o">=</span> <span class="n">phase_symbols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span> <span class="o">=</span> <span class="n">phase_objs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_ids</span> <span class="o">=</span> <span class="n">endmember_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_names</span> <span class="o">=</span> <span class="n">endmember_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rxn_coefs</span> <span class="o">=</span> <span class="n">rxn_coefs</span>

    <span class="k">def</span> <span class="nf">_trim_absent_rxn_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span><span class="p">):</span>
        <span class="n">remove_set</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rxn_coefs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># re-create lists for items not in remove set</span>
        <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_set</span><span class="p">]</span>
        <span class="n">phase_objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_set</span><span class="p">]</span>
        <span class="n">endmember_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">endmember_ids</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_set</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">,</span> <span class="n">rxn_coefs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of phases</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Number of phases (int)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_num</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Phase objects used in the reaction</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of phase objects used in the reaction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reactant_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reactant phases</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of reactant phase objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rxn_coefs</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">product_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Product phases</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of product phase objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rxn_coefs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Phase symbols</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of phase symbols used in the reaction (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endmember_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ID number of each endmember in phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of ids, [int,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_ids</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endmember_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of each endmember</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of endmember names for this solution phase, [str,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endmember_names</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rxn_coefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reaction coefficients</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of reaction coefficients (double)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rxn_coefs</span>

    <span class="k">def</span> <span class="nf">_validate_mol_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">mols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mols</span>

        <span class="n">phases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_symbols</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">phase_symbols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">mols</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">symbol</span> <span class="ow">in</span> <span class="n">phase_symbols</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">mols</span><span class="o">.</span><span class="n">keys</span><span class="p">()])),</span> <span class="p">(</span>
                <span class="s1">&#39;Invalid phase symbol(s) used to define phase &#39;</span>
                <span class="s1">&#39;composition in mols. Only use valid phase symbols &#39;</span>
                <span class="s1">&#39;found in rxn.phase_symbols.&#39;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">mols</span>

<div class="viewcode-block" id="Rxn.affinity"><a class="viewcode-back" href="../phases.html#phases.Rxn.affinity">[docs]</a>    <span class="k">def</span> <span class="nf">affinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate reaction affinity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : dict of arrays, optional</span>
<span class="sd">            Composition of each phase in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Reaction affinity in J</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">affinity</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">chem_potential</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">affinity</span></div>

<div class="viewcode-block" id="Rxn.chem_potential"><a class="viewcode-back" href="../phases.html#phases.Rxn.chem_potential">[docs]</a>    <span class="k">def</span> <span class="nf">chem_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate net chemical potential change of the reaction</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : dict of arrays, optional</span>
<span class="sd">            Composition of each phase in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Chemical potential in J for the net change of the reaction</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">chem_potential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_net_rxn_values</span><span class="p">(</span>
            <span class="s1">&#39;chem_potential&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span> <span class="n">use_endmember</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">chem_potential</span></div>

<div class="viewcode-block" id="Rxn.volume"><a class="viewcode-back" href="../phases.html#phases.Rxn.volume">[docs]</a>    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate net volume change of the reaction</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : dict of arrays, optional</span>
<span class="sd">            Composition of each phase in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Volume in J/bar for the net change of the reaction</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rxn_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_net_rxn_values</span><span class="p">(</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span>
                                               <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rxn_volume</span></div>

<div class="viewcode-block" id="Rxn.entropy"><a class="viewcode-back" href="../phases.html#phases.Rxn.entropy">[docs]</a>    <span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate net entropy change of the reaction</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : dict of arrays, optional</span>
<span class="sd">            Composition of each phase in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Entropy in J/K for the net change of the reaction.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rxn_entropy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_net_rxn_values</span><span class="p">(</span><span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span>
                                               <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rxn_entropy</span></div>

    <span class="k">def</span> <span class="nf">boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Tstd</span> <span class="o">=</span> <span class="mf">300.0</span>
        <span class="n">Pstd</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">T</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">P</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span> \
            <span class="s1">&#39;Both T and P are None; Must define either temperature or pressure.&#39;</span>

        <span class="k">if</span> <span class="n">T</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">init_guess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">init_guess</span> <span class="o">=</span> <span class="n">Pstd</span>

            <span class="n">Afun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">)</span>
            <span class="n">dAfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">init_guess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">init_guess</span> <span class="o">=</span> <span class="n">Tstd</span>

            <span class="n">Afun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">)</span>
            <span class="n">dAfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">:</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">value_bound</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">Afun</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">dAfun</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value_bound</span>

    <span class="k">def</span> <span class="nf">clapeyron_slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">dV_rxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span><span class="p">)</span>
        <span class="n">dS_rxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="n">mols</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span><span class="p">)</span>
        <span class="n">dTdP</span> <span class="o">=</span> <span class="n">dV_rxn</span> <span class="o">/</span> <span class="n">dS_rxn</span>
        <span class="k">return</span> <span class="n">dTdP</span>

    <span class="k">def</span> <span class="nf">simultaneous_rxn_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_rxn</span><span class="p">,</span> <span class="n">Pinit</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">TOL</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">Pinit</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">Tbnd1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">)</span>
            <span class="n">Tbnd2</span> <span class="o">=</span> <span class="n">other_rxn</span><span class="o">.</span><span class="n">boundary</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">)</span>

            <span class="n">dTdP1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clapeyron_slope</span><span class="p">(</span><span class="n">Tbnd1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
            <span class="n">dTdP2</span> <span class="o">=</span> <span class="n">other_rxn</span><span class="o">.</span><span class="n">clapeyron_slope</span><span class="p">(</span><span class="n">Tbnd2</span><span class="p">,</span><span class="n">Pinit</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Tbnd1</span><span class="o">/</span><span class="n">Tbnd2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">TOL</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span>  <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Tbnd1</span><span class="o">+</span><span class="n">Tbnd2</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">dP</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">Tbnd1</span> <span class="o">-</span> <span class="n">Tbnd2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dTdP1</span><span class="o">-</span><span class="n">dTdP2</span><span class="p">)</span>
            <span class="n">P</span> <span class="o">+=</span> <span class="n">dP</span>

        <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span>

    <span class="k">def</span> <span class="nf">trace_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Plims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Nsamp</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">Tlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Plims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span> \
            <span class="s1">&#39;Both T and P are None; Must define either temperature or pressure.&#39;</span>

        <span class="k">if</span> <span class="n">Tlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Tlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Tlims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Nsamp</span><span class="p">)</span>

            <span class="n">bound_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">T</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">(</span>
                <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">init_guess</span><span class="o">=</span><span class="n">init_guess</span><span class="p">)</span>

            <span class="n">dAdx_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">dAdy_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Plims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Plims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Nsamp</span><span class="p">)</span>

            <span class="n">bound_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">P</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">(</span>
                <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">init_guess</span><span class="o">=</span><span class="n">init_guess</span><span class="p">)</span>

            <span class="n">dAdx_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">dAdy_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">xvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xvals</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xvals</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bound_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">)</span>
            <span class="n">dy_guess</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dAdx_fun</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dAdy_fun</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
            <span class="n">yvals</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">init_guess</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy_guess</span>


        <span class="k">if</span> <span class="n">Tlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">T_bnds</span><span class="p">,</span> <span class="n">P_bnds</span> <span class="o">=</span> <span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">T_bnds</span><span class="p">,</span> <span class="n">P_bnds</span> <span class="o">=</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">xvals</span>

        <span class="k">return</span> <span class="n">T_bnds</span><span class="p">,</span> <span class="n">P_bnds</span>

    <span class="k">def</span> <span class="nf">competing_rxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_bounds</span><span class="p">,</span> <span class="n">P_bounds</span><span class="p">,</span> <span class="n">other_rxn</span><span class="p">,</span> <span class="n">TOL</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="n">competing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">A_rxn_other</span> <span class="o">=</span> <span class="n">other_rxn</span><span class="o">.</span><span class="n">affinity</span><span class="p">(</span><span class="n">T_bounds</span><span class="p">,</span> <span class="n">P_bounds</span><span class="p">)</span>

        <span class="n">is_competing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_bounds</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">other_rxn</span><span class="o">.</span><span class="n">reactant_phases</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">):</span>
            <span class="n">is_competing</span><span class="p">[</span><span class="n">A_rxn_other</span><span class="o">&gt;</span><span class="n">TOL</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">other_rxn</span><span class="o">.</span><span class="n">product_phases</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">):</span>
            <span class="n">is_competing</span><span class="p">[</span><span class="n">A_rxn_other</span><span class="o">&lt;-</span><span class="n">TOL</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">is_competing</span>

    <span class="k">def</span> <span class="nf">stability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_bounds</span><span class="p">,</span> <span class="n">P_bounds</span><span class="p">,</span> <span class="n">other_rxns</span><span class="p">,</span> <span class="n">TOL</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="c1"># NOTE: other_rxns must be a list of reactions of the same composition</span>
        <span class="n">peratom</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span>

        <span class="c1"># self._reac_assemblage</span>
        <span class="c1"># A_rxn_vals = self.affinity(T_bounds, P_bounds, peratom=peratom)</span>
        <span class="n">A_rxn_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span><span class="p">(</span><span class="n">T_bounds</span><span class="p">,</span> <span class="n">P_bounds</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_rxn_vals</span><span class="p">)</span><span class="o">&lt;</span><span class="n">TOL</span><span class="p">),</span> \
            <span class="s1">&#39;Rxn affinity must be equal to zero to within TOL.&#39;</span>

        <span class="n">N_TP</span> <span class="o">=</span> <span class="n">A_rxn_vals</span><span class="o">.</span><span class="n">size</span>
        <span class="n">N_rxn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_rxns</span><span class="p">)</span>

        <span class="c1"># A_rxn_others = np.zeros((N_rxn, N_TP))</span>

        <span class="c1"># Calculate gibbs energy of rxn for all possible reactions</span>

        <span class="n">stable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">N_TP</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">irxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_rxns</span><span class="p">):</span>
            <span class="n">is_competing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">competing_rxn</span><span class="p">(</span><span class="n">T_bounds</span><span class="p">,</span> <span class="n">P_bounds</span><span class="p">,</span> <span class="n">irxn</span><span class="p">)</span>

            <span class="n">stable</span><span class="p">[</span><span class="n">is_competing</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># iA_rxn_other = irxn.affinity(T_bounds, P_bounds, peratom=peratom )</span>
            <span class="c1"># # if other rxn phase assemblage is a subset of the current</span>
            <span class="c1"># # assemblage, then it is a valid competing reaction</span>

            <span class="c1"># if self.competing_rxn(irxn):</span>

            <span class="c1"># if (rxn._reac_assemblage.issubset(self._reac_assemblage) | \</span>
            <span class="c1">#     rxn._reac_assemblage.issubset(self._prod_assemblage) ):</span>
            <span class="c1">#     G_rxn_other_a[ind] = iG_rxn_other_a</span>

            <span class="c1"># elif (rxn._prod_assemblage.issubset(self._reac_assemblage) | \</span>
            <span class="c1">#       rxn._prod_assemblage.issubset(self._prod_assemblage) ):</span>
            <span class="c1">#     # Store negative energy as reverse reaction energy change</span>
            <span class="c1">#     G_rxn_other_a[ind] = -iG_rxn_other_a</span>

            <span class="c1"># else:</span>
            <span class="c1">#     G_rxn_other_a[ind] = 0.0</span>

        <span class="c1"># print(G_rxn_other_a)</span>


        <span class="c1"># If any rxn is energetically favored, then current reaction is not</span>
        <span class="c1"># stable</span>
        <span class="c1"># stable_a = ~np.any(G_rxn_other_a &lt; -TOL, axis=0)</span>
        <span class="k">return</span> <span class="n">stable</span>

    <span class="k">def</span> <span class="nf">_validate_state_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">):</span>
        <span class="n">N_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
        <span class="n">N_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
        <span class="n">N_solution_phases</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
        <span class="n">N_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N_solution_phases</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">iphs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mols</span><span class="p">):</span>
            <span class="n">imol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="n">iphs</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">imol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">N_X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">imol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">imol</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">imol</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">N_X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">N_X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">imol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">N_X</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span>
            <span class="s1">&#39;Multiple compositions not currently supported.&#39;</span>
        <span class="p">)</span>

        <span class="n">N_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">N_T</span><span class="p">,</span> <span class="n">N_P</span><span class="p">,</span> <span class="n">N_X</span><span class="p">))</span>
        <span class="n">N_PTX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">N_all</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">N_all</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_PTX</span><span class="p">])),(</span>
            <span class="s1">&#39;The number of state points for T, P, mol must be compatible.&#39;</span>
        <span class="p">)</span>

        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;N_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_T</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;N_P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_P</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;N_X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_X</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;N_PTX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_PTX</span>

        <span class="c1"># from IPython import embed;embed();import ipdb as pdb;pdb.set_trace()</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">N_PTX</span><span class="p">)</span> <span class="k">if</span> <span class="n">N_T</span> <span class="o">&lt;</span> <span class="n">N_PTX</span> <span class="k">else</span> <span class="n">T</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">N_PTX</span><span class="p">)</span> <span class="k">if</span> <span class="n">N_P</span> <span class="o">&lt;</span> <span class="n">N_PTX</span> <span class="k">else</span> <span class="n">P</span>

        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;mols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mols</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">_calc_net_rxn_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_endmember</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mol_input</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
        <span class="n">phase_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_num</span>
        <span class="n">endmember_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endmember_ids</span>
        <span class="n">rxn_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxn_coefs</span>

        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state_input</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">)</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">N_PTX</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span>
                             <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;mols&#39;</span><span class="p">,</span> <span class="s1">&#39;N_PTX&#39;</span><span class="p">])</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">phase_num</span><span class="p">,</span> <span class="n">N_PTX</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">iphs</span><span class="p">,</span> <span class="n">iendmember</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">,</span> <span class="n">endmember_ids</span><span class="p">)):</span>

            <span class="n">iphs_abbrev</span> <span class="o">=</span> <span class="n">iphs</span><span class="o">.</span><span class="n">abbrev</span>
            <span class="n">imol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="n">iphs_abbrev</span><span class="p">]</span>
            <span class="n">iphs_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">iphs</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_endmember</span><span class="p">:</span>
                <span class="n">ival</span> <span class="o">=</span> <span class="n">iphs_method</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="n">iendmember</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ival</span> <span class="o">=</span> <span class="n">iphs_method</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">)</span>

            <span class="c1"># if peratom:</span>
            <span class="c1">#     ival /= self.rxn_atomnum</span>

            <span class="c1"># from IPython import embed;embed();import ipdb as pdb;pdb.set_trace()</span>
            <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span>

        <span class="n">net_rxn_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rxn_coefs</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

        <span class="c1">#from IPython import embed;embed();import pdb as pdb;pdb.set_trace()</span>

        <span class="k">return</span> <span class="n">net_rxn_values</span>

    <span class="c1">######################</span>
    <span class="c1">#     NOT UPDATED    #</span>
    <span class="c1">######################</span>
    <span class="k">def</span> <span class="nf">gibbs_energy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">dG_rxn_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_rxn_change</span><span class="p">(</span><span class="s1">&#39;gibbs_energy_all&#39;</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span>
                                         <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dG_rxn_a</span>

    <span class="k">def</span> <span class="nf">enthalpy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">dH_rxn_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_rxn_change</span><span class="p">(</span><span class="s1">&#39;enthalpy_all&#39;</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span>
                                         <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">dH_rxn_a</span>


    <span class="k">def</span> <span class="nf">_calc_reac_value</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">reac_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reac_assemblage</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
        <span class="n">val_phs_a</span> <span class="o">=</span> <span class="n">reac_method</span><span class="p">(</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span> <span class="p">)</span>
        <span class="n">val_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reac_rxn_coef_a</span><span class="p">,</span> <span class="n">val_phs_a</span><span class="p">)</span>

        <span class="c1"># if peratom:</span>
        <span class="c1">#     val_a /= self.rxn_atomnum</span>

        <span class="k">return</span> <span class="n">val_a</span>

    <span class="k">def</span> <span class="nf">_calc_prod_value</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">prod_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prod_assemblage</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
        <span class="n">val_phs_a</span> <span class="o">=</span> <span class="n">prod_method</span><span class="p">(</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span> <span class="p">)</span>
        <span class="n">val_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prod_rxn_coef_a</span><span class="p">,</span> <span class="n">val_phs_a</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1">#  if peratom:</span>
        <span class="c1"># #</span>
        <span class="c1">#   val_a /= self.rxn_atomnum</span>

        <span class="k">return</span> <span class="n">val_a</span>

    <span class="k">def</span> <span class="nf">_calc_rxn_change</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">val_prod_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_prod_value</span><span class="p">(</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span> <span class="p">)</span>
        <span class="n">val_reac_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_reac_value</span><span class="p">(</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">T_a</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="n">peratom</span><span class="o">=</span><span class="n">peratom</span> <span class="p">)</span>
        <span class="n">val_rxn_a</span> <span class="o">=</span> <span class="n">val_prod_a</span><span class="o">-</span><span class="n">val_reac_a</span>
        <span class="k">return</span> <span class="n">val_rxn_a</span></div>
<span class="c1">#===================================================</span>
<span class="k">class</span> <span class="nc">Assemblage</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span> <span class="n">obj_is_classnm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Get phase symbol list</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">phase_obj</span> <span class="ow">in</span> <span class="n">phase_objs</span><span class="p">:</span>
            <span class="n">phase_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">phase_obj</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">])</span>

        <span class="n">phase_objs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phase_objs</span><span class="p">)</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phase_symbols</span><span class="p">)</span>

        <span class="n">indsort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phase_symbols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_phase_assemblage</span><span class="p">(</span>
            <span class="n">phase_objs</span><span class="p">[</span><span class="n">indsort</span><span class="p">],</span> <span class="n">phase_symbols</span><span class="p">[</span><span class="n">indsort</span><span class="p">],</span>
            <span class="n">obj_is_classnm</span><span class="o">=</span><span class="n">obj_is_classnm</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_phases</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phases</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_phases</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_phases</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">issubset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">is_member</span> <span class="o">=</span> <span class="p">[</span><span class="n">phase</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_phases</span> <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">is_member</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_phase_assemblage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_objs</span><span class="p">,</span>
                             <span class="n">phase_symbols</span><span class="p">,</span>
                             <span class="n">obj_is_classnm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj_is_classnm</span><span class="p">:</span>
            <span class="n">phase_classnms</span> <span class="o">=</span> <span class="n">phase_objs</span>
            <span class="n">phase_objs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">PurePhase</span><span class="p">(</span><span class="n">phase_classnm</span><span class="p">,</span> <span class="n">phasesym</span><span class="p">)</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">phase_classnm</span><span class="p">,</span> <span class="n">phasesym</span><span class="p">)</span> <span class="ow">in</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">phase_classnms</span><span class="p">,</span> <span class="n">phase_symbols</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span> <span class="o">=</span> <span class="n">phase_symbols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span> <span class="o">=</span> <span class="n">phase_objs</span>

        <span class="n">props</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">]</span>
                                <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="n">phase_objs</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;name_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">]</span>
                             <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="n">phase_objs</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span>
                               <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="n">phase_objs</span> <span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="n">phase_objs</span><span class="p">])</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span>
            <span class="n">phs</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">phs</span>
            <span class="ow">in</span> <span class="n">phase_objs</span><span class="p">])</span>
        <span class="c1"># NOTE replace symbols?</span>
        <span class="c1"># props[&#39;element_symbols_all&#39;] = phase_objs[0].props[&#39;element_symbols&#39;]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_props</span> <span class="o">=</span> <span class="n">props</span>

        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_validate_mol_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">):</span>
        <span class="n">phases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span>
        <span class="n">phase_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_symbols</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">phase_symbols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">mols</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># else:</span>
            <span class="c1">#     imol = mols[symbol]</span>
            <span class="c1">#     iphase = phases[symbol]</span>
            <span class="c1">#     iprops = iphase.props</span>
            <span class="c1">#     iendmember_names = iprops[&#39;endmember_name&#39;]</span>
            <span class="c1">#     iendmember_num = len(iendmember_names)</span>

        <span class="k">return</span> <span class="n">mols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_symbols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phases</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span>

    <span class="k">def</span> <span class="nf">get_endmember_comp_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">oxide_num</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;oxide_num&#39;</span><span class="p">]</span>
        <span class="n">all_mol_oxide_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">oxide_num</span><span class="p">))</span>
        <span class="n">all_phase_name</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">all_endmember_name</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">all_endmember_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">all_phase_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">iphase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">:</span>
            <span class="n">iphs_props</span> <span class="o">=</span> <span class="n">iphase</span><span class="o">.</span><span class="n">props</span>
            <span class="n">imol_oxide_comp</span> <span class="o">=</span> <span class="n">iphs_props</span><span class="p">[</span><span class="s1">&#39;mol_oxide_comp&#39;</span><span class="p">]</span>
            <span class="n">iendmember_name</span> <span class="o">=</span> <span class="n">iphs_props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">]</span>
            <span class="n">iendmember_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iendmember_name</span><span class="p">)</span>

            <span class="n">iendmember_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">iendmember_num</span><span class="p">)</span>

            <span class="n">iphase_name_tile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">iphs_props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">]]),</span> <span class="n">iendmember_num</span><span class="p">)</span>

            <span class="n">all_phase_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">all_phase_ind</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">ind_phs</span><span class="p">,(</span><span class="n">iendmember_num</span><span class="p">))))</span>
            <span class="n">all_mol_oxide_comp</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">all_mol_oxide_comp</span><span class="p">,</span> <span class="n">iall_mol_oxide_comp</span><span class="p">))</span>
            <span class="n">all_phase_name</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">all_phase_name</span><span class="p">,</span> <span class="n">iphase_name_tile</span><span class="p">))</span>
            <span class="n">all_endmember_name</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">all_endmember_name</span><span class="p">,</span> <span class="n">iendmember_name</span><span class="p">))</span>
            <span class="n">all_endmember_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">all_endmember_ind</span><span class="p">,</span> <span class="n">iendmember_ind</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">all_mol_oxide_comp</span>

    <span class="k">def</span> <span class="nf">gibbs_energy_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mol_input</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

        <span class="n">gibbs_energy_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iphs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">:</span>
            <span class="n">iphs_abbrev</span> <span class="o">=</span> <span class="n">iphs</span><span class="o">.</span><span class="n">abbrev</span>
            <span class="n">imol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="n">iphs_abbrev</span><span class="p">]</span>
            <span class="n">igibbs_energy</span> <span class="o">=</span> <span class="n">iphs</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">(</span>
                <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">)</span>
            <span class="n">gibbs_energy_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">igibbs_energy</span><span class="p">)</span>

        <span class="n">gibbs_energy_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">gibbs_energy_all</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gibbs_energy_all</span>

    <span class="k">def</span> <span class="nf">chem_potential_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mol_input</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

        <span class="n">chem_potential_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iphs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">:</span>
            <span class="n">iphs_abbrev</span> <span class="o">=</span> <span class="n">iphs</span><span class="o">.</span><span class="n">abbrev</span>
            <span class="n">imol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="n">iphs_abbrev</span><span class="p">]</span>
            <span class="n">ichem_potential</span> <span class="o">=</span> <span class="n">iphs</span><span class="o">.</span><span class="n">chem_potential</span><span class="p">(</span>
                <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">)</span>
            <span class="n">chem_potential_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ichem_potential</span><span class="p">)</span>


        <span class="n">chem_potential_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">chem_potential_all</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">chem_potential_all</span>

    <span class="k">def</span> <span class="nf">enthalpy_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">entropy_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">heat_capacity_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">dCp_dT_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">dCp_dT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">volume_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">volume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">dV_dT_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">dV_dT</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">dV_dP_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">dV_dP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">d2V_dT2_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">d2V_dT2</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">d2V_dTdP_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">d2V_dTdP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">d2V_dP2_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">phs</span><span class="o">.</span><span class="n">d2V_dP2</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">phs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phases</span><span class="p">])</span>
<span class="c1">#===================================================</span>
<span class="k">class</span> <span class="nc">classproperty</span><span class="p">(</span><span class="nb">property</span><span class="p">):</span>
    <span class="c1"># https://stackoverflow.com/questions/128573/using-property-on-classmethods</span>
    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">classproperty</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">objtype</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">classproperty</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">classproperty</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__delete__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

<div class="viewcode-block" id="Phase"><a class="viewcode-back" href="../phases.html#phases.Phase">[docs]</a><span class="k">class</span> <span class="nc">Phase</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract parent class defining generic phase properties.</span>

<span class="sd">    The user must use a subclass, like PurePhase or SolutionPhase, which</span>
<span class="sd">    implements the Phase interface.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase_classnm : str</span>
<span class="sd">        Official class name for phase (implemented in src code). String has the</span>
<span class="sd">        form *classname* if source is *objc*, else:</span>

<span class="sd">          - if !calib [&#39;cy&#39;, &#39;phase name&#39;, &#39;module name&#39;, &#39;&#39;]</span>

<span class="sd">          - if  calib [&#39;cy&#39;, &#39;phase name&#39;, &#39;module name&#39;, &#39;calib&#39;, &#39;&#39;]</span>
<span class="sd">    abbrev : str</span>
<span class="sd">        Official abbreviation of phase (regardless of implementation).</span>
<span class="sd">    calib : bool, default True</span>
<span class="sd">        Indicates whether sample phase should be calibration ready.</span>
<span class="sd">    source : str</span>
<span class="sd">        Code source for phase implementation. Default is &#39;objc&#39; (code in</span>
<span class="sd">        objective-C that is part of the original code base). Alternative is</span>
<span class="sd">        &#39;coder&#39; (code generated by the coder module).</span>
<span class="sd">    coder_module : str</span>
<span class="sd">        Name of the coder module that contains the phase classes. See</span>
<span class="sd">        documentation for model.Database for additional information and</span>
<span class="sd">        examples.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    abbrev</span>
<span class="sd">    calib</span>
<span class="sd">    class_name</span>
<span class="sd">    endmember_ids</span>
<span class="sd">    endmember_names</span>
<span class="sd">    endmember_num</span>
<span class="sd">    formula</span>
<span class="sd">    identifier</span>
<span class="sd">    module</span>
<span class="sd">    MOLWTS</span>
<span class="sd">    OXIDES</span>
<span class="sd">    param_names</span>
<span class="sd">    param_props</span>
<span class="sd">    phase_name</span>
<span class="sd">    phase_obj</span>
<span class="sd">    phase_type</span>
<span class="sd">    props</span>
<span class="sd">    source</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * This code is highly dependent on implementation and is likely to change</span>
<span class="sd">      dramatically with changes in the underlying code that calculates phase</span>
<span class="sd">      properties.</span>
<span class="sd">    * The pure water phase, &quot;H2O&quot;, is very complex and thus not available for</span>
<span class="sd">      calibration. The water phase will force its calib flag to False, regardless</span>
<span class="sd">      of input value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_MINVAL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;objc&#39;</span><span class="p">,</span>
        <span class="n">coder_module</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">abbrev</span><span class="o">==</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span>
            <span class="n">calib</span><span class="o">=</span><span class="kc">False</span>

        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;coder&#39;</span><span class="p">:</span>
            <span class="n">invalidate_caches</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="n">coder_module</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_calib</span> <span class="o">=</span> <span class="n">calib</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">,</span><span class="s1">&#39;dP&#39;</span><span class="p">,</span><span class="s1">&#39;dV&#39;</span><span class="p">,</span><span class="s1">&#39;dS&#39;</span><span class="p">,</span><span class="s1">&#39;dmol&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_phase_props</span><span class="p">(</span><span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_param_props</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_abbrev</span> <span class="o">=</span> <span class="n">abbrev</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_OXIDES</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;oxides&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MOLWTS</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span>
        <span class="c1">#Moved to class property</span>
        <span class="c1">#MINVAL = np.sqrt(np.finfo(float).eps)</span>
        <span class="c1">#self._MINVAL = MINVAL</span>

        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_init_phase_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">phase_obj</span><span class="p">,</span> <span class="n">phase_cls</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">get_src_object</span><span class="p">(</span>
                <span class="n">phase_classnm</span><span class="p">,</span> <span class="n">return_class</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span> <span class="o">=</span> <span class="n">phase_obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span> <span class="o">=</span> <span class="n">phase_cls</span>

            <span class="n">phase_name</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">phaseName</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">phase_cls</span><span class="o">.</span><span class="n">name</span>
            <span class="n">formula</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">phaseFormula</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="s1">&#39;Objective-C-base&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_name</span> <span class="o">=</span> <span class="n">phase_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_class_name</span> <span class="o">=</span> <span class="n">class_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span> <span class="o">=</span> <span class="n">formula</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="n">identifier</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;coder&#39;</span><span class="p">:</span>
            <span class="c1"># if !calib [&#39;cy&#39;, &#39;phase name&#39;, &#39;module name&#39;]</span>
            <span class="c1"># if  calib [&#39;cy&#39;, &#39;phase name&#39;, &#39;module name&#39;, &#39;calib&#39;]</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">phase_classnm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span> <span class="o">=</span> <span class="n">phase_classnm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span> <span class="o">=</span> <span class="n">phase_classnm</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="n">phase_name</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_name</span> <span class="o">=</span> <span class="n">phase_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_class_name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;formula&#39;</span><span class="p">)</span>
                <span class="n">formula</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span> <span class="o">=</span> <span class="n">formula</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Module generated by the coder package &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;does not yet provide a formula method.&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;identifier&#39;</span><span class="p">)</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="n">identifier</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">phase_classnm</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abbrev</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase_name</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;class_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_name</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">identifier</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="c1">#TK</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;atom_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;elemental_entropy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;mol_oxide_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_props</span> <span class="o">=</span> <span class="n">props</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_init_param_props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">phase_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span>
                <span class="n">supports_calib</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">supportsParameterCalibration</span><span class="p">()</span>
                <span class="n">param_num</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">getNumberOfFreeParameters</span><span class="p">()</span>
                <span class="n">param_names_NSArray</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">getArrayOfNamesOfFreeParameters</span><span class="p">()</span>
                <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_names_NSArray</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_num</span><span class="p">)]</span>
                <span class="n">param_units</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="n">phase_obj</span><span class="o">.</span><span class="n">getUnitsForParameterName_</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">])</span>
                <span class="n">param0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="n">phase_obj</span><span class="o">.</span><span class="n">getValueForParameterName_</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">])</span>

            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">supports_calib</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">param_num</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">param_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">param_units</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">param0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;calib_&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">:</span>
                <span class="n">supports_calib</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">method_stub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;calib_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;get_param_number&#39;</span><span class="p">)</span>
                <span class="n">param_num</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;get_param_names&#39;</span><span class="p">)</span>
                <span class="n">param_names</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;get_param_units&#39;</span><span class="p">)</span>
                <span class="n">param_units</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;get_param_values&#39;</span><span class="p">)</span>
                <span class="n">param0</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">supports_calib</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">param_num</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">param_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">param_units</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">param0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="n">param_props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;supports_calib&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">supports_calib</span>
        <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_num</span>
        <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">param_names</span>
        <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_units&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">param_units</span>
        <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span> <span class="o">=</span> <span class="n">param_props</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Name of phase (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">abbrev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Official unique abbreviation for phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Abbreviation (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abbrev</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">class_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of class</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Name of class (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_class_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Formula of phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Formula of phase (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identifier of phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Identifier of phase (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Phase type</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Phase type (str)</span>
<span class="sd">            Permissible values are &#39;pure&#39; or &#39;solution&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">calib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicates whether phase calibration is enabled</span>

<span class="sd">		Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Value of calib (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calib</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicates origin of source code implementation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        String indicating origin of source code for implementation</span>
<span class="sd">            Permissible values &#39;objc&#39; or &#39;coder&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Python module attribute for coder generated functions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        module</span>
<span class="sd">            Module attribute returned from importlib.import_module,</span>
<span class="sd">            else None if source is &#39;objc&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of phase properties</span>

<span class="sd">        The dictionary defines phase properties with these keys:</span>

<span class="sd">        ``abbrev`` : str</span>
<span class="sd">            Official unique phase abbreviation</span>
<span class="sd">        ``name`` : str</span>
<span class="sd">            Name of phase (implementation dependent)</span>
<span class="sd">        ``class_name`` : str</span>
<span class="sd">            Official class name for phase (implemented in src code)</span>
<span class="sd">        ``formula`` : str</span>
<span class="sd">            Formula of phase</span>
<span class="sd">        ``natom`` : int</span>
<span class="sd">            Number of atoms in formula unit</span>
<span class="sd">        ``molwt`` : double</span>
<span class="sd">            Molecular weight of phase (in g/mol-formula-unit)</span>
<span class="sd">        ``elemental_entropy`` : double</span>
<span class="sd">            Estimated entropy from elemental formula (from Robie et al. 1979)</span>
<span class="sd">        ``element_symbols`` : str array</span>
<span class="sd">            Symbol array string</span>
<span class="sd">        ``element_comp`` : int array</span>
<span class="sd">            Phase formula in terms of number of each element</span>

<span class="sd">		Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Python dictionary (dict)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Need to update these dictionary values to be vectors for solution phases</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endmember_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Name of each endmember</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List of endmember names for this solution phase, [str,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endmember_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of endmembers in phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Number of endmembers in phase (int)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endmember_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ID number of each endmember in phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of ids, [int,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_ids&#39;</span><span class="p">]</span> <span class="c1">#TK</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">param_props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of phase model parameters</span>

<span class="sd">        This dictionary defines parameter properties for the phase, using these keys:</span>

<span class="sd">        ``supports_calib`` : bool</span>
<span class="sd">            Flag indicating whether phase allows calibration</span>
<span class="sd">        ``param_num`` : int</span>
<span class="sd">            Number of parameters</span>
<span class="sd">        ``param_names`` : str array</span>
<span class="sd">            Name of each parameter</span>
<span class="sd">        ``param_units`` : str array</span>
<span class="sd">            Units for each parameter</span>
<span class="sd">        ``param0`` : double array</span>
<span class="sd">            Initial parameter values</span>

<span class="sd"> 	    Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dictionary of phase model parameters (dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of the phase object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Object instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">param_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of parameter names</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of names for each parameter of the phase model, [str,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="Phase.param_units"><a class="viewcode-back" href="../phases.html#phases.Phase.param_units">[docs]</a>    <span class="k">def</span> <span class="nf">param_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_names</span><span class="o">=</span><span class="p">[],</span>
                    <span class="n">all_params</span> <span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get units for listed parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param_names : str array</span>
<span class="sd">            List of parameter names</span>
<span class="sd">        all_params : bool, default False</span>
<span class="sd">            If true, returns units for all parameters</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        units : double array</span>
<span class="sd">            List of units for selected parameters</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">all_params</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_units&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param_names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_names</span><span class="p">]</span>

        <span class="n">units_l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_names</span><span class="p">):</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_units&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span>
            <span class="c1"># unit = self._phase_obj.getUnitsForParameterName_(key)</span>
            <span class="n">units_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">units_l</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">OXIDES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of oxide names</span>

<span class="sd">  		Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of oxide names, [str,...]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_OXIDES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MOLWTS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of molecular weights of oxides</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Numpy array of molecular weights, (nparray)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MOLWTS</span>

    <span class="nd">@classproperty</span>
    <span class="k">def</span> <span class="nf">MINVAL</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Minimum molar concentration of a component in a solution phase</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Floating point number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_MINVAL</span>

    <span class="nd">@MINVAL</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MINVAL</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span> <span class="s1">&#39;MINVAL must have a value &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;greater than machine precision(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_MINVAL</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="Phase.set_ref_state"><a class="viewcode-back" href="../phases.html#phases.Phase.set_ref_state">[docs]</a>    <span class="k">def</span> <span class="nf">set_ref_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tr</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">Pr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Trl</span><span class="o">=</span><span class="mf">298.15</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set reference state P/T conditions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tr : double, default 298.15</span>
<span class="sd">            Reference temperature in Kelvin</span>
<span class="sd">        Pr : double, default 1.0</span>
<span class="sd">            Reference pressure in bars</span>
<span class="sd">        Trl : double, default 298.15</span>
<span class="sd">            Reference temperature for lambda heat capacity correction in Kelvin</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">setTr_</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">setPr_</span><span class="p">(</span><span class="n">Pr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">setTrl_</span><span class="p">(</span><span class="n">Trl</span><span class="p">)</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Phase.enable_gibbs_energy_reference_state"><a class="viewcode-back" href="../phases.html#phases.Phase.enable_gibbs_energy_reference_state">[docs]</a>    <span class="k">def</span> <span class="nf">enable_gibbs_energy_reference_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Gibbs energy of the reference state.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Call method on any phase class, and it automatically applies to all.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">phase_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="n">phase_cls</span><span class="o">.</span><span class="n">enableGibbsFreeEnergyReferenceStateUsed</span><span class="p">()</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Phase.disable_gibbs_energy_reference_state"><a class="viewcode-back" href="../phases.html#phases.Phase.disable_gibbs_energy_reference_state">[docs]</a>    <span class="k">def</span> <span class="nf">disable_gibbs_energy_reference_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unset Gibbs energy of the reference state.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Call method on any phase class, and it automatically applies to all.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># call method on any phase class (automatically applied to all)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">phase_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="n">phase_cls</span><span class="o">.</span><span class="n">disableGibbsFreeEnergyReferenceStateUsed</span><span class="p">()</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Phase.get_param_values"><a class="viewcode-back" href="../phases.html#phases.Phase.get_param_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">all_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current values for listed parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param_names : str array</span>
<span class="sd">            List of parameter names</span>
<span class="sd">        all_params : bool, default False</span>
<span class="sd">            If true, returns units for all parameters</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        values : double array</span>
<span class="sd">            List of values for selected parameters</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">all_params</span><span class="p">:</span>
            <span class="n">param_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_names</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">param_names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_names</span><span class="p">]</span>

        <span class="n">values_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param_names</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_names</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">getValueForParameterName_</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">values_a</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span><span class="p">:</span>
            <span class="n">method_stub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;calib_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;get_param_value&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_names</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">values_a</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_a</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">values_a</span></div>

<div class="viewcode-block" id="Phase.set_param_values"><a class="viewcode-back" href="../phases.html#phases.Phase.set_param_values">[docs]</a>    <span class="k">def</span> <span class="nf">set_param_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">param_values</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set new values for listed parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param_names : str array</span>
<span class="sd">            List of parameter names</span>
<span class="sd">        param_values : double array</span>
<span class="sd">            List of parameter values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_names</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">),</span> \
            <span class="s1">&#39;param_names and param_values must have the same length&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">param_values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">setParameterName_tovalue_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span><span class="p">:</span>
            <span class="n">method_stub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;calib_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">method_stub</span><span class="o">+</span><span class="s1">&#39;set_param_value&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">param_values</span><span class="p">):</span>
                <span class="n">method</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Phase.get_phase_amount_from_elements"><a class="viewcode-back" href="../phases.html#phases.Phase.get_phase_amount_from_elements">[docs]</a>    <span class="k">def</span> <span class="nf">get_phase_amount_from_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert list of elements to quantity of phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elements : double array</span>
<span class="sd">            Number of each element</span>
<span class="sd">        kind : {&#39;mass&#39;,&#39;moles&#39;}</span>
<span class="sd">            Determines how phase amount is determined (mass vs. moles)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        amount : double</span>
<span class="sd">            Amount of phase (expressed according to kind)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">elements_vec</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_double_vector</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>

            <span class="c1"># NOTE: Need to update to allow for solution phases</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToMassOfPhase_</span><span class="p">(</span>
                    <span class="n">elements_vec</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;moles&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToMolesOfPhase_</span><span class="p">(</span>
                    <span class="n">elements_vec</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">(</span><span class="s1">&#39;The kind &quot;&#39;</span><span class="o">+</span><span class="n">kind</span><span class="o">+</span><span class="s1">&#39;&quot; is not implimented &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;for get_phase_amount_from_elements()&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">(</span><span class="s1">&#39;Function not implemented for coder &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;generated modules.&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_est_site_mult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimates site multiplicity of a solution phase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_ave</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span>
        <span class="n">s_mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">x_ave</span><span class="p">))</span>
        <span class="n">s_idl</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.3143</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x_ave</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s_mid</span>
        <span class="n">x_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">1.0e-8</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.99999998</span>
            <span class="n">s</span> <span class="o">-=</span> <span class="n">x_ave</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">x_end</span><span class="p">)</span>
            <span class="n">x_end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">s_idl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_tailored_affinity_and_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use a specific affinity and composition solver if available</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">==</span> <span class="s1">&#39;Objective-C-base&#39;</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;affinityAndCompositionFromLiquidChemicalPotentialSum_andT_andP_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
                <span class="n">cmu</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">debug</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Calling tailored Affinity and Comp routine for&#39;</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">class_name</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">cmu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                <span class="n">A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">debug</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... Affinity &#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... X&#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... Convergence&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... Iterations&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... Affinity scalar&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... Estimated error on affinity&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">objectAtIndex_</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="Phase.affinity_and_comp"><a class="viewcode-back" href="../phases.html#phases.Phase.affinity_and_comp">[docs]</a>    <span class="k">def</span> <span class="nf">affinity_and_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a temperature, pressure and chemical potential(s), compute and</span>
<span class="sd">        return a chemical affinity and phase composition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t,p : float</span>
<span class="sd">            Temperature (K) and pressure (bars)</span>
<span class="sd">        mu : ndarray</span>
<span class="sd">            Chemical potential(s) of endmember components in phase</span>

<span class="sd">            - For a stoichiometric phase, a 1-component 1-D numpy array</span>

<span class="sd">            - For a solution phase, a 1-D numpy array of length equal to the</span>
<span class="sd">              number of endmember components in the phase</span>
<span class="sd">        debug : bool, def False</span>
<span class="sd">            Print iteration details</span>
<span class="sd">        method : str, def &#39;generic&#39;</span>
<span class="sd">            Algorithm used:</span>
<span class="sd">            &#39;generic&#39; - generic algorithm on components,</span>
<span class="sd">            &#39;species&#39; - generic algorithm on species (&gt; = components),</span>
<span class="sd">            &#39;special&#39; - algorthmic specifically coded in the phase instance,</span>
<span class="sd">                currently, only Objective-C coded methods are utilized,</span>
<span class="sd">                see _tailored_affinity_and_comp()</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A, X : tuple</span>
<span class="sd">            A is a scalar equal to the chemical affinity of the phase relative</span>
<span class="sd">            to mu.</span>

<span class="sd">            X is a numpy array of mole fractions of endmember components in the</span>
<span class="sd">            phase. X is the same length as mu.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The algorithm used is from Ghiorso (2013) and is a globally convergent saturation</span>
<span class="sd">        state algorithm applicable to thermodynamic systems with a stable or</span>
<span class="sd">        metastable omni-component phase. Geochimica et Cosmochimica Acta, 103,</span>
<span class="sd">        295-300</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mu</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="mf">999999.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mu0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chem_potential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu0</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">mu0</span><span class="o">-</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;special&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tailored_affinity_and_comp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">result</span>
            <span class="n">X_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mu</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Mole fraction mask: &#39;</span><span class="p">,</span> <span class="n">X_mask</span><span class="p">)</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">1.0e-8</span><span class="p">)</span>
            <span class="n">muM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">A_previous</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">max</span>
            <span class="n">loop</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">n_loop</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">site_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_est_site_mult</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Computed site multiplicity:&#39;</span><span class="p">,</span> <span class="n">site_m</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">loop</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">X_mask</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n_loop</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="c1"># muM = mu0 + RTln X + RT ln gamma (for the endmember)</span>
                    <span class="n">muM</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chem_potential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">n_loop</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
                    <span class="n">phi</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">mu</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">muM</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">n_loop</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># the phi now contains only the mu0 and RT ln gamma</span>
                        <span class="n">phi</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">8.3143</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">site_m</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="n">denom</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="n">prod</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X_mask</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">X_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">ind_next</span> <span class="o">=</span> <span class="n">X_mask</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">phi</span><span class="p">[</span><span class="n">ind_next</span><span class="p">]</span><span class="o">-</span><span class="n">phi</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mf">8.3143</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">site_m</span><span class="p">))</span>
                    <span class="n">prod</span>  <span class="o">*=</span> <span class="n">r</span>
                    <span class="n">denom</span> <span class="o">+=</span> <span class="n">prod</span>
                    <span class="n">X</span><span class="p">[</span><span class="n">ind_next</span><span class="p">]</span> <span class="o">=</span> <span class="n">prod</span>
                <span class="n">ind0</span> <span class="o">=</span> <span class="n">X_mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">X</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">denom</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">X_mask</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">X_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">X</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">*=</span> <span class="n">X</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span>
                <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">8.3143</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">site_m</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">ind0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iter: </span><span class="si">{0:2d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_loop</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Anew: </span><span class="si">{0:10.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">n_loop</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Aold: </span><span class="si">{0:10.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A_previous</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Aold:           &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;X: &#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
                <span class="n">loop</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">A_previous</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span>
                <span class="n">n_loop</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">A_previous</span> <span class="o">=</span> <span class="n">A</span>
                <span class="k">if</span> <span class="n">n_loop</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">loop</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_validate_deriv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv</span><span class="p">:</span>
            <span class="n">deriv</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deriv_keys</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">]),</span> \
                <span class="s1">&#39;Specified deriv keys, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; are not allowed. &#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;They must belong to the allowable set: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deriv_keys</span><span class="p">)</span>

        <span class="c1"># Check for all zeros (default)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">deriv</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">):</span>
            <span class="n">deriv</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Insert some tests here for values of derivative keys:</span>
<span class="sd">        &#39;dT&#39; = &lt;3  &#39;dP&#39; = &lt;3 &#39;dmol&#39; = &lt;2 &#39;dw&#39; &lt;= 1</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="n">deriv</span>

    <span class="k">def</span> <span class="nf">_nudge_solution_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust solution composition to ensure that all components are present</span>
<span class="sd">        (at machine precision).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">MINVAL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINVAL</span>
        <span class="n">ind_row</span><span class="p">,</span> <span class="n">ind_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mol</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">irow</span><span class="p">,</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ind_row</span><span class="p">,</span> <span class="n">ind_col</span><span class="p">):</span>
            <span class="n">mol</span><span class="p">[</span><span class="n">ind_row</span><span class="p">,</span> <span class="n">ind_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">MINVAL</span>

        <span class="k">return</span> <span class="n">mol</span>

    <span class="c1">####################################################</span>
    <span class="c1"># Decorator for validating thermodynamic functions #</span>
    <span class="c1">####################################################</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="c1"># *args arguments as tuple for a in args</span>
        <span class="c1"># **kwargs dictionary of keyword arguments for a in kwargs</span>
        <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># execute before function call</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">T</span>             <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">P</span>             <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">mol</span>           <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mol&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">V</span>             <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;V&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">deriv</span>         <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;deriv&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;deriv&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">deriv_param</span>   <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;deriv_param&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span>
                <span class="s1">&#39;deriv_param&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">mol_deriv_qty</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mol_deriv_qty&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span>
                <span class="s1">&#39;mol_deriv_qty&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="n">endmember</span>     <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;endmember&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span>
                <span class="s1">&#39;endmember&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">const</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;const&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">species</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;species&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_type</span> <span class="o">==</span> <span class="s1">&#39;pure&#39;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;mol must be empty for PurePhase.&#39;</span>

            <span class="n">deriv</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dV&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dS&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span> <span class="k">if</span> <span class="p">(</span>
                <span class="n">deriv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">deriv</span>
            <span class="n">endmember</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">endmember</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">endmember</span>

            <span class="k">if</span> <span class="n">deriv_param</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;supports_calib&#39;</span><span class="p">]:</span>
                    <span class="k">assert</span><span class="p">(</span><span class="s2">&quot;This module does not support calibration.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="n">deriv_param</span> <span class="o">=</span> <span class="p">[</span><span class="n">deriv_param</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">deriv_param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]:</span>
                        <span class="n">deriv_param</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">assert</span><span class="p">(</span><span class="s2">&quot;Parameter name is in param_props list. &quot;</span><span class="p">)</span>
                    <span class="n">deriv_param</span> <span class="o">=</span> <span class="p">[</span><span class="n">deriv_param</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]:</span>
                                <span class="n">deriv_param</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">assert</span><span class="p">(</span><span class="s2">&quot;Parameter name is in param_props list. &quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">deriv_param</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;deriv_param argument must be one of int, &#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;str, list, or numpy array.&#39;</span><span class="p">)</span>

            <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">V</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">T</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fill_array</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>   <span class="c1"># overide pressure with input volume</span>
                <span class="n">P</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">T</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fill_array</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">mol_deriv_qty</span> <span class="ow">and</span> <span class="n">endmember</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mol_deriv_qty</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">T</span><span class="p">,</span> <span class="n">endmember</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fill_array</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">endmember</span><span class="p">)</span>

            <span class="n">deriv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;dmol&#39;</span> <span class="ow">in</span> <span class="n">deriv</span> <span class="ow">and</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dmol&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">num_PT_pts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">mol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">num_PT_pts</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">mol</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">mol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">num_PT_pts</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;molar composition must &#39;</span>
                        <span class="o">+</span> <span class="s1">&#39;be provided for every PT point, or otherwise be &#39;</span>
                        <span class="o">+</span> <span class="s1">&#39;fixed to a single value for all PT points.&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Molar composition must be defined, for &#39;</span>
                        <span class="o">+</span> <span class="s1">&#39;each PT point. It currently has too many &#39;</span>
                        <span class="o">+</span> <span class="s1">&#39;dimensions.&#39;</span><span class="p">)</span>
                <span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nudge_solution_comp</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">mol</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;mol cannot be initialized to an empty &#39;</span>
                    <span class="o">+</span> <span class="s1">&#39;numpy array or to an empty list&#39;</span><span class="p">)</span>

            <span class="c1"># call the function that is wrapped</span>
            <span class="k">if</span> <span class="n">const</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="n">deriv</span><span class="p">,</span>
                    <span class="n">deriv_param</span><span class="o">=</span><span class="n">deriv_param</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="n">mol_deriv_qty</span><span class="p">,</span>
                    <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="n">const</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">species</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="n">deriv</span><span class="p">,</span>
                    <span class="n">deriv_param</span><span class="o">=</span><span class="n">deriv_param</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="n">mol_deriv_qty</span><span class="p">,</span>
                    <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="n">deriv</span><span class="p">,</span>
                    <span class="n">deriv_param</span><span class="o">=</span><span class="n">deriv_param</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="n">mol_deriv_qty</span><span class="p">,</span>
                    <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">)</span>

            <span class="c1"># execute after function call</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Cannot find specified derivative: &#39;</span>
                                 <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">deriv</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">scalar_input</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mol_deriv_qty</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">func_wrapper</span>

    <span class="c1">###################</span>
    <span class="c1"># State Functions #</span>
    <span class="c1">###################</span>

    <span class="c1">###########</span>
    <span class="c1"># order 0 #</span>
    <span class="c1">###########</span>
    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">gibbs_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate Gibbs energy (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases)</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (Default is zero for all params.)</span>
<span class="sd">        deriv_param : array of strs</span>
<span class="sd">            Parameter names that identify returned derivatives</span>
<span class="sd">            (Default is None.)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Gibbs energy in J (or derivative in deriv units)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="n">args_dw</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_G&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nT</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dT&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dT&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nP</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dP&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dP&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nMol</span> <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dmol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dmol&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nW</span>   <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv_param</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">nTot</span> <span class="o">=</span> <span class="n">nT</span> <span class="o">+</span> <span class="n">nP</span> <span class="o">+</span> <span class="n">nMol</span> <span class="o">+</span> <span class="n">nW</span>
            <span class="n">method_sig</span> <span class="o">=</span> <span class="s1">&#39;_calc_&#39;</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nTot</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;G_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dG_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dT&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nT</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dT&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dP&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nP</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dP&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nMol</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dm&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dw&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nW</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_sig</span><span class="p">)</span>
            <span class="n">args_dw</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">nW</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">deriv_param</span>
                        <span class="p">)</span> <span class="k">if</span> <span class="n">args_dw</span> <span class="k">else</span> <span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">deriv_param</span>
                        <span class="p">)</span> <span class="k">if</span> <span class="n">args_dw</span> <span class="k">else</span> <span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">enthalpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate enthalpy (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Enthalpy in J (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Fix me!</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_H&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nT</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dT&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dT&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nP</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dP&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dP&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nMol</span> <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dmol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dmol&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nW</span>   <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv_param</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">nTot</span> <span class="o">=</span> <span class="n">nT</span> <span class="o">+</span> <span class="n">nP</span> <span class="o">+</span> <span class="n">nMol</span> <span class="o">+</span> <span class="n">nW</span>
            <span class="k">assert</span> <span class="n">nT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nP</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nMol</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nW</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="s1">&#39;Only parameter derivatives of the enthalpy are permitted&#39;</span>
            <span class="n">method_sig</span> <span class="o">=</span> <span class="s1">&#39;_calc_&#39;</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nTot</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;H_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dH_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;H&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dw&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nW</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span> <span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">helmholtz_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate helmholtz energy (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Helmholtz energy in J (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">internal_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate internal energy (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Internal energy in J (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1">###########</span>
    <span class="c1"># order 1 #</span>
    <span class="c1">###########</span>
    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate volume (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Volume in J/bar (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#fix me</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_V&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nT</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dT&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dT&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nP</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dP&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dP&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nMol</span> <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dmol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dmol&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nW</span>   <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv_param</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">nTot</span> <span class="o">=</span> <span class="n">nT</span> <span class="o">+</span> <span class="n">nP</span> <span class="o">+</span> <span class="n">nMol</span> <span class="o">+</span> <span class="n">nW</span>
            <span class="n">method_sig</span> <span class="o">=</span> <span class="s1">&#39;_calc_&#39;</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nTot</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;V_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dV_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nMol</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dm&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dT&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nT</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dT&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dP&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nP</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dP&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dw&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nW</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate density (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Density in g*bar/J (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_density&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate entropy (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Entropy in J/K (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#fix me</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_S&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nT</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dT&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dT&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nP</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dP&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dP&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nMol</span> <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dmol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dmol&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">nW</span>   <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv_param</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">nTot</span> <span class="o">=</span> <span class="n">nT</span> <span class="o">+</span> <span class="n">nP</span> <span class="o">+</span> <span class="n">nMol</span> <span class="o">+</span> <span class="n">nW</span>
            <span class="n">method_sig</span> <span class="o">=</span> <span class="s1">&#39;_calc_&#39;</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;d&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nTot</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;S_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dS_&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nTot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nMol</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dm&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nMol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dT&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nT</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dT&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dP&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nP</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                <span class="s1">&#39;dP&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">method_sig</span> <span class="o">+=</span> <span class="s1">&#39;dw&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">nW</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">chem_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate chemical potential (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>
<span class="sd">        endmember : None or int scalar or int array</span>
<span class="sd">            If None, retrieve an array of chemical potentials, else</span>
<span class="sd">            chemical potential for endmember index or index set in array</span>
<span class="sd">        species : boolean</span>
<span class="sd">            If False, returned value is for components of the solution.</span>
<span class="sd">            If True, returned value is for species in the solution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Chemical potential in J (or derivative in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_mu</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span>
                        <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_mu</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span>
                        <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate activity (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>
<span class="sd">        endmember : None or int scalar or int array</span>
<span class="sd">            If None, retrieve an array of chemical potentials; else</span>
<span class="sd">            chemical potential for endmber index or index set in array</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Activity (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_a&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">deriv</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span>
                        <span class="n">endmember</span><span class="o">=</span><span class="n">endmember</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">fugacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate activity (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Fugacity in bars (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1">###########</span>
    <span class="c1"># order 2 #</span>
    <span class="c1">###########</span>
    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">thermal_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate heat capacity (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Thermal expansion in 1/K (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">method</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_alpha&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate grüneisen parameter (or derivatives) for phase.</span>

<span class="sd">        NOT IMPLEMENTED</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">heat_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate heat capacity (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        const : [&#39;P&#39;, &#39;V&#39;], optional</span>
<span class="sd">            Defines constant path for derivative (yielding C_P vs C_V)</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Thermal expansion in J/K (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">const</span><span class="o">==</span><span class="s1">&#39;P&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_Cp&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">deriv</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">deriv</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">const</span><span class="o">==</span><span class="s1">&#39;V&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">deriv</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_Cv&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">bulk_mod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate bulk modulus (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        const : [&#39;T&#39;, &#39;S&#39;], optional</span>
<span class="sd">            Defines constant path for derivative (yielding K_T vs K_S)</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Bulk modulus in bars (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">const</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_K&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nP</span>   <span class="o">=</span> <span class="n">deriv</span><span class="p">[</span><span class="s1">&#39;dP&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dP&#39;</span> <span class="ow">in</span> <span class="n">deriv</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">nP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_Kp&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># const==&#39;S&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@validate</span>
    <span class="k">def</span> <span class="nf">compressibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deriv_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_deriv_qty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate compressibility (or derivatives) for phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : array-like</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        P : array-like</span>
<span class="sd">            Pressure in bars.</span>
<span class="sd">        mol : array-like, optional</span>
<span class="sd">            Composition in terms of mols of endmembers</span>
<span class="sd">            (unneeded for pure phases).</span>
<span class="sd">        const : [&#39;T&#39;, &#39;S&#39;], optional</span>
<span class="sd">            Defines constant path for derivative (yielding Beta_T vs Beta_S)</span>
<span class="sd">        V : array-like, optional (default None)</span>
<span class="sd">            Volume in J/bar. Overrides pressure if not None.</span>
<span class="sd">        deriv : dict of ints</span>
<span class="sd">            Derivative order for each parameter</span>
<span class="sd">            (default is zero for all params).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value : array-like</span>
<span class="sd">            Bulk modulus in 1/bars (or derivatives in deriv units).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">const</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">deriv_param</span><span class="p">):</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_calc_beta&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span><span class="p">,(</span><span class="n">iT</span><span class="p">,</span><span class="n">iP</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mol</span><span class="p">)):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">iT</span><span class="p">,</span> <span class="n">iP</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">imol</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># const==&#39;S&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">######################</span>
    <span class="c1"># Calculator methods #</span>
    <span class="c1">######################</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dG_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dG_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dG_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dG_dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dTdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dTdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2G_dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dT3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dTdP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dTdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dTdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dP3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dPdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dm3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d3G_dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dTdPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dP2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dm3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dTdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dT3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dTdP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d4G_dP3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d5G_dT2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d5G_dTdPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d5G_dP2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># (order=1)</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_V</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_Cv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_Cp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dCp_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dV_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dV_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_beta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_Kp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># Compositional quantities</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_mu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dV_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dS_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_da_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># (order=3)</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_dCp_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dmdT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dmdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2S_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_d2V_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span></div>

<span class="c1">#===================================================</span>
<div class="viewcode-block" id="PurePhase"><a class="viewcode-back" href="../phases.html#phases.PurePhase">[docs]</a><span class="k">class</span> <span class="nc">PurePhase</span><span class="p">(</span><span class="n">Phase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pure stoichiometric phases.</span>

<span class="sd">    Implements the Phase interface.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase_classnm : str</span>
<span class="sd">        Official class name for phase (implemented in src code)</span>
<span class="sd">    abbrev : str</span>
<span class="sd">        Official abbreviation of phase (regardless of implementation)</span>
<span class="sd">    calib : bool, default True</span>
<span class="sd">        Indicates whether sample phase should be calibration ready</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    Berman_formula</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * This code is highly dependent on implementation and is likely to change</span>
<span class="sd">      dramatically with changes in the underlying code that calculates phase</span>
<span class="sd">      properties.</span>
<span class="sd">    * The pure water phase, &quot;H2O&quot;, is very complex and thus not available for</span>
<span class="sd">      calibration. The water phase will force its calib flag to False, regardless</span>
<span class="sd">      of input value.</span>
<span class="sd">    * In addition to the attributes listed, this class inherits the Phase class</span>
<span class="sd">      attributes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;objc&#39;</span><span class="p">,</span>
        <span class="n">coder_module</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="n">calib</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">coder_module</span><span class="o">=</span><span class="n">coder_module</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_pure_phase_props</span><span class="p">(</span><span class="n">phase_classnm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_type</span> <span class="o">=</span> <span class="s1">&#39;pure&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getGibbsFreeEnergyFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getVolumeFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDtFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDpFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDt2FromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDtDpFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDp2FromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getEnthalpyFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getEntropyFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getVolumeFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDtFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDpFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDt2FromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDtDpFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDp2FromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getHeatCapacityFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDcpDtFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getGibbsFreeEnergyFromT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_calibnm</span> <span class="o">=</span> <span class="n">phase_classnm</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;calib&#39;</span><span class="p">,</span> <span class="s1">&#39;dparam&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calib</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;dgdt&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;dgdp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;cv&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;cp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dcpdt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;Kp&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_pure_phase_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="p">):</span>
        <span class="n">phase_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_obj</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">element_comp</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span>
                <span class="n">phase_obj</span><span class="o">.</span><span class="n">formulaAsElementArray</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;elements&#39;</span><span class="p">)</span>
            <span class="n">element_comp</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
        <span class="n">atom_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_comp</span><span class="p">)</span>
        <span class="n">elem_num</span> <span class="o">=</span> <span class="n">element_comp</span><span class="o">.</span><span class="n">size</span>
        <span class="n">mol_oxide_comp</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">calc_mol_oxide_comp</span><span class="p">(</span><span class="n">element_comp</span><span class="p">)</span>

        <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])])</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#TK</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phase_obj</span><span class="o">.</span><span class="n">phaseFormula</span><span class="p">])</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phase_obj</span><span class="o">.</span><span class="n">mw</span><span class="p">])</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;elemental_entropy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">phase_obj</span><span class="o">.</span><span class="n">entropyFromRobieEtAl1979</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;formula&#39;</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">method</span><span class="p">()])</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;mw&#39;</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">method</span><span class="p">()])</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;elemental_entropy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;atom_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom_num</span><span class="p">])</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">element_comp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;mol_oxide_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mol_oxide_comp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Berman_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Representation of formula using Berman format</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Chemical formula of phase (str)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">chem</span><span class="o">.</span><span class="n">get_Berman_formula</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">not_coded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s1">&#39;Function not implemented for this database model.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dPdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dm3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dP2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dm3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dP3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dT2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dTdPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dP2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dS_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2S_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_Cv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_Cp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dCp_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dCp_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_V</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dmdT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dmdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_beta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_Kp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="c1"># Compositional quantities</span>
    <span class="k">def</span> <span class="nf">_calc_mu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_da_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span></div>

<span class="c1">#===================================================</span>
<div class="viewcode-block" id="SolutionPhase"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase">[docs]</a><span class="k">class</span> <span class="nc">SolutionPhase</span><span class="p">(</span><span class="n">Phase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solid solution phases.</span>

<span class="sd">    Implements the Phase interface.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase_classnm : str</span>
<span class="sd">        Official class name for phase (implemented in src code).</span>
<span class="sd">    abbrev : str</span>
<span class="sd">        Official abbreviation of phase (regardless of implementation).</span>
<span class="sd">    calib : bool, default True</span>
<span class="sd">        Indicates whether sample phase should be calibration ready.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    Attributes for this class are inherited from the Phase class.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * This code is highly dependent on implementation and is likely to change</span>
<span class="sd">      dramatically with changes in the underlying code that calculates phase</span>
<span class="sd">      properties.</span>
<span class="sd">    * The pure water phase, &quot;H2O&quot;, is very complex and thus not available for</span>
<span class="sd">      calibration. The water phase will force its calib flag to False, regardless</span>
<span class="sd">      of input value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;objc&#39;</span><span class="p">,</span>
        <span class="n">coder_module</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">phase_classnm</span><span class="p">,</span> <span class="n">abbrev</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="n">calib</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">coder_module</span><span class="o">=</span><span class="n">coder_module</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_endmember_props</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_type</span> <span class="o">=</span> <span class="s1">&#39;solution&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getGibbsFreeEnergyFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getVolumeFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDgDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDgDwFromMolesOfComponents_andT_andP_&#39;</span>
                <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDtFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2gDm2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getChemicalPotentialDerivativesForParameter_usingMolesOfComponents_andT_andP_&#39;</span>
                <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDt2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDtDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDmDtFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDp2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDmDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDm2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD3gDm3FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getEnthalpyFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getEntropyFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDsDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2sDm2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getVolumeFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDtFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDvDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDt2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDtDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDp2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDmDtFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDmDpFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getD2vDm2FromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getHeatCapacityFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDcpDtFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDCpDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getChemicalPotentialFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getActivityFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="p">,</span>
                <span class="s1">&#39;getDaDmFromMolesOfComponents_andT_andP_&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_calibnm</span> <span class="o">=</span> <span class="n">phase_classnm</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;calib&#39;</span><span class="p">,</span> <span class="s1">&#39;dparam&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calib</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdn&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdndt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;dgdt&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdndp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;dgdp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdn2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;dgdn&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdndt2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdt2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdndtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdn2dt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdndp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdn2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdn3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="c1"># d4gdndt3, d4gdndt2dp, d4gdndtdp2, d4gdndp3 are defined in code</span>
            <span class="c1"># d4gdn2dt2, d4gdn2dtdp, d4gdn2dp2 are defined in code</span>
            <span class="c1"># d4gdn3dt, d4gdn3dp are defined in code</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdt3&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_calibnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="c1"># d5gdn2dt3, d5gdn2dt2dp, d5gdn2dtdp2, d5gdn2dp3 are defined in code</span>
            <span class="c1"># d5gdn3dt2, d5gdn3dtdp, d5gdn3dp2 are defined in code</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="c1"># d6gdn3dt3, d6gdn3dt2dp, d6gdn3dtdp2, d6gdn3dp3 are defined in code</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d2gdndp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdp3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdndtdp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdndp2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;d3gdn2dp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;cv&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;cp&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dcpdt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;Kp&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;dgdn&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;not_coded&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_endmember_props</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">phase_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_obj</span>
        <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_obj</span><span class="o">.</span><span class="n">supportsParameterCalibration</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_calib</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_calib</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">endmember_num</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">numberOfSolutionComponents</span><span class="p">()</span>
                <span class="n">oxide_num</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">numberOfSolutionSpecies</span><span class="p">()</span>
                <span class="n">species_num</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">numberOfSolutionSpecies</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">endmember_num</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">oxide_num</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">species_num</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_classnm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;endmember_number&#39;</span><span class="p">)</span>
            <span class="n">endmember_num</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="n">oxide_num</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;species_number&#39;</span><span class="p">)</span>
            <span class="n">species_num</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Solution phase code generated by the coder module &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;does not yet provide information on solution species. &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;Species are proxied by components.&#39;</span><span class="p">)</span>

        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">molwt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mol_oxide_comp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">element_comp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">formula</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">atom_num</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">species_elms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">endmember_num</span><span class="p">):</span>
                    <span class="n">iendmember</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">componentAtIndex_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">iendmember_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">iendmember</span><span class="o">.</span><span class="n">phaseName</span><span class="p">)</span>
                    <span class="n">iendmember_formula</span> <span class="o">=</span> <span class="n">iendmember</span><span class="o">.</span><span class="n">phaseFormula</span>
                    <span class="n">imolwt</span> <span class="o">=</span> <span class="n">iendmember</span><span class="o">.</span><span class="n">mw</span>

                    <span class="n">ielems</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span>
                        <span class="n">iendmember</span><span class="o">.</span><span class="n">formulaAsElementArray</span><span class="p">)</span>
                    <span class="n">iatom_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>
                    <span class="n">imol_oxide_comp</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">calc_mol_oxide_comp</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>

                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iendmember_name</span><span class="p">)</span>
                    <span class="n">molwt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imolwt</span><span class="p">)</span>
                    <span class="n">element_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>
                    <span class="n">mol_oxide_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imol_oxide_comp</span><span class="p">)</span>
                    <span class="n">formula</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iendmember_formula</span><span class="p">)</span>
                    <span class="n">atom_num</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iatom_num</span><span class="p">)</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error loading endmember properties for &#39;</span>
                      <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">endmember_num</span><span class="p">):</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">)</span>
                <span class="n">iendmember_name</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;endmember_formula&#39;</span><span class="p">)</span>
                <span class="n">iendmember_formula</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;endmember_mw&#39;</span><span class="p">)</span>
                <span class="n">imolwt</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;endmember_elements&#39;</span><span class="p">)</span>
                <span class="n">ielems</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">iatom_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>
                <span class="n">imol_oxide_comp</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">calc_mol_oxide_comp</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>

                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iendmember_name</span><span class="p">)</span>
                <span class="n">molwt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imolwt</span><span class="p">)</span>
                <span class="n">element_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ielems</span><span class="p">)</span>
                <span class="n">mol_oxide_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imol_oxide_comp</span><span class="p">)</span>
                <span class="n">formula</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iendmember_formula</span><span class="p">)</span>
                <span class="n">atom_num</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iatom_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">species_num</span><span class="p">):</span>
                    <span class="n">ispecies_name</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">nameOfSolutionSpeciesAtIndex_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">ispecies_elms_arr</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">phase_obj</span><span class="o">.</span><span class="n">elementalCompositionOfSpeciesAtIndex_</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                    <span class="n">ispecies_elms</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span>
                        <span class="n">ispecies_elms_arr</span><span class="p">)</span>

                    <span class="n">species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ispecies_name</span><span class="p">)</span>
                    <span class="n">species_elms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ispecies_elms</span><span class="p">)</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error loading species properties for &#39;</span>
                      <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">species_num</span><span class="p">):</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;species_name&#39;</span><span class="p">)</span>
                <span class="n">ispecies_name</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;species_elements&#39;</span><span class="p">)</span>
                <span class="n">ispecies_elms</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ispecies_name</span><span class="p">)</span>
                <span class="n">species_elms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ispecies_elms</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Solution phase code generated by the coder module &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;does not yet provide information on species properties. &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;Species are proxied by components.&#39;</span><span class="p">)</span>

        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">molwt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">molwt</span><span class="p">)</span>
        <span class="n">element_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">element_comp</span><span class="p">)</span>
        <span class="n">mol_oxide_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mol_oxide_comp</span><span class="p">)</span>
        <span class="n">formula</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">atom_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atom_num</span><span class="p">)</span>
        <span class="n">oxide_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">mol_oxide_comp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
        <span class="n">species_elms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">species_elms</span><span class="p">)</span>

        <span class="c1"># endmember_props = OrderedDict()</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">endmember_num</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">endmember_num</span><span class="p">)</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;species_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">species_num</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">formula</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;atom_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_num</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">molwt</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;elemental_entropy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;element_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">element_comp</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;mol_oxide_comp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mol_oxide_comp</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;oxide_space&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxide_space</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;species_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">species</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;species_elms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">species_elms</span>
        <span class="c1"># self._endmember_props = endmember_props</span>

    <span class="c1"># methods:</span>
<div class="viewcode-block" id="SolutionPhase.calc_endmember_comp"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.calc_endmember_comp">[docs]</a>    <span class="k">def</span> <span class="nf">calc_endmember_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_oxide_comp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;least_squares&#39;</span><span class="p">,</span>
                            <span class="n">output_residual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">decimals</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get fraction of each endmember given the composition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_oxide_comp : double array</span>
<span class="sd">            Amounts of each oxide in standard order (defined in OXIDES)</span>
<span class="sd">        decimals : int, default 10</span>
<span class="sd">            Number of decimals to round result to</span>
<span class="sd">        method : str, default &#39;least_squares&#39;</span>
<span class="sd">            Method used to convert oxide composition (in moles) to moles of</span>
<span class="sd">            endmembers &#39;intrinsic&#39; is alternate method, hardcoded by the</span>
<span class="sd">            solution implementation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        endmember_comp : double array</span>
<span class="sd">            Best-fit molar composition in terms of endmembers</span>
<span class="sd">        mol_oxide_comp_residual : double array</span>
<span class="sd">            Residual molar oxide composition</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * Eventually, we may want the ability to calculate endmember comp. using</span>
<span class="sd">          a variety of methods for inputing composition:</span>
<span class="sd">              * kind : [&#39;wt_oxide&#39;, &#39;mol_oxide&#39;, &#39;element&#39;]</span>
<span class="sd">                    Identifies how composition is defined.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">mol_oxide_comp</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;oxide_num&#39;</span><span class="p">],</span> <span class="p">(</span>
            <span class="s1">&#39;Oxide composition array not standard length&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;least_squares&#39;</span><span class="p">:</span>
            <span class="n">mol_oxide_comp_endmembers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;mol_oxide_comp&#39;</span><span class="p">]</span>
            <span class="c1"># NOTE: mol oxide composition is extensive (in absolute mols)</span>
            <span class="c1"># need not sum to 1.</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span>
                <span class="n">mol_oxide_comp_endmembers</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mol_oxide_comp</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

            <span class="n">endmember_comp</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">endmember_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">endmember_comp</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)</span>

            <span class="n">mol_oxide_comp_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mol_oxide_comp_endmembers</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="n">endmember_comp</span><span class="p">)</span>
            <span class="n">mol_oxide_comp_residual</span> <span class="o">=</span> <span class="p">(</span><span class="n">mol_oxide_comp</span> <span class="o">-</span> <span class="n">mol_oxide_comp_model</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;intrinsic&#39;</span><span class="p">:</span>
            <span class="n">elems</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">PERIODIC_ORDER</span>
            <span class="n">monovalent_cations</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;cations&#39;</span><span class="p">]</span>
            <span class="n">monovalent_elem_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elems</span><span class="o">==</span><span class="n">icat</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">icat</span> <span class="ow">in</span> <span class="n">monovalent_cations</span><span class="p">])</span>
            <span class="n">oxy_elem_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elems</span><span class="o">==</span><span class="s1">&#39;O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">moles_elm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">chem</span><span class="o">.</span><span class="n">PERIODIC_ORDER</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mol_oxide_comp</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">monovalent_elem_ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">nCat</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;cat_num&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">nOx</span> <span class="o">=</span> <span class="n">chem</span><span class="o">.</span><span class="n">oxide_props</span><span class="p">[</span><span class="s1">&#39;oxy_num&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">moles_elm</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mol_oxide_comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">nCat</span>
                <span class="n">moles_elm</span><span class="p">[</span><span class="n">oxy_elem_ind</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mol_oxide_comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">nOx</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">moles_pot_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToMoles_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">moles_elm</span><span class="p">))</span>
                <span class="n">endmember_comp</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">moles_pot_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span><span class="o">+</span><span class="s1">&#39;conv_elm_to_moles&#39;</span><span class="p">)</span>
                <span class="n">endmember_comp</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">moles_elm</span><span class="p">)</span>
            <span class="n">mol_oxide_comp_residual</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span>
                <span class="s1">&#39;Method argument is not valid. Choose either &quot;least_squares&quot; &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;or &quot;intrinic&quot;.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
            <span class="n">mol_oxide_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">endmember_comp</span><span class="p">)</span>
            <span class="n">endmember_comp</span> <span class="o">/=</span> <span class="n">mol_oxide_tot</span>
            <span class="k">if</span> <span class="n">mol_oxide_comp_residual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mol_oxide_comp_residual</span> <span class="o">/=</span> <span class="n">mol_oxide_tot</span>

        <span class="k">if</span> <span class="n">output_residual</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">endmember_comp</span><span class="p">,</span> <span class="n">mol_oxide_comp_residual</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">endmember_comp</span></div>

<div class="viewcode-block" id="SolutionPhase.test_endmember_comp"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.test_endmember_comp">[docs]</a>    <span class="k">def</span> <span class="nf">test_endmember_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_comp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests validity of endmember component moles array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_comp : double array</span>
<span class="sd">            Mole numbers of each component in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        flag : boolean</span>
<span class="sd">            True is composition is valid, otherwise False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">testPermissibleValuesOfComponents_</span><span class="p">(</span>
                <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span><span class="o">+</span><span class="s1">&#39;test_moles&#39;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="SolutionPhase.compute_formula"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.compute_formula">[docs]</a>    <span class="k">def</span> <span class="nf">compute_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol_comp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts an input array of moles of endmember components to</span>
<span class="sd">        the chemical formula of the phase</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : double</span>
<span class="sd">            Temperature in Kelvins</span>
<span class="sd">        P : double</span>
<span class="sd">            Pressure in bars</span>
<span class="sd">        mol_comp : double array</span>
<span class="sd">            Mole numbers of each component in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        formula : str</span>
<span class="sd">            A string with the formula of the phase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">getFormulaFromMolesOfComponents_andT_andP_</span><span class="p">(</span>
            <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_classnm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;formula&#39;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol_comp</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="SolutionPhase.covert_endmember_comp"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.covert_endmember_comp">[docs]</a>    <span class="k">def</span> <span class="nf">covert_endmember_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_comp</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;total_moles&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts an input array of moles of endmember components to</span>
<span class="sd">        the specified quantity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_comp : double array</span>
<span class="sd">            Mole numbers of each component in the solution</span>
<span class="sd">        output : str, default = &#39;total_moles&#39;</span>
<span class="sd">            Output quantity:</span>
<span class="sd">              - &#39;total_moles&#39; - double</span>
<span class="sd">              - &#39;moles_elements&#39; - double array (standard order and length)</span>
<span class="sd">              - &#39;mole_fraction&#39; - double array (same order and length as input)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : double or double array</span>
<span class="sd">            The computed quantity as double or double array</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_moles&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">totalMolesFromMolesOfComponents_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;moles_elements&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertMolesToElements_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;mole_fraction&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertMolesToMoleFractions_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;output option must be &#39;total_moles&#39;, &quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;&#39;moles_elements&#39;, or &#39;mole_fraction&#39;.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_classnm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_moles&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span><span class="o">+</span><span class="s1">&#39;conv_moles_to_tot_moles&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;moles_elements&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span><span class="o">+</span><span class="s1">&#39;conv_moles_to_elm&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;mole_fraction&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span><span class="o">+</span><span class="s1">&#39;conv_moles_to_mole_frac&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_comp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;output option must be &#39;total_moles&#39;, &quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;&#39;moles_elements&#39;, or &#39;mole_fraction&#39;.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="SolutionPhase.convert_species_to_comp"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.convert_species_to_comp">[docs]</a>    <span class="k">def</span> <span class="nf">convert_species_to_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_species</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts an input array of moles of species to moles of</span>
<span class="sd">        endmember components</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_species : double array</span>
<span class="sd">            Mole numbers of each species in the solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : double array</span>
<span class="sd">            Moles of endmember components</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">result_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertMolesOfSpeciesToMolesOfComponents_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_species</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">result_arr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Solution phase code generated by the coder module &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;does not yet provide a conversion method.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="SolutionPhase.convert_elements"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.convert_elements">[docs]</a>    <span class="k">def</span> <span class="nf">convert_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_elm</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;moles_end&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts an array of mole numbers of elements (in the standard order) to</span>
<span class="sd">        the specified output quantity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mole_elm : double array</span>
<span class="sd">            Mole numbers of elements in the standard order</span>
<span class="sd">        output : str, default = &#39;moles_end&#39;</span>
<span class="sd">            Output quantity:</span>
<span class="sd">              - &#39;moles_end&#39; - double array of moles of endmembers</span>
<span class="sd">              - &#39;total_moles&#39; - double, sum of moles of endmembers</span>
<span class="sd">              - &#39;total_grams&#39; - double, sum of grams of solution</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result : double or double array</span>
<span class="sd">            The computed quantity as double or double array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;moles_end&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToMoles_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_moles&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToTotalMoles_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_grams&#39;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span><span class="n">convertElementsToTotalMass_</span><span class="p">(</span>
                    <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;output option must be &#39;moles_end&#39;, &#39;total_moles&#39;, &quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;or &#39;total_grams&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase_classnm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cls</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;moles_end&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;conv_elm_to_moles&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_moles&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;conv_elm_to_tot_moles&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;total_grams&#39;</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
                    <span class="n">phase_classnm</span><span class="o">+</span><span class="s1">&#39;conv_elm_to_tot_grams&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;output option must be &#39;moles_end&#39;, &#39;total_moles&#39;, &quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;or &#39;total_grams&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SolutionPhase.get_endmember_ind"><a class="viewcode-back" href="../phases.html#phases.SolutionPhase.get_endmember_ind">[docs]</a>    <span class="k">def</span> <span class="nf">get_endmember_ind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_oxide_comp</span><span class="p">,</span> <span class="n">get_endmember_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">TOL</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get index of endmember that best matches composition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_oxide_comp : double array</span>
<span class="sd">            Amounts of each oxide in standard order (defined in OXIDES)</span>
<span class="sd">        TOL : double, default 1e-6</span>
<span class="sd">            Allowed tolerance for mismatch to defined composition</span>
<span class="sd">        get_endmember_comp : bool, default False</span>
<span class="sd">            If true, also return endmember composition array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        endmember_ind : int</span>
<span class="sd">            Index of best-fit endmember</span>
<span class="sd">        endmember_comp : double array, optional</span>
<span class="sd">            Composition array in terms of endmembers.</span>

<span class="sd">            Return if get_endmember_comp==True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">endmember_comp</span><span class="p">,</span> <span class="n">mol_oxide_comp_residual</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_endmember_comp</span><span class="p">(</span><span class="n">mol_oxide_comp</span><span class="p">))</span>

        <span class="n">endmember_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">endmember_comp</span><span class="p">)</span>
        <span class="n">endmember_scl_comp</span> <span class="o">=</span> <span class="n">endmember_comp</span><span class="o">/</span><span class="n">endmember_comp</span><span class="p">[</span><span class="n">endmember_ind</span><span class="p">]</span>

        <span class="n">ind_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">endmember_comp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">ind_else</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ind_all</span><span class="p">,</span> <span class="n">endmember_ind</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="n">endmember_scl_comp</span><span class="p">[</span><span class="n">ind_else</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">TOL</span><span class="p">)),</span> <span class="p">(</span>
                <span class="s1">&#39;Provided composition does not match &#39;</span>
                <span class="s1">&#39;an endmember.&#39;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">get_endmember_comp</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">endmember_ind</span><span class="p">,</span> <span class="n">endmember_comp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">endmember_ind</span></div>

    <span class="k">def</span> <span class="nf">not_coded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s1">&#39;Function not implemented for this database model.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dG_dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dG_dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dT2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dTdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2G_dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">][</span><span class="n">iparam</span><span class="p">]</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">])(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dT2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dTdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">])(</span>
                    <span class="n">iparam</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dP2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dPdm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">])(</span>
                    <span class="n">iparam</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dPdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dm3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_tensor_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm3&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d3G_dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT3dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dPdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dPdw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dT2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">])(</span>
                    <span class="n">iparam</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dT2dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdP2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdP2dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdPdmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">])(</span>
                    <span class="n">iparam</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdPdmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dTdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dTdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dP3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult_term</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP3dw&#39;</span><span class="p">])(</span>
                    <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult_term</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dP2dmdw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">])(</span>
                    <span class="n">iparam</span><span class="p">,</span> <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_arr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dP2dmdw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dPdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d4G_dm3dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_tensor_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d4G_dm3dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dT2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dT2dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dTdPdm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dTdPdm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d5G_dP2dm2dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
                <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iresult</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d5G_dP2dm2dw&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">iparam</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_H&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_G&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_S&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_V</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_V&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_mu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iendmem</span> <span class="ow">in</span> <span class="n">endmember</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">ichem_pot_arr</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_obj</span><span class="o">.</span>
                        <span class="n">chemicalPotentialsOfSpeciesFromMolesOfComponents_andT_andP_</span><span class="p">(</span>
                            <span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ichem_pot_arr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

                <span class="n">ichem_pot</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">ichem_pot_arr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">iendmem</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ichem_pot</span> <span class="o">=</span> <span class="n">ichem_pot</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">iendmem</span><span class="p">)]</span>

                <span class="n">chem_pot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ichem_pot</span><span class="p">)</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chem_pot</span><span class="p">)</span> <span class="k">if</span> <span class="n">endmember</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">chem_pot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_mu&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">endmember</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">iendmem</span> <span class="ow">in</span> <span class="n">endmember</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chem_pot</span><span class="p">[</span><span class="n">iendmem</span><span class="p">])</span>
                <span class="n">chem_pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">chem_pot</span>

    <span class="k">def</span> <span class="nf">_calc_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iendmem</span> <span class="ow">in</span> <span class="n">endmember</span><span class="p">:</span>
                <span class="n">ichem_pot_arr</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">))</span>
                <span class="n">ichem_pot</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">ichem_pot_arr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">iendmem</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ichem_pot</span> <span class="o">=</span> <span class="n">ichem_pot</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">iendmem</span><span class="p">)]</span>

                <span class="n">chem_pot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ichem_pot</span><span class="p">)</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chem_pot</span><span class="p">)</span> <span class="k">if</span> <span class="n">endmember</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">chem_pot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chem_pot</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_a&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">chem_pot</span>

    <span class="k">def</span> <span class="nf">_calc_dS_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dS_dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2G_dTdm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_da_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">iresult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">endmember</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">iendmem</span> <span class="ow">in</span> <span class="n">endmember</span><span class="p">:</span>
                    <span class="n">iresult</span> <span class="o">=</span> <span class="n">iresult</span><span class="p">[[</span><span class="nb">int</span><span class="p">(</span><span class="n">iendmem</span><span class="p">)],</span> <span class="p">:][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresult</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">iresult</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_da_dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2S_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2S_dm2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dTdm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dm2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_matrix_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dm2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_Cv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cv&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_Cp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for &#39;</span>
            <span class="s1">&#39;SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Cp&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dV_dP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dV_dP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dCp_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_dCp_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_dCp_dm&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d3G_dT2dm&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span><span class="o">/</span><span class="n">T</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dT2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dT2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dTdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dTdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dP2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dP2&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dmdT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdT&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_d2V_dmdP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">iresult_mat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">double_vector_to_array</span><span class="p">(</span><span class="n">iresult_mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_d2V_dmdP&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_density&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_alpha&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_beta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_beta&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_K&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_calc_Kp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s1">&#39;Molar composition &quot;mol&quot; must be defined for SolutionPhase.&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;objc&#39;</span><span class="p">:</span>
            <span class="n">cmol</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">array_to_ctype_array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">])(</span><span class="n">cmol</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_methods</span><span class="p">[</span><span class="s1">&#39;_calc_Kp&#39;</span><span class="p">])(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<span class="c1">#===================================================</span>


<span class="c1"># class Sample:</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Sample Phase with specific properties.</span>
<span class="c1">#</span>
<span class="c1">#     Parameters</span>
<span class="c1">#     ----------</span>
<span class="c1">#     phase_classnm : str</span>
<span class="c1">#         Official class name for phase (implemented in src code).</span>
<span class="c1">#     abbrev : str</span>
<span class="c1">#         Official abbreviation of phase (regardless of implementation).</span>
<span class="c1">#     mol : array, optional</span>
<span class="c1">#         Molar composition vector describing amount of each endmember. This</span>
<span class="c1">#         quantity is only meaningful for solution phases, since pure phases have</span>
<span class="c1">#         fixed composition (default is an empty list).</span>
<span class="c1">#     kind : {&#39;Pure&#39;,&#39;Solution&#39;,&#39;Aqueous&#39;,&#39;Gas&#39;}</span>
<span class="c1">#         Defines kind of sample phase.</span>
<span class="c1">#     calib : bool, default True</span>
<span class="c1">#         Indicates whether sample phase should be calibration ready.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     Attributes</span>
<span class="c1">#     ----------</span>
<span class="c1">#     mol</span>
<span class="c1">#     kind</span>
<span class="c1">#     phase : Phase object</span>
<span class="c1">#         Stores implementation of phase, including all property parameter values.</span>
<span class="c1">#</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#     def __init__(self, phase_classnm, abbrev, mol=None,</span>
<span class="c1">#                  kind=&#39;Pure&#39;, calib=True):</span>
<span class="c1">#</span>
<span class="c1">#         self.mol = mol</span>
<span class="c1">#         self.kind = kind</span>
<span class="c1">#</span>
<span class="c1">#         if kind == &#39;Pure&#39;:</span>
<span class="c1">#             phase = PurePhase(phase_classnm, abbrev, calib=calib)</span>
<span class="c1">#         elif kind == &#39;Solution&#39;:</span>
<span class="c1">#             phase = SolutionPhase(phase_classnm, abbrev, calib=calib)</span>
<span class="c1">#         elif kind == &#39;Aqueous&#39;:</span>
<span class="c1">#             phase = AqueousPhase( phase_classnm, abbrev, calib=calib )</span>
<span class="c1">#         elif kind == &#39;Gas&#39;:</span>
<span class="c1">#             phase = GasPhase( phase_classnm, abbrev, calib=calib )</span>
<span class="c1">#         else:</span>
<span class="c1">#             raise NotImplemented(&#39;Sample kind &quot;&#39;+kind+&#39;&quot; is not yet implimented&#39;)</span>
<span class="c1">#</span>
<span class="c1">#         self.phase = phase</span>
<span class="c1">#</span>
<span class="c1">#         pass</span>
<span class="c1">#===================================================</span>
    <span class="c1"># def get_dG_dw( self, mol_a, T, P ):</span>
    <span class="c1">#     assert False, &#39;</span>
    <span class="c1">#     mol_vec = core.array_to_double_vector(mol_a)</span>
    <span class="c1">#     print(mol_vec)</span>
    <span class="c1">#     dG_dw_vec = self._phase_obj.getDgDwFromMolesOfComponents_andT_andP_( mol_vec, T, P )</span>
    <span class="c1">#     print(dG_dw_vec)</span>
    <span class="c1">#     dG_dw_a = core.double_vector_to_array( dG_dw_vec )</span>

    <span class="c1">#     return dG_dw_a</span>

    <span class="c1"># def get_dchempot_dw</span>
    <span class="c1"># getChemicalPotentialDerivativesForParameterArray:(NSArray *)array usingMolesOfComponents:(double *)m andT:(double)t andP:</span>

    <span class="c1"># def get_dchempot_dw( self, T_a, P_a ):</span>
    <span class="c1">#     self._phase_obj.getChemicalPotentialDerivativesForParameter_usingMolesOfComponents_andT_andP_(&#39;S&#39;,m,T,P)</span>
</pre></div>

          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>