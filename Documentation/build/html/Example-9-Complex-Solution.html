<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Complex Solution SymPy Code Generation &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="None"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="search" title="Search" href="search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="index.html">
      <img style="border: 0;" alt="ENKI" src="_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="index.html">Thermoengine 1.0.1 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="complex-solution-sympy-code-generation">
<h1>Complex Solution SymPy Code Generation<a class="headerlink" href="#complex-solution-sympy-code-generation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solutions-with-cation-ordering">
<h2>Solutions with Cation Ordering<a class="headerlink" href="#solutions-with-cation-ordering" title="Permalink to this headline">¶</a></h2>
<p>Generation of configurational entropy (<span class="math notranslate nohighlight">\({S^{config}}\)</span>) using
combinatorics coupled with <span class="math notranslate nohighlight">\(n^{th}\)</span>-order Taylor expansion of the
non-configurational Gibbs free energy (<span class="math notranslate nohighlight">\({G^*}\)</span>). The final
expression for the Gibbs free energy of solution is given by
<span class="math notranslate nohighlight">\(G = -{T}{S^{config}} + {G^*}\)</span>.</p>
<p>This notebook illustrates construction of this problem using the coder
module of the thermoengine package.</p>
<p>Generally, the Taylor expansion of <span class="math notranslate nohighlight">\({G^*}\)</span> is taken to order two
(equivalent to regular solution theory) and cation-ordering between
symmetrically non-equivalent crystallographic sites is assumed to be
non-convergent, i.e. the random ordering state is not acheived at finite
temperature. Alternately, cation-ordering may be modeled as convergent,
inducing a symmetry breaking phase transition at finite temperature,
which necessitates Taylor expansion of <span class="math notranslate nohighlight">\({G^*}\)</span> to at least
<span class="math notranslate nohighlight">\(4^{th}\)</span> order (in ordering parameter) with retention of only even
powers of the ordering variable(s) in the expansion.</p>
<p>This notebook illustrates non-convergent ordering in a reciprocal
solution model for orthpyroxene in the compositional space of the
pyroxene quadrilateral: Mg2Si2O6-Fe2Si2O6-CaMgSi2O6-CaFeSi2O6</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">coder</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">core</span>
</pre></div>
</div>
</div>
<div class="section" id="complex-solution-properties-general-structure-of-the-model">
<h2>Complex Solution Properties - General structure of the model<a class="headerlink" href="#complex-solution-properties-general-structure-of-the-model" title="Permalink to this headline">¶</a></h2>
<p>There are three terms: - Terms describing standard state contributions -
Terms describing the configurational entropy of solution - Terms
describing the excess enthalpy of solution</p>
<p>Assumptions: - There are <span class="math notranslate nohighlight">\(c\)</span> components in the system - There may
be more endmember species, <span class="math notranslate nohighlight">\(w\)</span>, than there are components, thereby
allowing for reciprocal solutions - Cation ordering is permitted, which
may be either convergent or non-convergent. There may be zero or more
cation ordering variables, <span class="math notranslate nohighlight">\(s\)</span>. - The configurational entropy
formulation assumes random mixing on symmetrically distinct
crystallographic sites - The excess enthalpy is described using a Taylor
series expansion in compositional and ordering variables. The order of
the expansion is <span class="math notranslate nohighlight">\(\nu\)</span>.</p>
</div>
<div class="section" id="number-of-solution-components-and-number-of-solution-species">
<h2>Number of solution components and number of solution species<a class="headerlink" href="#number-of-solution-components-and-number-of-solution-species" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Note, that the example illustrated in this notebook - orthopyroxene in
the system Mg2Si2O6-Fe2Si2O6-CaMgSi2O6-CaFeSi2O6, requires three
endmember thermodynamic components but clearly has four endmember
species. This is an example of a recipocal solution. One of the
species endmembers is compositionally redundent, but <em>not</em>
energetically redundant. Hence the Gibbs free energy change of the
reaction:</div>
<div class="line">Mg2Si2O6 + 2 CaFeSi2O6 = Fe2Si2O6 + 2 CaMgSi2O6</div>
<div class="line">is not zero, even though the concentration of the species Fe2Si2O6 may
be expressed as:</div>
<div class="line">2 CaFeSi2O6 - 2 CaMgSi2O6 + Mg2Si2O6</div>
<div class="line">Additionally, there is one variable that denotes the degree of cation
ordering of Fe++ and Mg over the M1 and M2 crystallographic sites in
the pyroxene structure.</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">nw</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-complex-solution-model">
<h2>Create a complex solution model<a class="headerlink" href="#create-a-complex-solution-model" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">A <em>complex</em> solution is one that includes ordering parameters as well
as endmember thermodynamic components.</div>
<div class="line">Instantiate the class with the specified number of endmember
thermodynamic components and species</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">coder</span><span class="o">.</span><span class="n">ComplexSolnModel</span><span class="p">(</span><span class="n">nc</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">nw</span><span class="o">=</span><span class="n">nw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="retrieve-primary-compositional-variables">
<h2>Retrieve primary compositional variables<a class="headerlink" href="#retrieve-primary-compositional-variables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is a vector of mole numbers of each component</p></li>
<li><p><span class="math notranslate nohighlight">\(n_T\)</span> is the total number of moles in the solution</p></li>
<li><p><span class="math notranslate nohighlight">\(s\)</span> is a vector of ordering parameters</p></li>
</ul>
<div class="section" id="and-construct-a-derived-mole-fraction-variable">
<h3>and construct a derived mole fraction variable<a class="headerlink" href="#and-construct-a-derived-mole-fraction-variable" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X\)</span> is a vector of mole fractions of thermodynamic components
in the system</p></li>
</ul>
</div>
<div class="section" id="and-a-reduced-set-of-independent-composition-variables">
<h3>and a reduced set of independent composition variables<a class="headerlink" href="#and-a-reduced-set-of-independent-composition-variables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span> is a vector of independent mole fractions in the system. By
convention, <span class="math notranslate nohighlight">\(r_{i-1}=X_i\)</span>, where <span class="math notranslate nohighlight">\(i\)</span> ranges from the
second index of <span class="math notranslate nohighlight">\(X\)</span> up to <span class="math notranslate nohighlight">\(c\)</span>. Hence the length of the
vector <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(c-1\)</span></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">n</span>
<span class="n">nT</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nT</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">nT</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">nT</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \left( \left[\begin{matrix}n_{1}\\n_{2}\\n_{3}\end{matrix}\right], \  n_{1} + n_{2} + n_{3}, \  \left[\begin{matrix}\frac{n_{1}}{n_{1} + n_{2} + n_{3}}\\\frac{n_{2}}{n_{1} + n_{2} + n_{3}}\\\frac{n_{3}}{n_{1} + n_{2} + n_{3}}\end{matrix}\right], \  \left[ \frac{n_{2}}{n_{1} + n_{2} + n_{3}}, \  \frac{n_{3}}{n_{1} + n_{2} + n_{3}}\right], \  \left[\begin{matrix}s_{1}\end{matrix}\right]\right)\end{split}\]</div>
</div>
</div>
<div class="section" id="retrieve-the-temperature-pressure-and-standard-state-chemical-potentials">
<h2>Retrieve the temperature, pressure, and standard state chemical potentials<a class="headerlink" href="#retrieve-the-temperature-pressure-and-standard-state-chemical-potentials" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature in <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> is pressure in <span class="math notranslate nohighlight">\(bars\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu^o\)</span> in Joules</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_symbol_for_t</span><span class="p">()</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_symbol_for_p</span><span class="p">()</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mu</span>
<span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">mu</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \left( T, \  P, \  \left[\begin{matrix}\mu_{1}{\left(T,P \right)}\\\mu_{2}{\left(T,P \right)}\\\mu_{3}{\left(T,P \right)}\end{matrix}\right]\right)\end{split}\]</div>
</div>
<div class="section" id="define-the-standard-state-contribution-to-solution-properties">
<h2>Define the standard state contribution to solution properties<a class="headerlink" href="#define-the-standard-state-contribution-to-solution-properties" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">mu</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">G_ss</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle n_{1} \mu_{1}{\left(T,P \right)} + n_{2} \mu_{2}{\left(T,P \right)} + n_{3} \mu_{3}{\left(T,P \right)}\]</div>
</div>
<div class="section" id="define-configurational-entropy-and-configurational-gibbs-free-energy">
<h2>Define configurational entropy and configurational Gibbs free energy<a class="headerlink" href="#define-configurational-entropy-and-configurational-gibbs-free-energy" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Configurational enropy is calculated by counting site configurations,
that is the number of ways of mixing Fe++, Mg and Ca on the M2 site,
<span class="math notranslate nohighlight">\(\Omega^{M2}\)</span>, times the number of ways of mixing Fe++ and Mg on
the M1 site, <span class="math notranslate nohighlight">\(\Omega^{M1}\)</span>; configurations (<span class="math notranslate nohighlight">\(\Omega\)</span>)
equal <span class="math notranslate nohighlight">\(\Omega^{M1}\Omega^{M2}\)</span>. The assumption is made that the
mixing on each site is random, i.e.</div>
<div class="line">If there are two cations on site M1, and their mole fractions on that
site are denoted <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, and if there is one such
sites in the formula unit, then the number of configurations,
<span class="math notranslate nohighlight">\(\Omega\)</span>, associted with <strong>random</strong> mixing of cations on that
site is:</div>
<div class="line"><span class="math notranslate nohighlight">\(\Omega = \left[ {\frac{{\left( {X + Y} \right)!}}{{X!Y!}}} \right]\)</span></div>
<div class="line">and the molar configurational entropy conribution associated with
these configurations is given by Boltzmann’s law:
<span class="math notranslate nohighlight">\({{\hat S}^{conf}} = R\log \Omega\)</span>:</div>
<div class="line"><span class="math notranslate nohighlight">\({{\hat S}^{conf}} = cR\log \left[ {\frac{{\left( {X + Y} \right)!}}{{X!Y!}}} \right]\)</span></div>
<div class="line">Using Stirlings approximation for large factorials,
<span class="math notranslate nohighlight">\(\log X! = X\log X - X\)</span>, the configurational entropy can be
written:</div>
<div class="line"><span class="math notranslate nohighlight">\({{\hat S}^{conf}} = cR\left[ - {X\log X - Y\log Y + \left( {X + Y} \right)\log \left( {X + Y} \right)} \right]\)</span></div>
</div>
<div class="line-block">
<div class="line">Consequently, to utilize this appropach we must define site mole
fractions in terms of our chosen set of independent compositional
variables and ordering parameters. #### There are 5 site mole
fractions:</div>
<div class="line"><span class="math notranslate nohighlight">\(X_{Ca}^{M2}\)</span>, <span class="math notranslate nohighlight">\(X_{Mg}^{M2}\)</span>, <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M2}\)</span>,
<span class="math notranslate nohighlight">\(X_{Mg}^{M1}\)</span>, <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M1}\)</span></div>
<div class="line">#### The requirement of filled sites requires: 1. <span class="math notranslate nohighlight">\(X_{Ca}^{M2}\)</span>
+ <span class="math notranslate nohighlight">\(X_{Mg}^{M2}\)</span> + <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M2}\)</span> = 1 2.
<span class="math notranslate nohighlight">\(X_{Mg}^{M1}\)</span> + <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M1}\)</span> =1</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n_1\)</span>, <span class="math notranslate nohighlight">\(X_1\)</span>, CaMgSi2O6</p></li>
<li><p><span class="math notranslate nohighlight">\(n_2\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, CaFeSi2O6</p></li>
<li><p><span class="math notranslate nohighlight">\(n_3\)</span>, <span class="math notranslate nohighlight">\(X_3\)</span>, Mg2Si2O6</p></li>
</ul>
<ul class="simple">
<li><p>CaMgSi2O6 = <span class="math notranslate nohighlight">\(1-r_1-r_2\)</span></p></li>
<li><p>CaFeSi2O6 = <span class="math notranslate nohighlight">\(r_1\)</span></p></li>
<li><p>Mg2Si2O6 = <span class="math notranslate nohighlight">\(r_2\)</span></p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><span class="math notranslate nohighlight">\(r_1\)</span> = <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M2}\)</span> + <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(r_2\)</span> = 1 - <span class="math notranslate nohighlight">\(X_{Ca}^{M2}\)</span></p></li>
</ol>
<ol class="arabic simple" start="5">
<li><p><span class="math notranslate nohighlight">\(s_1\)</span> = <span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M2}\)</span> - <span class="math notranslate nohighlight">\(X_{Mg}^{M2}\)</span></p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_{Ca}^{M2}\)</span> = <span class="math notranslate nohighlight">\(1-r_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(X_{Mg}^{M2}\)</span> = <span class="math notranslate nohighlight">\(\frac{r_2-s_1}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M2}\)</span> = <span class="math notranslate nohighlight">\(\frac{r_2+s_1}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(X_{Mg}^{M1}\)</span> = <span class="math notranslate nohighlight">\(1-r_1+\frac{r_2+s_1}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(X_{{Fe}^{2+}}^{M1}\)</span> = <span class="math notranslate nohighlight">\(r_1-\frac{r_2+s_1}{2}\)</span></p></li>
</ul>
<p>While this system is fairly easy to solve by inspection, for more
complex situations, assemble the relations in a list of equations that
evaluate to zero, and automatiocally solve that system of equations
using the sympy routine linsolve, i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="p">[</span><span class="n">xCaM2</span> <span class="o">+</span> <span class="n">xMgM2</span> <span class="o">+</span> <span class="n">xFeM2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xMgM1</span> <span class="o">+</span> <span class="n">xFeM1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xFeM2</span> <span class="o">+</span> <span class="n">xFeM1</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xCaM2</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="n">xFeM2</span> <span class="o">-</span> <span class="n">xMgM2</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">linsolve</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">xCaM2</span><span class="p">,</span> <span class="n">xMgM2</span><span class="p">,</span> <span class="n">xFeM2</span><span class="p">,</span> <span class="n">xMgM1</span><span class="p">,</span> <span class="n">xFeM1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xCaM2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">xMgM2</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">xFeM2</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">xMgM1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">xFeM1</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<div class="section" id="the-following-functions-implement-random-mixing-configurational-entropy-on-the-m1-and-m2-sites">
<h3>The following functions implement random mixing configurational entropy on the M1 and M2 sites:<a class="headerlink" href="#the-following-functions-implement-random-mixing-configurational-entropy-on-the-m1-and-m2-sites" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Sconf_M1_random</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Y</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="n">ApB</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">)</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ApB</span> <span class="o">-</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span>
<span class="k">def</span> <span class="nf">Sconf_M2_random</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Y</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="n">Z</span>
    <span class="n">ApBpC</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ApBpC</span> <span class="o">-</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span> <span class="o">-</span> <span class="n">C</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configurational-entropy">
<h2>Configurational entropy<a class="headerlink" href="#configurational-entropy" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(R\)</span> is the gas constant</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="n">S_config</span> <span class="o">=</span> <span class="n">Sconf_M1_random</span><span class="p">(</span><span class="n">xMgM1</span><span class="p">,</span> <span class="n">xFeM1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Sconf_M2_random</span><span class="p">(</span><span class="n">xCaM2</span><span class="p">,</span> <span class="n">xMgM2</span><span class="p">,</span> <span class="n">xFeM2</span><span class="p">)</span>
<span class="n">S_config</span> <span class="o">*=</span> <span class="n">R</span><span class="o">*</span><span class="n">nT</span>
<span class="n">S_config</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle R \left(n_{1} + n_{2} + n_{3}\right) \left(- \left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1\right) \log{\left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1 \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} \right)} - \left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1\right) \log{\left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1 \right)}\right)\]</div>
</div>
<div class="section" id="configurational-gibbs-free-energy">
<h2>Configurational Gibbs free energy<a class="headerlink" href="#configurational-gibbs-free-energy" title="Permalink to this headline">¶</a></h2>
<p>Note that this quantity is extensive, with units of J, <em>not J/mole</em></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_config</span> <span class="o">=</span> <span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">S_config</span>
<span class="n">G_config</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - R T \left(n_{1} + n_{2} + n_{3}\right) \left(- \left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1\right) \log{\left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1 \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} \right)} - \left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1\right) \log{\left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1 \right)}\right)\]</div>
</div>
<div class="section" id="hat-g-non-configurational-molar-gibbs-free-energy">
<h2><span class="math notranslate nohighlight">\(\hat G^*\)</span> - Non-configurational molar Gibbs free energy<a class="headerlink" href="#hat-g-non-configurational-molar-gibbs-free-energy" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\hat G^*\)</span> includes all standard state and excess Gibbs free
energy contributions. It is generally modeled as a Taylor expansion in
composition (<span class="math notranslate nohighlight">\(r\)</span>) and ordering (<span class="math notranslate nohighlight">\(s\)</span>) variables of order 2, 3
or 4. Here, we choose a model of order two. #### Taylor expansion of
<span class="math notranslate nohighlight">\(\hat G^*\)</span> For a second order expansion, the number of Taylor
expansion coefficients is: - 1 for <span class="math notranslate nohighlight">\(G_{0}\)</span> - nc-1 for
<span class="math notranslate nohighlight">\(G_{r_i}\)</span>, <span class="math notranslate nohighlight">\(i=1...nc-1\)</span> - ns for <span class="math notranslate nohighlight">\(G_{s_i}\)</span>,
<span class="math notranslate nohighlight">\(i=1...ns\)</span> - (nc-1)(nc-2)/2 for <span class="math notranslate nohighlight">\(G_{{r_i},{r_{i+1}}}\)</span>,
<span class="math notranslate nohighlight">\(i= 1...nc-2\)</span> - ns(ns-1)/2 for <span class="math notranslate nohighlight">\(G_{{s_i},{s_{i+1}}}\)</span>,
<span class="math notranslate nohighlight">\(i= 1...ns-1\)</span> - ns(nc-1) for <span class="math notranslate nohighlight">\(G_{{r_i},{s_j}}\)</span>,
<span class="math notranslate nohighlight">\(i= 1...nc-1\)</span>, <span class="math notranslate nohighlight">\(j=1...ns\)</span> - nc-1 for
<span class="math notranslate nohighlight">\(G_{{r_i},{r_i}}\)</span>, <span class="math notranslate nohighlight">\(i= 1...nc-1\)</span> - ns for
<span class="math notranslate nohighlight">\(G_{{s_i},{s_i}}\)</span>, <span class="math notranslate nohighlight">\(i= 1...ns\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">taylor</span><span class="p">,</span> <span class="n">taylor_coeff</span><span class="p">,</span> <span class="n">taylor_terms</span><span class="p">)</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">taylor_expansion</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Number of Taylor expansion terms = </span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
<span class="n">taylor</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Taylor</span> <span class="n">expansion</span> <span class="n">terms</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle G_{0} + \frac{Gr_{1} n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{Gr_{2} n_{3}}{n_{1} + n_{2} + n_{3}} + \frac{Grr_{11} n_{2}^{2}}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{Grr_{12} n_{2} n_{3}}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{Grr_{22} n_{3}^{2}}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{Grs_{11} n_{2} s_{1}}{n_{1} + n_{2} + n_{3}} + \frac{Grs_{21} n_{3} s_{1}}{n_{1} + n_{2} + n_{3}} + Gs_{1} s_{1} + Gss_{11} s_{1}^{2}\]</div>
<div class="section" id="identify-taylor-terms-of-hat-g-corresponding-to-component-endmembers">
<h3>Identify Taylor terms of <span class="math notranslate nohighlight">\(\hat{G}^*\)</span> corresponding to component endmembers:<a class="headerlink" href="#identify-taylor-terms-of-hat-g-corresponding-to-component-endmembers" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>diopside, CaMgSi2O6</p></li>
<li><p>hedenbergite, CaFeSi2O6</p></li>
<li><p>enstatite, Mg2Si2O6</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqn1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">symparams</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \left( G_{0} - \mu_{1}{\left(T,P \right)}, \  G_{0} + Gr_{1} + Grr_{11} - \mu_{2}{\left(T,P \right)}, \  G_{0} + Gr_{2} + Grr_{22} - Grs_{21} - Gs_{1} + Gss_{11} - \mu_{3}{\left(T,P \right)}\right)\]</div>
</div>
<div class="section" id="identify-taylor-terms-of-hat-g-corresponding-to-dependent-species-endmembers">
<h3>Identify Taylor terms of <span class="math notranslate nohighlight">\(\hat{G}^*\)</span> corresponding to dependent species endmembers:<a class="headerlink" href="#identify-taylor-terms-of-hat-g-corresponding-to-dependent-species-endmembers" title="Permalink to this headline">¶</a></h3>
<p>ferrosilite, Fe2Si2O6</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gFs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">gFs</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle G_{0} + 2 Gr_{1} + Gr_{2} + 4 Grr_{11} + 2 Grr_{12} + Grr_{22} + 2 Grs_{11} + Grs_{21} + Gs_{1} + Gss_{11}\]</div>
</div>
<div class="section" id="identify-the-free-energy-of-the-reciprocal-reaction-between-endmember-species">
<h3>Identify the free energy of the reciprocal reaction between endmember species:<a class="headerlink" href="#identify-the-free-energy-of-the-reciprocal-reaction-between-endmember-species" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Mg2Si2O6 + 2 CaFeSi2O6 = Fe2Si2O6 + 2 CaMgSi2O6</div>
<div class="line">is defined as the “reciprocal energy,” <span class="math notranslate nohighlight">\(F\)</span>, denoting the
non-co-planarity of the non-configurational Gibbs free energy of the
endmember species. In general, all reciprocal solutions have non-zero
<span class="math notranslate nohighlight">\(F\)</span>. In the paper on pyroxene thermodynamics by Sack and Ghiorso
(Contributions to Mineralogy and Petrology 116: 277-286, 1994)
<span class="math notranslate nohighlight">\(F\)</span> is notated as <span class="math notranslate nohighlight">\(\Delta \bar G_{27}^o\)</span></div>
</div>
<p><span class="math notranslate nohighlight">\(F\)</span> is conveniently defined in terms of expressions 1-4:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fh</span><span class="p">,</span><span class="n">Fs</span><span class="p">,</span><span class="n">Fv</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Fh Fs Fv&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Fh&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fh</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Fs&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/K-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Fv&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fv</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Fh</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">Fs</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">Fv</span>
<span class="n">eqn4</span>  <span class="o">=</span>   <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">-=</span>   <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">-=</span> <span class="mi">2</span><span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">-=</span> <span class="n">F</span>
<span class="n">eqn4</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - Fh + Fs T - Fv P + 2 Grr_{11} + 2 Grr_{12} + 2 Grs_{11} + 2 Grs_{21} + 2 Gs_{1}\]</div>
</div>
<div class="section" id="identify-the-free-energy-of-the-ordering-reaction">
<h3>Identify the free energy of the ordering reaction:<a class="headerlink" href="#identify-the-free-energy-of-the-ordering-reaction" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">MgFeSi2O6 = FeMgSi2O6</div>
<div class="line">which will be notated as <span class="math notranslate nohighlight">\(Gex\)</span>, (in Sack and Ghiorso, 1994,
<span class="math notranslate nohighlight">\(\Delta \bar G_{EX}^o\)</span>)</div>
<div class="line">Note that both compositions, MgFeSi2O6 and FeMgSi2O6, are equivalent
and defined by CaFeSi2O6 - CaMgSi2O6 + Mg2Si2O6. They differ only by
the sign of the ordering parameter.</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hex</span><span class="p">,</span><span class="n">Vex</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Hex Vex&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Hex</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Vex&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vex</span><span class="p">)</span>
<span class="n">Gex</span> <span class="o">=</span> <span class="n">Hex</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">Vex</span>
<span class="n">eqn5</span>  <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn5</span> <span class="o">-=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn5</span> <span class="o">-=</span> <span class="n">Gex</span>
<span class="n">eqn5</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle 2 Grs_{11} + 2 Grs_{21} + 2 Gs_{1} - Hex - P Vex\]</div>
</div>
<div class="section" id="identify-the-free-energy-of-the-reciprocal-ordering-reaction">
<h3>Identify the free energy of the reciprocal ordering reaction:<a class="headerlink" href="#identify-the-free-energy-of-the-reciprocal-ordering-reaction" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Mg2Si2O6 + Fe2Si2O6 = MgFeSi2O6 + FeMgSi2O6</div>
<div class="line">which will be notated as <span class="math notranslate nohighlight">\(Gx\)</span>, (in Sack and Ghiorso, 1994,
<span class="math notranslate nohighlight">\(\Delta \bar G_{X}^o\)</span>)</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hx</span><span class="p">,</span><span class="n">Vx</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Hx Vx&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hx&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Hx</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Vx&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vx</span><span class="p">)</span>
<span class="n">Gx</span> <span class="o">=</span> <span class="n">Hx</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">Vx</span>
<span class="n">eqn6</span>  <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn6</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn6</span> <span class="o">-=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn6</span> <span class="o">-=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_endmember</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span>
<span class="n">eqn6</span> <span class="o">-=</span> <span class="n">Gx</span>
<span class="n">eqn6</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - 2 Grr_{11} - 2 Grs_{11} - Hx - P Vx\]</div>
</div>
<div class="section" id="identify-regular-solution-interaction-parameters">
<h3>Identify regular solution interaction parameters:<a class="headerlink" href="#identify-regular-solution-interaction-parameters" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Ca-Mg interaction on the M2 site, the join Mg2Si2O6 - CaMgSi2O6,
denoted WM2CaMg</p></li>
<li><p>Ca-Fe interaction on the M2 site, the join Fe2Si2O6 - CaFeSi2O6,
denoted WM2CaFe</p></li>
<li><p>Fe-Mg interaction on the M1 site, the joins Mg2Si2O6 - MgFeSi2O6 or
Fe2Si2O6 - FeMgSi2O6 or CaMgSi2O6 - CaFeSi2O6, which are assumed to
be energetically equivalent, denoted WM1FeMg (in Sack and Ghiorso,
1994, <span class="math notranslate nohighlight">\(W_{12}\)</span></p></li>
<li><p>Fe-Mg interaction on the M2 site, the joins FeMgSi2O6 - Mg2Si2O6 or
Fe2Si2O6 - MgFeSi2O6, which are assumed to be energetically
equivalent, denoted WM2FeMg</p></li>
</ul>
<div class="line-block">
<div class="line">Along the A-B join, described using a regular solution parameter,
<span class="math notranslate nohighlight">\(W\)</span>, <span class="math notranslate nohighlight">\(\hat G^*\)</span> is given by</div>
<div class="line"><span class="math notranslate nohighlight">\({\hat G}^*(X_A,X_B)={X_A}{\hat G}^*(A)+{X_B}{\hat G}^*(B)+W{X_A}{X_B}\)</span>,
so</div>
<div class="line"><span class="math notranslate nohighlight">\(W = \frac{{\hat G}^*(X_A,X_B) - {X_A}{\hat G}^*(A) - {X_B}{\hat G}^*(B)}{{X_A}{X_B}}\)</span></div>
<div class="line">Taking the midpoint of the join provides a way to define the
parameter:</div>
<div class="line"><span class="math notranslate nohighlight">\(W = \frac{{\hat G}^*(\frac{1}{2},\frac{1}{2}) - {\frac{1}{2}}{\hat G}^*(A) - {\frac{1}{2}}{\hat G}^*(B)}{{\frac{1}{2}}{\frac{1}{2}}} = 4{\hat G}^*(\frac{1}{2},\frac{1}{2}) - 2{\hat G}^*(A) - 2{\hat G}^*(B)\)</span></div>
</div>
<ul class="simple">
<li><p>Ca-Mg interaction on the M2 site, the join Mg2Si2O6 - CaMgSi2O6,
denoted WM2CaMg</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WhM2CaMg</span><span class="p">,</span><span class="n">WvM2CaMg</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;WhM2CaMg WvM2CaMg&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WhM2CaMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WhM2CaMg</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WvM2CaMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WvM2CaMg</span><span class="p">)</span>
<span class="n">WM2CaMg</span> <span class="o">=</span> <span class="n">WhM2CaMg</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">WvM2CaMg</span>
<span class="n">eqn7</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_regular_param</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">WM2CaMg</span>
<span class="n">eqn7</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - Grr_{22} + Grs_{21} - Gss_{11} - P WvM2CaMg - WhM2CaMg\]</div>
<ul class="simple">
<li><p>Ca-Fe interaction on the M2 site, the join Fe2Si2O6 - CaFeSi2O6,
denoted WM2CaFe</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WhM2CaFe</span><span class="p">,</span><span class="n">WvM2CaFe</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;WhM2CFe WvM2CaFe&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WhM2CaFe&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WhM2CaFe</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WvM2CaFe&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WvM2CaFe</span><span class="p">)</span>
<span class="n">WM2CaFe</span> <span class="o">=</span> <span class="n">WhM2CaFe</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">WvM2CaFe</span>
<span class="n">eqn8</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_regular_param</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">WM2CaFe</span>
<span class="n">eqn8</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - Grr_{11} - Grr_{12} - Grr_{22} - Grs_{11} - Grs_{21} - Gss_{11} - P WvM2CaFe - WhM2CFe\]</div>
<ul class="simple">
<li><p>Fe-Mg interaction on the M1 site, the joins Mg2Si2O6 - MgFeSi2O6 or
Fe2Si2O6 - FeMgSi2O6 or CaMgSi2O6 - CaFeSi2O6, which are assumed to
be energetically equivalent, denoted WM1FeMg (in Sack and Ghiorso,
1994, <span class="math notranslate nohighlight">\(W_{12}\)</span></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WhM1FeMg</span><span class="p">,</span><span class="n">WvM1FeMg</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;WhM1FeMg WvM1FeMg&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WhM1FeMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WhM1FeMg</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WvM1FeMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WvM1FeMg</span><span class="p">)</span>
<span class="n">WM1FeMg</span> <span class="o">=</span> <span class="n">WhM1FeMg</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">WvM1FeMg</span>
<span class="n">eqn9</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_regular_param</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">WM1FeMg</span>
<span class="n">eqn9</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - Grr_{11} - P WvM1FeMg - WhM1FeMg\]</div>
<ul class="simple">
<li><p>Fe-Mg interaction on the M2 site, the joins FeMgSi2O6 - Mg2Si2O6 or
Fe2Si2O6 - MgFeSi2O6, which are assumed to be energetically
equivalent, denoted WM2FeMg</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WhM2FeMg</span><span class="p">,</span><span class="n">WvM2FeMg</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;WhM2FeMg WvM2FeMg&#39;</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WhM2FeMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WhM2FeMg</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;WvM2FeMg&#39;</span><span class="p">)</span>
<span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">symparams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WvM2FeMg</span><span class="p">)</span>
<span class="n">WM2FeMg</span> <span class="o">=</span> <span class="n">WhM2FeMg</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">WvM2FeMg</span>
<span class="n">eqn10</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_regular_param</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span><span class="p">)</span> <span class="o">-</span> <span class="n">WM2FeMg</span>
<span class="n">eqn10</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - Grr_{11} - 2 Grs_{11} - 4 Gss_{11} - P WvM2FeMg - WhM2FeMg\]</div>
</div>
<div class="section" id="solve-for-the-taylor-coefficients-in-terms-of-the-preferred-parameters">
<h3>Solve for the Taylor coefficients in terms of the preferred parameters<a class="headerlink" href="#solve-for-the-taylor-coefficients-in-terms-of-the-preferred-parameters" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="p">[</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">,</span> <span class="n">eqn7</span><span class="p">,</span> <span class="n">eqn8</span><span class="p">,</span> <span class="n">eqn9</span><span class="p">,</span> <span class="n">eqn10</span><span class="p">]</span>
<span class="n">system</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \left[ G_{0} - \mu_{1}{\left(T,P \right)}, \  G_{0} + Gr_{1} + Grr_{11} - \mu_{2}{\left(T,P \right)}, \  G_{0} + Gr_{2} + Grr_{22} - Grs_{21} - Gs_{1} + Gss_{11} - \mu_{3}{\left(T,P \right)}, \  - Fh + Fs T - Fv P + 2 Grr_{11} + 2 Grr_{12} + 2 Grs_{11} + 2 Grs_{21} + 2 Gs_{1}, \  2 Grs_{11} + 2 Grs_{21} + 2 Gs_{1} - Hex - P Vex, \  - 2 Grr_{11} - 2 Grs_{11} - Hx - P Vx, \  - Grr_{22} + Grs_{21} - Gss_{11} - P WvM2CaMg - WhM2CaMg, \  - Grr_{11} - Grr_{12} - Grr_{22} - Grs_{11} - Grs_{21} - Gss_{11} - P WvM2CaFe - WhM2CFe, \  - Grr_{11} - P WvM1FeMg - WhM1FeMg, \  - Grr_{11} - 2 Grs_{11} - 4 Gss_{11} - P WvM2FeMg - WhM2FeMg\right]\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taylor_soln</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">linsolve</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">taylor_coeff</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">taylor_soln</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \left( \mu_{1}{\left(T,P \right)}, \  P WvM1FeMg + WhM1FeMg - \mu_{1}{\left(T,P \right)} + \mu_{2}{\left(T,P \right)}, \  \frac{Fh}{4} - \frac{Fs T}{4} + \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} + \frac{P WvM2CaFe}{2} + \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} + \frac{WhM2CFe}{2} + \frac{WhM2CaMg}{2} - \mu_{1}{\left(T,P \right)} + \mu_{3}{\left(T,P \right)}, \  \frac{Fh}{4} - \frac{Fs T}{4} + \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} + \frac{P WvM2CaFe}{2} - \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} + \frac{WhM2CFe}{2} - \frac{WhM2CaMg}{2}, \  - P WvM1FeMg - WhM1FeMg, \  \frac{Fh}{2} - \frac{Fs T}{2} + \frac{Fv P}{2} - \frac{Hex}{2} - \frac{P Vex}{2} + P WvM1FeMg + WhM1FeMg, \  - \frac{Hx}{2} - \frac{P Vx}{2} + P WvM1FeMg + WhM1FeMg, \  - \frac{Fh}{4} + \frac{Fs T}{4} - \frac{Fv P}{4} + \frac{Hex}{4} + \frac{P Vex}{4} - \frac{P WvM1FeMg}{4} - \frac{P WvM2CaFe}{2} - \frac{P WvM2CaMg}{2} + \frac{P WvM2FeMg}{4} - \frac{WhM1FeMg}{4} - \frac{WhM2CFe}{2} - \frac{WhM2CaMg}{2} + \frac{WhM2FeMg}{4}, \  - \frac{Fh}{4} + \frac{Fs T}{4} - \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} - \frac{P WvM2CaFe}{2} + \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} - \frac{WhM2CFe}{2} + \frac{WhM2CaMg}{2}, \  \frac{Hx}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{4} - \frac{P WvM2FeMg}{4} - \frac{WhM1FeMg}{4} - \frac{WhM2FeMg}{4}\right)\]</div>
</div>
<div class="section" id="substitute-terms-into-hat-g">
<h3>Substitute terms into <span class="math notranslate nohighlight">\(\hat G^*\)</span><a class="headerlink" href="#substitute-terms-into-hat-g" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">taylor_coeff</span><span class="p">,</span><span class="n">taylor_soln</span><span class="p">):</span>
    <span class="n">sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">G_star_molar</span> <span class="o">=</span> <span class="n">taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">symparams</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Fh&#39;</span><span class="p">,</span> <span class="s1">&#39;Fs&#39;</span><span class="p">,</span> <span class="s1">&#39;Fv&#39;</span><span class="p">,</span> <span class="s1">&#39;Hex&#39;</span><span class="p">,</span> <span class="s1">&#39;Vex&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2CaMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2CaMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2CaFe&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2CaFe&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM1FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM1FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2FeMg&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="n">Fh</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">Fv</span><span class="p">,</span> <span class="n">Hex</span><span class="p">,</span> <span class="n">Vex</span><span class="p">,</span> <span class="n">Hx</span><span class="p">,</span> <span class="n">Vx</span><span class="p">,</span> <span class="n">WhM2CaMg</span><span class="p">,</span> <span class="n">WvM2CaMg</span><span class="p">,</span> <span class="n">WhM2CFe</span><span class="p">,</span> <span class="n">WvM2CaFe</span><span class="p">,</span> <span class="n">WhM1FeMg</span><span class="p">,</span> <span class="n">WvM1FeMg</span><span class="p">,</span> <span class="n">WhM2FeMg</span><span class="p">,</span> <span class="n">WvM2FeMg</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="define-the-gibbs-free-energy-of-solution">
<h2>Define the Gibbs free energy of solution<a class="headerlink" href="#define-the-gibbs-free-energy-of-solution" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">G_config</span> <span class="o">+</span> <span class="n">nT</span><span class="o">*</span><span class="n">G_star_molar</span>
<span class="n">G</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - R T \left(n_{1} + n_{2} + n_{3}\right) \left(- \left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1\right) \log{\left(- \frac{n_{3}}{n_{1} + n_{2} + n_{3}} + 1 \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2}\right) \log{\left(\frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} \right)} - \left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2}\right) \log{\left(\frac{n_{2}}{n_{1} + n_{2} + n_{3}} - \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} - \frac{s_{1}}{2} \right)} - \left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1\right) \log{\left(- \frac{n_{2}}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}}{2 \left(n_{1} + n_{2} + n_{3}\right)} + \frac{s_{1}}{2} + 1 \right)}\right) + \left(n_{1} + n_{2} + n_{3}\right) \left(\frac{n_{2}^{2} \left(- P WvM1FeMg - WhM1FeMg\right)}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{n_{2} n_{3} \left(\frac{Fh}{2} - \frac{Fs T}{2} + \frac{Fv P}{2} - \frac{Hex}{2} - \frac{P Vex}{2} + P WvM1FeMg + WhM1FeMg\right)}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{n_{2} s_{1} \left(- \frac{Hx}{2} - \frac{P Vx}{2} + P WvM1FeMg + WhM1FeMg\right)}{n_{1} + n_{2} + n_{3}} + \frac{n_{2} \left(P WvM1FeMg + WhM1FeMg - \mu_{1}{\left(T,P \right)} + \mu_{2}{\left(T,P \right)}\right)}{n_{1} + n_{2} + n_{3}} + \frac{n_{3}^{2} \left(- \frac{Fh}{4} + \frac{Fs T}{4} - \frac{Fv P}{4} + \frac{Hex}{4} + \frac{P Vex}{4} - \frac{P WvM1FeMg}{4} - \frac{P WvM2CaFe}{2} - \frac{P WvM2CaMg}{2} + \frac{P WvM2FeMg}{4} - \frac{WhM1FeMg}{4} - \frac{WhM2CFe}{2} - \frac{WhM2CaMg}{2} + \frac{WhM2FeMg}{4}\right)}{\left(n_{1} + n_{2} + n_{3}\right)^{2}} + \frac{n_{3} s_{1} \left(- \frac{Fh}{4} + \frac{Fs T}{4} - \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} - \frac{P WvM2CaFe}{2} + \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} - \frac{WhM2CFe}{2} + \frac{WhM2CaMg}{2}\right)}{n_{1} + n_{2} + n_{3}} + \frac{n_{3} \left(\frac{Fh}{4} - \frac{Fs T}{4} + \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} + \frac{P WvM2CaFe}{2} + \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} + \frac{WhM2CFe}{2} + \frac{WhM2CaMg}{2} - \mu_{1}{\left(T,P \right)} + \mu_{3}{\left(T,P \right)}\right)}{n_{1} + n_{2} + n_{3}} + s_{1}^{2} \left(\frac{Hx}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{4} - \frac{P WvM2FeMg}{4} - \frac{WhM1FeMg}{4} - \frac{WhM2FeMg}{4}\right) + s_{1} \left(\frac{Fh}{4} - \frac{Fs T}{4} + \frac{Fv P}{4} + \frac{Hex}{4} + \frac{Hx}{4} + \frac{P Vex}{4} + \frac{P Vx}{4} - \frac{P WvM1FeMg}{2} + \frac{P WvM2CaFe}{2} - \frac{P WvM2CaMg}{2} - \frac{WhM1FeMg}{2} + \frac{WhM2CFe}{2} - \frac{WhM2CaMg}{2}\right) + \mu_{1}{\left(T,P \right)}\right)\]</div>
</div>
<div class="section" id="find-the-condition-of-homogeneous-equilibrium">
<h2>Find the condition of homogeneous equilibrium:<a class="headerlink" href="#find-the-condition-of-homogeneous-equilibrium" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\frac{{\partial \hat G*}}{{\partial {s_1}}} = 0\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dgds</span> <span class="o">=</span> <span class="p">(</span><span class="n">nT</span><span class="o">*</span><span class="n">G_star_molar</span><span class="o">+</span><span class="n">G_config</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">dgds</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle - \frac{R T \left(n_{1} + n_{2} + n_{3}\right) \left(\log{\left(\frac{n_{3} - s_{1} \left(n_{1} + n_{2} + n_{3}\right)}{n_{1} + n_{2} + n_{3}} \right)} - \log{\left(\frac{n_{3} + s_{1} \left(n_{1} + n_{2} + n_{3}\right)}{n_{1} + n_{2} + n_{3}} \right)} + \log{\left(- \frac{- 2 n_{2} + n_{3} + s_{1} \left(n_{1} + n_{2} + n_{3}\right)}{n_{1} + n_{2} + n_{3}} \right)} - \log{\left(\frac{- 2 n_{2} + n_{3} + \left(s_{1} + 2\right) \left(n_{1} + n_{2} + n_{3}\right)}{n_{1} + n_{2} + n_{3}} \right)}\right)}{2} - \frac{n_{2} \left(Hx + P Vx - 2 P WvM1FeMg - 2 WhM1FeMg\right)}{2} + \frac{n_{3} \left(- Fh + Fs T - Fv P + Hex + Hx + P Vex + P Vx - 2 P WvM1FeMg - 2 P WvM2CaFe + 2 P WvM2CaMg - 2 WhM1FeMg - 2 WhM2CFe + 2 WhM2CaMg\right)}{4} + \frac{\left(n_{1} + n_{2} + n_{3}\right) \left(Fh - Fs T + Fv P + Hex + Hx + P Vex + P Vx - 2 P WvM1FeMg + 2 P WvM2CaFe - 2 P WvM2CaMg - 2 WhM1FeMg + 2 WhM2CFe - 2 WhM2CaMg - 2 s_{1} \left(- Hx - P Vx + P WvM1FeMg + P WvM2FeMg + WhM1FeMg + WhM2FeMg\right)\right)}{4}\]</div>
</div>
<div class="section" id="identify-bounds-on-the-ordering-parameter">
<h2>Identify bounds on the ordering parameter<a class="headerlink" href="#identify-bounds-on-the-ordering-parameter" title="Permalink to this headline">¶</a></h2>
<p>The code generated to implement this model must compute numerical values
of the ordering parameter as a functrion of compositrion, temperature
and pressure. This task requires an iterative procedure. To construct
this procedure the model must have information on the permissble domain
of the ordering parameter.</p>
<p>Values of the ordering parameter are bounded by the composition of the
solution. We contrain all site mole fractions to have values in the
range 0 to 1, and solve this system of inequality constraints to obtain
a logical expression that embodies the feasible domain for the numerical
procedure.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">reduce_inequalities</span><span class="p">(</span><span class="n">inequalities</span><span class="o">=</span><span class="p">[</span>
    <span class="mi">0</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">out</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle s_{1} \geq - \frac{2 n_{3}}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \geq \frac{2 \left(- 2 n_{1} - 3 n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \geq - \frac{2 \left(2 n_{1} + 3 n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \geq \frac{2 \left(- 2 n_{1} - 2 n_{2} - n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \leq \frac{2 n_{3}}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \leq - \frac{2 \left(- 2 n_{2} + n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \leq \frac{2 \left(2 n_{2} - n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}} \wedge s_{1} \leq - \frac{2 \left(- 2 n_{1} - 2 n_{2} - n_{3}\right)}{2 n_{1} + 2 n_{2} + 2 n_{3}}\]</div>
</div>
<div class="section" id="add-the-gibbs-free-energy-of-solution-to-the-model">
<h2>Add the Gibbs free energy of solution to the model<a class="headerlink" href="#add-the-gibbs-free-energy-of-solution-to-the-model" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add_expression_to_model</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">symparams</span><span class="p">)),</span> <span class="n">ordering_functions</span><span class="o">=</span><span class="p">([</span><span class="n">dgds</span><span class="p">],</span><span class="n">s</span><span class="p">,[</span><span class="mi">0</span><span class="p">],</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
<p>… give the model a unqiue name</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="s2">&quot;Complex_Solution&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">… assign a formula string for code generation</div>
<div class="line">… assign a conversion string to map element concentrations to moles of
end members … assign a test string to evaluate the feasibility of
input compositions</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">formula_string</span> <span class="o">=</span> <span class="s1">&#39;Ca[Ca]Mg[Mg]Fe[Fe]Si[Si]O6&#39;</span>
<span class="n">model</span><span class="o">.</span><span class="n">conversion_string</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[0]=[Ca]-[Fe]&#39;</span><span class="p">,</span> <span class="s1">&#39;[1]=[Fe]&#39;</span><span class="p">,</span> <span class="s1">&#39;[2]=([Mg]-[Ca])/2.0&#39;</span><span class="p">]</span>
<span class="n">model</span><span class="o">.</span><span class="n">test_string</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[0]+[1] &gt; 0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;[1] &gt; 0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;[0]+2.0*[2] &gt; 0.0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="define-parameters-of-an-orthopyroxene-solution">
<h1>Define Parameters of an Orthopyroxene Solution<a class="headerlink" href="#define-parameters-of-an-orthopyroxene-solution" title="Permalink to this headline">¶</a></h1>
<p>Components 1. diopside, CaMgSi2O6 2. hedenbergite, CaFeSi2O6 3.
enstatite, Mg2Si2O6</p>
<p>Original calibration from Sack and Ghiorso (Contributions to Mineralogy
and Petrology, 116:287-300, 1994):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">13807</span> <span class="o">+</span> <span class="mf">2.319</span><span class="o">*</span><span class="n">T</span> <span class="o">-</span> <span class="mf">0.05878</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">Gex</span>     <span class="o">=</span>  <span class="o">-</span><span class="mi">7824</span>           <span class="o">-</span> <span class="mf">0.1213</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>   <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">K</span>   <span class="o">*/</span>
<span class="n">Gx</span>      <span class="o">=</span>  <span class="o">-</span><span class="mi">1883</span>           <span class="o">+</span> <span class="mf">0.02824</span><span class="p">;</span>    <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
<span class="n">WM2CaMg</span> <span class="o">=</span>  <span class="mi">31631</span>           <span class="o">+</span> <span class="mf">0.03347</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
<span class="n">WM2CaFe</span> <span class="o">=</span>  <span class="mi">17238</span>           <span class="o">+</span> <span class="mf">0.04602</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">K</span>   <span class="o">*/</span>
<span class="n">WM1FeMg</span> <span class="o">=</span>   <span class="mi">8368</span>           <span class="o">+</span> <span class="mf">0.01412</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span><span class="o">/</span><span class="n">bar</span> <span class="o">*/</span>
<span class="n">WM2FeMg</span> <span class="o">=</span>   <span class="mi">8368</span>           <span class="o">+</span> <span class="mf">0.01412</span><span class="o">*</span><span class="n">P</span><span class="p">;</span>  <span class="o">/*</span> <span class="n">joules</span>     <span class="o">*/</span>
</pre></div>
</div>
<p>Asymmetry along the Ca-Mg and Ca-Fe joins (considered by Sack and
Ghiorso, 1994) is not considered in this example in order to simplify
the presentation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">paramValues</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Fh&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">13807.0</span><span class="p">,</span> <span class="s1">&#39;Fs&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">2.319</span><span class="p">,</span> <span class="s1">&#39;Fv&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.05878</span><span class="p">,</span> \
               <span class="s1">&#39;Hex&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">7824.0</span><span class="p">,</span> <span class="s1">&#39;Vex&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">0.1213</span><span class="p">,</span> \
               <span class="s1">&#39;Hx&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">1883.0</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">:</span><span class="mf">0.02824</span><span class="p">,</span> \
               <span class="s1">&#39;WhM2CaMg&#39;</span><span class="p">:</span><span class="mf">31631.0</span><span class="p">,</span> <span class="s1">&#39;WvM2CaMg&#39;</span><span class="p">:</span><span class="mf">0.03347</span><span class="p">,</span> \
               <span class="s1">&#39;WhM2CaFe&#39;</span><span class="p">:</span><span class="mf">17238.0</span><span class="p">,</span> <span class="s1">&#39;WvM2CaFe&#39;</span><span class="p">:</span><span class="mf">0.04602</span><span class="p">,</span> \
               <span class="s1">&#39;WhM1FeMg&#39;</span><span class="p">:</span><span class="mf">8368.0</span><span class="p">,</span> <span class="s1">&#39;WvM1FeMg&#39;</span><span class="p">:</span><span class="mf">0.01412</span><span class="p">,</span> \
               <span class="s1">&#39;WhM2FeMg&#39;</span><span class="p">:</span><span class="mf">8368.0</span><span class="p">,</span> <span class="s1">&#39;WvM2FeMg&#39;</span><span class="p">:</span><span class="mf">0.01412</span><span class="p">,</span> \
               <span class="s1">&#39;T_r&#39;</span><span class="p">:</span><span class="mf">298.15</span><span class="p">,</span> <span class="s1">&#39;P_r&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">paramValues</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Fh&#39;</span><span class="p">,</span> <span class="s1">&#39;Fs&#39;</span><span class="p">,</span> <span class="s1">&#39;Fv&#39;</span><span class="p">,</span> <span class="s1">&#39;Hex&#39;</span><span class="p">,</span> <span class="s1">&#39;Vex&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2CaMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2CaMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2CaFe&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2CaFe&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM1FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM1FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WhM2FeMg&#39;</span><span class="p">,</span> <span class="s1">&#39;WvM2FeMg&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="s1">&#39;Fh&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">13807.0</span><span class="p">,</span> <span class="s1">&#39;Fs&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.319</span><span class="p">,</span> <span class="s1">&#39;Fv&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.05878</span><span class="p">,</span> <span class="s1">&#39;Hex&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">7824.0</span><span class="p">,</span> <span class="s1">&#39;Vex&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.1213</span><span class="p">,</span> <span class="s1">&#39;Hx&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1883.0</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">:</span> <span class="mf">0.02824</span><span class="p">,</span> <span class="s1">&#39;WhM2CaMg&#39;</span><span class="p">:</span> <span class="mf">31631.0</span><span class="p">,</span> <span class="s1">&#39;WvM2CaMg&#39;</span><span class="p">:</span> <span class="mf">0.03347</span><span class="p">,</span> <span class="s1">&#39;WhM2CaFe&#39;</span><span class="p">:</span> <span class="mf">17238.0</span><span class="p">,</span> <span class="s1">&#39;WvM2CaFe&#39;</span><span class="p">:</span> <span class="mf">0.04602</span><span class="p">,</span> <span class="s1">&#39;WhM1FeMg&#39;</span><span class="p">:</span> <span class="mf">8368.0</span><span class="p">,</span> <span class="s1">&#39;WvM1FeMg&#39;</span><span class="p">:</span> <span class="mf">0.01412</span><span class="p">,</span> <span class="s1">&#39;WhM2FeMg&#39;</span><span class="p">:</span> <span class="mf">8368.0</span><span class="p">,</span> <span class="s1">&#39;WvM2FeMg&#39;</span><span class="p">:</span> <span class="mf">0.01412</span><span class="p">,</span> <span class="s1">&#39;T_r&#39;</span><span class="p">:</span> <span class="mf">298.15</span><span class="p">,</span> <span class="s1">&#39;P_r&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>
</div>
<p>Generate both fast computation and calibibration code for the feldspar
solution</p>
</div>
<div class="section" id="use-code-printers-to-construct-c-package-code">
<h1>Use code printers to construct “C” package code<a class="headerlink" href="#use-code-printers-to-construct-c-package-code" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_working_dir</span> <span class="o">=</span> <span class="s2">&quot;working&quot;</span>
<span class="o">!</span>mkdir -p <span class="o">{</span>model_working_dir<span class="o">}</span>
<span class="o">%</span><span class="k">cd</span> {model_working_dir}
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span><span class="o">/</span><span class="n">working</span>
</pre></div>
</div>
<div class="section" id="choose-model-type-and-create-model">
<h2>Choose model type and create model<a class="headerlink" href="#choose-model-type-and-create-model" title="Permalink to this headline">¶</a></h2>
<p>model_type is “fast” or “calib”</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_type</span> <span class="o">=</span> <span class="s2">&quot;calib&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">create_code_module</span><span class="p">(</span><span class="n">phase</span><span class="o">=</span><span class="s2">&quot;Orthopyroxene&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">paramValues</span><span class="p">,</span>
                         <span class="n">endmembers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Diopside_berman&#39;</span><span class="p">,</span> <span class="s1">&#39;Hedenbergite_berman&#39;</span><span class="p">,</span> <span class="s1">&#39;Enstatite_berman&#39;</span><span class="p">],</span>
                         <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="n">module_type</span><span class="o">=</span><span class="n">model_type</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">add_code_to_access_order_paramater</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Creating generic fast model code file string
.Writing include file to working directory ...
Creating (once only) generic model calib codetemplate include file string
Creating (once only) generic model calib codetemplate code file string
Creating generic calib model code file string
Writing include file to working directory ...
Creating code blocks for standard state properties.
Creating calib code and include files ...
Writing include file to working directory ...
Writing code file to working directory ...
... done
Writing pyxbld file to working directory ...
writing pyx file to working directory ...
Compiling code and Python bindings ...
Success! Import the module named  Complex_Solution
Generating additional methods for order parameter access.
Done!
</pre></div>
</div>
</div>
<div class="section" id="load-the-module">
<h2>Load the module<a class="headerlink" href="#load-the-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">Complex_Solution</span>
<span class="o">%</span><span class="k">cd</span> ..
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/Users/ghiorso/anaconda3/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive &#39;language_level&#39; not set, using 2 for now (Py2). This will change in a later release! File: /Users/ghiorso/Documents/ARCHIVE_XCODE/ThermoEngine/Notebooks/Codegen/working/Complex_Solution.pyx
  tree = Parsing.p_module(s, pxd, full_module_name)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span>
</pre></div>
</div>
</div>
<div class="section" id="test-and-time-the-generated-functions-for-orthopyroxene-t-in-k-p-in-bars">
<h2>Test and time the generated functions for Orthopyroxene (T in K, P in bars)<a class="headerlink" href="#test-and-time-the-generated-functions-for-orthopyroxene-t-in-k-p-in-bars" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mf">2000.00</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="available-in-both-fast-and-calib-code-versions">
<h2>Available in both “Fast” and “Calib” code versions<a class="headerlink" href="#available-in-both-fast-and-calib-code-versions" title="Permalink to this headline">¶</a></h2>
<p>Execute the “fast” or “calibration” code metadata retrieval functions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_identifier</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_name</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_formula</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_identifier</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_name</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_formula</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span> <span class="n">Sep</span> <span class="mi">23</span> <span class="mi">09</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">22</span> <span class="mi">2020</span>
<span class="n">Orthopyroxene</span>
<span class="n">Ca0</span><span class="o">.</span><span class="mi">639</span><span class="n">Mg1</span><span class="o">.</span><span class="mi">028</span><span class="n">Fe0</span><span class="o">.</span><span class="mi">333</span><span class="n">Si2</span><span class="o">.</span><span class="mi">000</span><span class="n">O6</span>
</pre></div>
</div>
<p>Test intrinsic element conversion routine …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_elements</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">106</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span>
    <span class="n">nConv</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_elm_to_moles</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;X[</span><span class="si">{0:d}</span><span class="s1">] input </span><span class="si">{1:13.6e}</span><span class="s1">, calc </span><span class="si">{2:13.6e}</span><span class="s1">, diff </span><span class="si">{3:13.6e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">,</span> <span class="n">nConv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nConv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_test_moles</span><span class="p">(</span><span class="n">nConv</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Output of intrinsic composition calculation fails tests for permissible values.&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_elements</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">106</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span>
    <span class="n">nConv</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_elm_to_moles</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;X[</span><span class="si">{0:d}</span><span class="s1">] input </span><span class="si">{1:13.6e}</span><span class="s1">, calc </span><span class="si">{2:13.6e}</span><span class="s1">, diff </span><span class="si">{3:13.6e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">,</span> <span class="n">nConv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nConv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_test_moles</span><span class="p">(</span><span class="n">nConv</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Output of intrinsic composition calculation fails tests for permissible values.&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="nb">input</span>  <span class="mf">3.055556e-01</span><span class="p">,</span> <span class="n">calc</span>  <span class="mf">3.055556e-01</span><span class="p">,</span> <span class="n">diff</span>  <span class="mf">5.551115e-17</span>
<span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="nb">input</span>  <span class="mf">3.333333e-01</span><span class="p">,</span> <span class="n">calc</span>  <span class="mf">3.333333e-01</span><span class="p">,</span> <span class="n">diff</span>  <span class="mf">0.000000e+00</span>
<span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="nb">input</span>  <span class="mf">3.611111e-01</span><span class="p">,</span> <span class="n">calc</span>  <span class="mf">1.944444e-01</span><span class="p">,</span> <span class="n">diff</span> <span class="o">-</span><span class="mf">1.666667e-01</span>
</pre></div>
</div>
<p>Test various conversion routines …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_moles_to_tot_moles</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_moles_to_mole_frac</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_moles_to_elm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_elm_to_moles</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_elm_to_tot_moles</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_conv_elm_to_tot_grams</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_moles_to_tot_moles</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_moles_to_mole_frac</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_moles_to_elm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_elm_to_moles</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_elm_to_tot_moles</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_conv_elm_to_tot_grams</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">3.5999999999999996</span>
<span class="p">[</span><span class="mf">0.30555556</span> <span class="mf">0.33333333</span> <span class="mf">0.36111111</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>  <span class="mf">21.6</span>  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">3.7</span>  <span class="mf">0.</span>
  <span class="mf">7.2</span>  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">2.3</span>  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">1.2</span>  <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>
  <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span> <span class="p">]</span>
<span class="p">[</span><span class="mf">1.1</span> <span class="mf">1.2</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="mf">3.0</span>
<span class="mf">676.4650999999999</span>
</pre></div>
</div>
<div class="section" id="execute-a-method-that-retrieves-the-ordering-parameter">
<h3>Execute a method that retrieves the ordering parameter<a class="headerlink" href="#execute-a-method-that-retrieves-the-ordering-parameter" title="Permalink to this headline">¶</a></h3>
<p>This method is normally hidden from the Phases module implementation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_formula</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">nn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kd = (XFeM1 XMgM2)/(XFeM2 XMgM1), s = XFeM2 - XMgM2&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">600.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1200.0</span><span class="p">,</span> <span class="mf">1400.0</span><span class="p">,</span> <span class="mf">1600.0</span><span class="p">,</span> <span class="mf">1800.0</span><span class="p">,</span> <span class="mf">2000.0</span><span class="p">]:</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_order_params</span><span class="p">(</span><span class="n">tc</span><span class="o">+</span><span class="mf">273.15</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">nn</span><span class="p">)</span>
    <span class="n">vCaM2</span> <span class="o">=</span> <span class="n">xCaM2</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="n">vMgM2</span> <span class="o">=</span> <span class="n">xMgM2</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="n">vFeM2</span> <span class="o">=</span> <span class="n">xFeM2</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="n">vMgM1</span> <span class="o">=</span> <span class="n">xMgM1</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="n">vFeM1</span> <span class="o">=</span> <span class="n">xFeM1</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),(</span><span class="n">model</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">nn</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">vFeM1</span><span class="o">*</span><span class="n">vMgM2</span><span class="o">/</span><span class="p">(</span><span class="n">vMgM1</span><span class="o">*</span><span class="n">vFeM2</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;T </span><span class="si">{0:8.2f}</span><span class="s2">  s </span><span class="si">{1:8.4f}</span><span class="s2">  RT ln(Kd) </span><span class="si">{2:10.3f}</span><span class="s2"> kJ&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">8.3143</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span><span class="o">+</span><span class="mf">273.15</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="p">))</span><span class="o">/</span><span class="mf">1000.0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ca0</span><span class="o">.</span><span class="mi">010</span><span class="n">Mg1</span><span class="o">.</span><span class="mi">000</span><span class="n">Fe0</span><span class="o">.</span><span class="mi">990</span><span class="n">Si2</span><span class="o">.</span><span class="mi">000</span><span class="n">O6</span>
<span class="n">Kd</span> <span class="o">=</span> <span class="p">(</span><span class="n">XFeM1</span> <span class="n">XMgM2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">XFeM2</span> <span class="n">XMgM1</span><span class="p">),</span> <span class="n">s</span> <span class="o">=</span> <span class="n">XFeM2</span> <span class="o">-</span> <span class="n">XMgM2</span>
<span class="n">T</span>   <span class="mf">600.00</span>  <span class="n">s</span>   <span class="mf">0.5516</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">18.350</span> <span class="n">kJ</span>
<span class="n">T</span>   <span class="mf">900.00</span>  <span class="n">s</span>   <span class="mf">0.3513</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">14.616</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">1000.00</span>  <span class="n">s</span>   <span class="mf">0.3089</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">13.825</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">1200.00</span>  <span class="n">s</span>   <span class="mf">0.2467</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">12.665</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">1400.00</span>  <span class="n">s</span>   <span class="mf">0.2042</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">11.871</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">1600.00</span>  <span class="n">s</span>   <span class="mf">0.1736</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">11.299</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">1800.00</span>  <span class="n">s</span>   <span class="mf">0.1507</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">10.870</span> <span class="n">kJ</span>
<span class="n">T</span>  <span class="mf">2000.00</span>  <span class="n">s</span>   <span class="mf">0.1329</span>  <span class="n">RT</span> <span class="n">ln</span><span class="p">(</span><span class="n">Kd</span><span class="p">)</span>    <span class="o">-</span><span class="mf">10.536</span> <span class="n">kJ</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-the-standard-thermodynamic-property-retrieval-functions">
<h3>Execute the standard thermodynamic property retrieval functions:<a class="headerlink" href="#execute-the-standard-thermodynamic-property-retrieval-functions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:&lt;10.10s}</span><span class="s2">&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dgdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dgdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_v</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Cv&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_cv</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dCpdT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dcpdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_alpha</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;1/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_beta</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;1/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_K</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Kp&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_Kp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_dgdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_dgdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_v</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Cv&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_cv</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dCpdT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_dcpdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_alpha</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;1/K&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_beta</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;1/bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_K</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;bar&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Kp&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_Kp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">G</span>          <span class="o">-</span><span class="mf">1.376489e+07</span> <span class="n">J</span>
<span class="n">dGdT</span>       <span class="o">-</span><span class="mf">2.178302e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span>
<span class="n">dGdP</span>        <span class="mf">2.533452e+01</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span>
<span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">4.926731e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span>
<span class="n">d2GdTdP</span>     <span class="mf">1.323450e-03</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span>
<span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">2.071512e-05</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span>
<span class="n">d3GdT3</span>      <span class="mf">2.271906e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d3GdT2dP</span>    <span class="mf">3.633866e-07</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span>
<span class="n">d3GdTdP2</span>    <span class="mf">5.963507e-11</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span>
<span class="n">d3GdP3</span>      <span class="mf">5.644345e-11</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span>
<span class="n">S</span>           <span class="mf">2.178302e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span>
<span class="n">V</span>           <span class="mf">2.533452e+01</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span>
<span class="n">Cv</span>          <span class="mf">8.162407e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span>
<span class="n">Cp</span>          <span class="mf">9.853461e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span>
<span class="n">dCpdT</span>       <span class="mf">3.829190e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span>
<span class="n">alpha</span>       <span class="mf">5.223899e-05</span> <span class="mi">1</span><span class="o">/</span><span class="n">K</span>
<span class="n">beta</span>        <span class="mf">8.176639e-07</span> <span class="mi">1</span><span class="o">/</span><span class="n">bar</span>
<span class="n">K</span>           <span class="mf">1.222996e+06</span> <span class="n">bar</span>
<span class="n">Kp</span>          <span class="mf">2.332355e+00</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-functions-that-access-endmember-properties">
<h3>Execute functions that access endmember properties:<a class="headerlink" href="#execute-functions-that-access-endmember-properties" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:&lt;15.15s}</span><span class="s2">&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;number of components&quot;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_number</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_name</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_formula</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;mw: </span><span class="si">{0:10.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_mw</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;mu0&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_mu0</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dmu0dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_dmu0dT</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dmu0dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_dmu0dP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d2mu0dT2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d2mu0dTdP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d2mu0dP2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d3mu0dT3</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^3-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d3mu0dT2dP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d3mu0dTdP2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_d3mu0dP3</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Element array:&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_endmember_elements</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">()</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;number of components&quot;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_number</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_name</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_formula</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;mw: </span><span class="si">{0:10.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_mw</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;mu0&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_mu0</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dmu0dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_dmu0dT</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dmu0dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_dmu0dP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d2mu0dT2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d2mu0dTdP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2mu0dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d2mu0dP2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d3mu0dT3</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^3-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d3mu0dT2dP</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d3mu0dTdP2</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3mu0dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_d3mu0dP3</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-mol&#39;</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Element array:&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_endmember_elements</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">()</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span> <span class="n">of</span> <span class="n">components</span> <span class="mi">3</span>
<span class="n">Diopside</span>             <span class="n">MgCaSi2O6</span>            <span class="n">mw</span><span class="p">:</span>     <span class="mf">216.55</span>
<span class="n">mu0</span>        <span class="o">-</span><span class="mf">3.947955e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">dmu0dT</span>     <span class="o">-</span><span class="mf">5.818145e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">dmu0dP</span>      <span class="mf">7.092442e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dT2</span>   <span class="o">-</span><span class="mf">1.339235e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dTdP</span>   <span class="mf">3.712074e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dP2</span>   <span class="o">-</span><span class="mf">5.772640e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT3</span>    <span class="mf">6.166661e-05</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT2dP</span>  <span class="mf">1.100006e-07</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dTdP2</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dP3</span>    <span class="mf">2.260068e-11</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>

<span class="n">Hedenbergite</span>         <span class="n">CaFeSi2O6</span>            <span class="n">mw</span><span class="p">:</span>     <span class="mf">248.09</span>
<span class="n">mu0</span>        <span class="o">-</span><span class="mf">3.660551e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">dmu0dT</span>     <span class="o">-</span><span class="mf">6.198971e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">dmu0dP</span>      <span class="mf">7.316411e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dT2</span>   <span class="o">-</span><span class="mf">1.352710e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dTdP</span>   <span class="mf">4.063486e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dP2</span>   <span class="o">-</span><span class="mf">6.738479e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT3</span>    <span class="mf">6.238454e-05</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT2dP</span>  <span class="mf">1.136165e-07</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dTdP2</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dP3</span>    <span class="mf">2.014415e-11</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>

<span class="n">Enstatite</span>            <span class="n">Mg2Si2O6</span>             <span class="n">mw</span><span class="p">:</span>     <span class="mf">200.78</span>
<span class="n">mu0</span>        <span class="o">-</span><span class="mf">3.821935e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">dmu0dT</span>     <span class="o">-</span><span class="mf">5.805518e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">dmu0dP</span>      <span class="mf">6.730275e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dT2</span>   <span class="o">-</span><span class="mf">1.392010e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dTdP</span>   <span class="mf">3.168470e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d2mu0dP2</span>   <span class="o">-</span><span class="mf">4.739597e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT3</span>    <span class="mf">6.237364e-05</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dT2dP</span>  <span class="mf">9.450086e-08</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dTdP2</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3mu0dP3</span>    <span class="mf">5.657143e-12</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-functions-that-access-species-properties">
<h3>Execute functions that access species properties:<a class="headerlink" href="#execute-functions-that-access-species-properties" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:&lt;15.15s}</span><span class="s2">&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;number of species&quot;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_species_number</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_species_name</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_species_formula</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;mw: </span><span class="si">{0:10.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_species_mw</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Element array:&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_species_elements</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">()</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;number of species&quot;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_species_number</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_species_name</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;20.20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_species_formula</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;mw: </span><span class="si">{0:10.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_species_mw</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Element array:&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_species_elements</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">()</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span> <span class="n">of</span> <span class="n">species</span> <span class="mi">3</span>
<span class="n">Diopside</span>             <span class="n">MgCaSi2O6</span>            <span class="n">mw</span><span class="p">:</span>     <span class="mf">216.55</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>

<span class="n">Hedenbergite</span>         <span class="n">CaFeSi2O6</span>            <span class="n">mw</span><span class="p">:</span>     <span class="mf">248.09</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>

<span class="n">Enstatite</span>            <span class="n">Mg2Si2O6</span>             <span class="n">mw</span><span class="p">:</span>     <span class="mf">200.78</span>
<span class="n">Element</span> <span class="n">array</span><span class="p">:</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">6.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">2.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-functions-for-molar-derivatives">
<h3>Execute functions for molar derivatives<a class="headerlink" href="#execute-functions-for-molar-derivatives" title="Permalink to this headline">¶</a></h3>
<div class="section" id="first-derivative-vectors">
<h4>First derivative vectors:<a class="headerlink" href="#first-derivative-vectors" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printResult</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:13.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;18.18s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[</span><span class="si">{0:3d}</span><span class="s2">]</span><span class="si">{1:&lt;8.8s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">))]</span>
    <span class="nb">print</span> <span class="p">()</span>
<span class="n">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;dGdn&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dgdn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2GdndT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdndt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2GdndP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdndp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdndt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdndtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdndp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdndt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdndt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdndtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdndp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;dGdn&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_dgdn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2GdndT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdndt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2GdndP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdndp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdndt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdndtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3GdndP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdndp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdndt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdndt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdndtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4GdndP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdndp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                   <span class="p">[</span>  <span class="mi">0</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">1</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">2</span><span class="p">]</span>
<span class="n">dGdn</span>       <span class="o">-</span><span class="mf">3.955206e+06</span> <span class="o">-</span><span class="mf">3.688954e+06</span> <span class="o">-</span><span class="mf">3.836474e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">d2GdndT</span>    <span class="o">-</span><span class="mf">5.876726e+02</span> <span class="o">-</span><span class="mf">6.339219e+02</span> <span class="o">-</span><span class="mf">5.931968e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">d2GdndP</span>     <span class="mf">7.099392e+00</span>  <span class="mf">7.309661e+00</span>  <span class="mf">6.733534e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">d3GdndT2</span>   <span class="o">-</span><span class="mf">1.343084e-01</span> <span class="o">-</span><span class="mf">1.363411e-01</span> <span class="o">-</span><span class="mf">1.394804e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">m</span>
<span class="n">d3GdndTdP</span>            <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">d3GdndP2</span>   <span class="o">-</span><span class="mf">5.761793e-06</span> <span class="o">-</span><span class="mf">6.779023e-06</span> <span class="o">-</span><span class="mf">4.801784e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">m</span>
<span class="n">d4GdndT3</span>    <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">m</span>
<span class="n">d4GdndT2dP</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span>
<span class="n">d4GdndTdP2</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span>
<span class="n">d4GdndP3</span>    <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="section" id="the-hessian-matrix-molar-second-derivative-matrix-is-stored-as-a-compact-linear-array">
<h4>The Hessian matrix (molar second derivative matrix) is stored as a compact linear array<a class="headerlink" href="#the-hessian-matrix-molar-second-derivative-matrix-is-stored-as-a-compact-linear-array" title="Permalink to this headline">¶</a></h4>
<p>A function is provided to map matrix indices to compact storage 1-D
array indices</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[ &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;]     [&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">symmetric_index_from_2d_array</span><span class="p">(</span><span class="n">elm</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>     <span class="p">[</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="p">]</span>
<span class="p">[</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>     <span class="p">[</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="p">]</span>
<span class="p">[</span>  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>     <span class="p">[</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printResult</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:13.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;18.18s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">maxIdx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[</span><span class="si">{0:3d}</span><span class="s2">]</span><span class="si">{1:&lt;8.8s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">)]</span>
    <span class="nb">print</span> <span class="p">()</span>
<span class="n">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2Gdn2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d2gdn2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn2dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdn2dt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdn2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdn2dt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdn2dtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdn2dp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn2dt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn2dt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn2dtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn2dp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m^2&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d2Gdn2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d2gdn2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn2dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdn2dt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdn2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_ComplexSolution_calib_d4gdn2dt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdn2dtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn2dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdn2dp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn2dt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn2dt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn2dtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m^2&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn2dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn2dp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m^2&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                   <span class="p">[</span>  <span class="mi">0</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">1</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">2</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">3</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">4</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">5</span><span class="p">]</span>
<span class="n">d2Gdn2</span>      <span class="mf">1.597539e+03</span> <span class="o">-</span><span class="mf">1.949313e+03</span>  <span class="mf">4.476024e+02</span>  <span class="mf">1.234486e+04</span> <span class="o">-</span><span class="mf">9.745836e+03</span>  <span class="mf">8.617416e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span>
<span class="n">d3Gdn2dT</span>    <span class="mf">1.735760e+00</span> <span class="o">-</span><span class="mf">4.137925e-01</span> <span class="o">-</span><span class="mf">1.086758e+00</span>  <span class="mf">5.012103e+00</span> <span class="o">-</span><span class="mf">4.276425e+00</span>  <span class="mf">4.867033e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span>
<span class="n">d3Gdn2dP</span>   <span class="o">-</span><span class="mf">2.723683e-03</span> <span class="o">-</span><span class="mf">3.119739e-04</span>  <span class="mf">2.592631e-03</span>  <span class="mf">1.279253e-02</span> <span class="o">-</span><span class="mf">1.154451e-02</span>  <span class="mf">8.462708e-03</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="the-3-d-tensor-molar-third-derivative-tensor-is-stored-as-a-compact-linear-array">
<h4>The 3-D Tensor (molar third derivative tensor) is stored as a compact linear array<a class="headerlink" href="#the-3-d-tensor-molar-third-derivative-tensor-is-stored-as-a-compact-linear-array" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">A function is provided to map matrix indices to compact storage 1-D
array indices:</div>
<div class="line">If <span class="math notranslate nohighlight">\(n_c\)</span> represents the number of components in the solution,
and</div>
<div class="line">if <span class="math notranslate nohighlight">\(n_d\)</span> represents the dimensionality of molar derivative (in
this case 3), then</div>
<div class="line">the number of numerically ordered permutations of <span class="math notranslate nohighlight">\(n_c\)</span> molar
derivatives taken <span class="math notranslate nohighlight">\(n_d\)</span> at a time is:</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_c</span><span class="p">,</span><span class="n">n_d</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n_c n_d&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n_c</span><span class="o">+</span><span class="n">n_d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n_d</span><span class="p">)</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n_c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">q</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\left(n_{c} + n_{d} - 1\right)!}{n_{d}! \left(n_{c} - 1\right)!}\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(n_d\)</span> equal to 3 and simplifying gives:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n_d</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">q</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{n_{c} \left(n_{c} + 1\right) \left(n_{c} + 2\right)}{6}\]</div>
<p>and, for the number of components in this solution, there will be the
following number of unique terms in the third derivative tensor:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n_c</span><span class="p">,</span><span class="n">nc</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle 10\]</div>
<p>A function is provided to map matrix indices to compact storage 1-D
array indices</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:1d}{1:1d}{2:1d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;] &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;  -&gt;  &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">symmetric_index_from_3d_array</span><span class="p">(</span><span class="n">elm</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;] &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mi">111</span> <span class="mi">112</span> <span class="mi">113</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">121</span> <span class="mi">122</span> <span class="mi">123</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">131</span> <span class="mi">132</span> <span class="mi">133</span> <span class="p">]</span>    <span class="o">-&gt;</span>   <span class="p">[</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="p">]</span>
<span class="p">[</span> <span class="mi">211</span> <span class="mi">212</span> <span class="mi">213</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">221</span> <span class="mi">222</span> <span class="mi">223</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">231</span> <span class="mi">232</span> <span class="mi">233</span> <span class="p">]</span>    <span class="o">-&gt;</span>   <span class="p">[</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">7</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="p">]</span>
<span class="p">[</span> <span class="mi">311</span> <span class="mi">312</span> <span class="mi">313</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">321</span> <span class="mi">322</span> <span class="mi">323</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">331</span> <span class="mi">332</span> <span class="mi">333</span> <span class="p">]</span>    <span class="o">-&gt;</span>   <span class="p">[</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="p">]</span>  <span class="p">[</span> <span class="mi">5</span> <span class="mi">8</span> <span class="mi">9</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printResult</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;14.14s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;15.15s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">maxIdx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[</span><span class="si">{0:3d}</span><span class="s2">]</span><span class="si">{1:&lt;5.5s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">)]</span>
    <span class="nb">print</span> <span class="p">()</span>
<span class="n">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d3gdn3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn3dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdn3dt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn3dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d4gdn3dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn3dt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn3dtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d5gdn3dp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d6gdn3dt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d6gdn3dt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d6gdn3dtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_d6gdn3dp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m^3&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d3Gdn3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d3gdn3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn3dT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdn3dt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d4Gdn3dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d4gdn3dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn3dt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn3dtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d5Gdn3dP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d5gdn3dp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d6gdn3dt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^3-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d6gdn3dt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K^2-bar-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d6gdn3dtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/K-bar^2-m^3&#39;</span><span class="p">)</span>
    <span class="n">printResult</span><span class="p">(</span><span class="s1">&#39;d6Gdn3dP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_calib_d6gdn3dp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;J/bar^3-m^3&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                <span class="p">[</span>  <span class="mi">0</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">1</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">2</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">3</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">4</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">5</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">6</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">7</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">8</span><span class="p">]</span>      <span class="p">[</span>  <span class="mi">9</span><span class="p">]</span>
<span class="n">d3Gdn3</span>     <span class="o">-</span><span class="mf">8.506e+02</span>  <span class="mf">2.257e+02</span> <span class="o">-</span><span class="mf">7.175e+02</span>  <span class="mf">5.764e+02</span>  <span class="mf">7.764e+02</span> <span class="o">-</span><span class="mf">4.539e+02</span> <span class="o">-</span><span class="mf">1.111e+04</span>  <span class="mf">2.712e+02</span>  <span class="mf">6.589e+03</span> <span class="o">-</span><span class="mf">1.233e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d4Gdn3dT</span>    <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d4Gdn3dP</span>    <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d5Gdn3dT2</span>   <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d5Gdn3dTdP</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d5Gdn3dP2</span>   <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d6Gdn3dT3</span>   <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d6Gdn3dT2d</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d6Gdn3dTdP</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
<span class="n">d6Gdn3dP3</span>   <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span>  <span class="mf">0.000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test-and-time-the-generated-functions-for-feldspar">
<h2>Test and time the generated functions for Feldspar<a class="headerlink" href="#test-and-time-the-generated-functions-for-feldspar" title="Permalink to this headline">¶</a></h2>
<p>Time the code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="o">%</span><span class="k">timeit</span> Complex_Solution.cy_Orthopyroxene_Complex_Solution_g(t, p, n)
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="o">%</span><span class="k">timeit</span> Complex_Solution.cy_Orthopyroxene_Complex_Solution_calib_g(t, p, n)
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>8.22 µs ± 246 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<p>Time the Rubicon wrapped Objective-C code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">model</span> <span class="k">as</span> <span class="n">stdmodel</span>
<span class="n">modelDB</span> <span class="o">=</span> <span class="n">stdmodel</span><span class="o">.</span><span class="n">Database</span><span class="p">()</span>
<span class="n">CpxHC</span> <span class="o">=</span> <span class="n">modelDB</span><span class="o">.</span><span class="n">get_phase</span><span class="p">(</span><span class="s1">&#39;Cpx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> CpxHC.gibbs_energy(t,p,mol=np.array([1.1, 1.2, 1.3, 0.0, 0.0, 0.0, 0.0]))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>69.2 µs ± 1.96 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
</div>
<div class="section" id="methods-available-only-in-the-calib-versions-of-generated-code">
<h2>Methods available only in the “Calib” versions of generated code<a class="headerlink" href="#methods-available-only-in-the-calib-versions-of-generated-code" title="Permalink to this headline">¶</a></h2>
<div class="section" id="execute-the-parameter-value-metadata-functions">
<h3>Execute the parameter value/metadata functions.<a class="headerlink" href="#execute-the-parameter-value-metadata-functions" title="Permalink to this headline">¶</a></h3>
<p>These functions are only defined for the “calibration” model code
implementation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nparam</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">nparam</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_number</span><span class="p">()</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_names</span><span class="p">()</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_units</span><span class="p">()</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_values</span><span class="p">()</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:13.6e}</span><span class="s2"> </span><span class="si">{3:&lt;10.10s}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nparam</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_value</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T_r</span>         <span class="mf">2.981500e+02</span>  <span class="mf">2.981500e+02</span> <span class="n">K</span>
<span class="n">P_r</span>         <span class="mf">1.000000e+00</span>  <span class="mf">1.000000e+00</span> <span class="n">bar</span>
<span class="n">Fh</span>         <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Fs</span>         <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Fv</span>         <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hex</span>        <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vex</span>        <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hx</span>         <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vx</span>          <span class="mf">2.824000e-02</span>  <span class="mf">2.824000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaMg</span>    <span class="mf">3.163100e+04</span>  <span class="mf">3.163100e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaMg</span>    <span class="mf">3.347000e-02</span>  <span class="mf">3.347000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaFe</span>    <span class="mf">1.723800e+04</span>  <span class="mf">1.723800e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaFe</span>    <span class="mf">4.602000e-02</span>  <span class="mf">4.602000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM1FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM1FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="section" id="functions-that-allow-modification-of-the-array-of-parameter-values">
<h3>Functions that allow modification of the array of parameter values<a class="headerlink" href="#functions-that-allow-modification-of-the-array-of-parameter-values" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span>
    <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_set_param_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:13.6e}</span><span class="s2"> </span><span class="si">{3:&lt;10.10s}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nparam</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_value</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">NameError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T_r</span>         <span class="mf">2.981500e+02</span>  <span class="mf">2.981500e+02</span> <span class="n">K</span>
<span class="n">P_r</span>         <span class="mf">1.000000e+02</span>  <span class="mf">1.000000e+02</span> <span class="n">bar</span>
<span class="n">Fh</span>         <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Fs</span>         <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Fv</span>         <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hex</span>        <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vex</span>        <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hx</span>         <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vx</span>          <span class="mf">2.824000e-02</span>  <span class="mf">2.824000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaMg</span>    <span class="mf">3.163100e+04</span>  <span class="mf">3.163100e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaMg</span>    <span class="mf">3.347000e-02</span>  <span class="mf">3.347000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaFe</span>    <span class="mf">1.723800e+04</span>  <span class="mf">1.723800e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaFe</span>    <span class="mf">4.602000e-02</span>  <span class="mf">4.602000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM1FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM1FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="section" id="functions-that-allow-modification-of-a-particular-parameter-value">
<h3>Functions that allow modification of a particular parameter value<a class="headerlink" href="#functions-that-allow-modification-of-a-particular-parameter-value" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_set_param_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2"> </span><span class="si">{2:13.6e}</span><span class="s2"> </span><span class="si">{3:&lt;10.10s}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nparam</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_get_param_value</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T_r</span>         <span class="mf">2.981500e+02</span>  <span class="mf">2.981500e+02</span> <span class="n">K</span>
<span class="n">P_r</span>         <span class="mf">1.000000e+02</span>  <span class="mf">1.000000e+00</span> <span class="n">bar</span>
<span class="n">Fh</span>         <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="o">-</span><span class="mf">1.380700e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Fs</span>         <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="o">-</span><span class="mf">2.319000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Fv</span>         <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="o">-</span><span class="mf">5.878000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hex</span>        <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="o">-</span><span class="mf">7.824000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vex</span>        <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="o">-</span><span class="mf">1.213000e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">Hx</span>         <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="o">-</span><span class="mf">1.883000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">Vx</span>          <span class="mf">2.824000e-02</span>  <span class="mf">2.824000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaMg</span>    <span class="mf">3.163100e+04</span>  <span class="mf">3.163100e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaMg</span>    <span class="mf">3.347000e-02</span>  <span class="mf">3.347000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2CaFe</span>    <span class="mf">1.723800e+04</span>  <span class="mf">1.723800e+04</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2CaFe</span>    <span class="mf">4.602000e-02</span>  <span class="mf">4.602000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM1FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM1FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
<span class="n">WhM2FeMg</span>    <span class="mf">8.368000e+03</span>  <span class="mf">8.368000e+03</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
<span class="n">WvM2FeMg</span>    <span class="mf">1.412000e-02</span>  <span class="mf">1.412000e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="section" id="functions-that-evaluate-parameter-derivatives">
<h3>Functions that evaluate parameter derivatives …<a class="headerlink" href="#functions-that-evaluate-parameter-derivatives" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;    </span><span class="si">{0:&lt;10.10s}</span><span class="s2"> </span><span class="si">{1:13.6e}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nparam</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Derivative with respect to parameter: &#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39; of&#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdT&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_dgdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dGdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_dgdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdT2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d2gdt2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdTdP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d2gdtdp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d2GdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d2gdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d3gdt3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdT2dP&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d3gdt2dp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdTdP2&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d3gdtdp2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;d3GdP3&#39;</span><span class="p">,</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_d3gdp3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">T_r</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">0.000000e+00</span>
    <span class="n">dGdT</span>        <span class="mf">0.000000e+00</span>
    <span class="n">dGdP</span>        <span class="mf">0.000000e+00</span>
    <span class="n">d2GdT2</span>      <span class="mf">0.000000e+00</span>
    <span class="n">d2GdTdP</span>     <span class="mf">0.000000e+00</span>
    <span class="n">d2GdP2</span>      <span class="mf">0.000000e+00</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">0.000000e+00</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">0.000000e+00</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">P_r</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">0.000000e+00</span>
    <span class="n">dGdT</span>        <span class="mf">0.000000e+00</span>
    <span class="n">dGdP</span>        <span class="mf">0.000000e+00</span>
    <span class="n">d2GdT2</span>      <span class="mf">0.000000e+00</span>
    <span class="n">d2GdTdP</span>     <span class="mf">0.000000e+00</span>
    <span class="n">d2GdP2</span>      <span class="mf">0.000000e+00</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">0.000000e+00</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">0.000000e+00</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Fh</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">4.048797e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.341382e-05</span>
    <span class="n">dGdP</span>        <span class="mf">4.024796e-07</span>
    <span class="n">d2GdT2</span>      <span class="mf">5.753133e-08</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">2.041586e-10</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">1.897976e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">2.583639e-13</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">3.043538e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Fs</span>  <span class="n">of</span>
    <span class="n">G</span>          <span class="o">-</span><span class="mf">8.097595e+02</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">2.980521e-01</span>
    <span class="n">dGdP</span>       <span class="o">-</span><span class="mf">8.049592e-04</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">8.235011e-06</span>
    <span class="n">d2GdTdP</span>     <span class="mf">5.837508e-09</span>
    <span class="n">d2GdP2</span>      <span class="mf">3.795952e-10</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">2.495297e-10</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">5.517684e-12</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Fv</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">4.048797e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.341382e-05</span>
    <span class="n">dGdP</span>        <span class="mf">4.048801e-01</span>
    <span class="n">d2GdT2</span>      <span class="mf">5.753133e-08</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">5.341403e-05</span>
    <span class="n">d2GdP2</span>      <span class="mf">8.049590e-07</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">1.117201e-07</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">7.662544e-10</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Hex</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">1.843090e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">1.137947e-04</span>
    <span class="n">dGdP</span>        <span class="mf">8.574566e-07</span>
    <span class="n">d2GdT2</span>      <span class="mf">1.225667e-07</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">4.349465e-10</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">4.043514e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">5.504274e-13</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">6.484060e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Vex</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">1.843090e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">1.137947e-04</span>
    <span class="n">dGdP</span>        <span class="mf">1.843099e-01</span>
    <span class="n">d2GdT2</span>      <span class="mf">1.225667e-07</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">1.137951e-04</span>
    <span class="n">d2GdP2</span>      <span class="mf">1.714913e-06</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">2.380124e-07</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">1.632455e-09</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Hx</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">3.049122e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.240953e-05</span>
    <span class="n">dGdP</span>        <span class="mf">3.949121e-07</span>
    <span class="n">d2GdT2</span>      <span class="mf">7.198221e-08</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">3.173600e-10</span>
    <span class="n">d2GdP2</span>      <span class="mf">6.956816e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">9.659313e-13</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">6.333638e-16</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">Vx</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">3.049122e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.240953e-05</span>
    <span class="n">dGdP</span>        <span class="mf">3.049126e-01</span>
    <span class="n">d2GdT2</span>      <span class="mf">7.198221e-08</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">5.240985e-05</span>
    <span class="n">d2GdP2</span>      <span class="mf">7.898250e-07</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">1.562180e-07</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">1.454090e-09</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WhM2CaMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">4.541294e-01</span>
    <span class="n">dGdT</span>        <span class="mf">1.068276e-04</span>
    <span class="n">dGdP</span>       <span class="o">-</span><span class="mf">8.049592e-07</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">1.150627e-07</span>
    <span class="n">d2GdTdP</span>     <span class="mf">4.083171e-10</span>
    <span class="n">d2GdP2</span>      <span class="mf">3.795952e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">5.167278e-13</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">6.087076e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WvM2CaMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">4.541294e-01</span>
    <span class="n">dGdT</span>        <span class="mf">1.068276e-04</span>
    <span class="n">dGdP</span>        <span class="mf">4.541286e-01</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">1.150627e-07</span>
    <span class="n">d2GdTdP</span>     <span class="mf">1.068281e-04</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">1.609918e-06</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">2.234402e-07</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">1.532509e-09</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WhM2CaFe</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">3.764262e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">1.068276e-04</span>
    <span class="n">dGdP</span>        <span class="mf">8.049592e-07</span>
    <span class="n">d2GdT2</span>      <span class="mf">1.150627e-07</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">4.083171e-10</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">3.795952e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">5.167278e-13</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">6.087076e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WvM2CaFe</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">3.764262e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">1.068276e-04</span>
    <span class="n">dGdP</span>        <span class="mf">3.764270e-01</span>
    <span class="n">d2GdT2</span>      <span class="mf">1.150627e-07</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">1.068281e-04</span>
    <span class="n">d2GdP2</span>      <span class="mf">1.609918e-06</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>    <span class="mf">2.234402e-07</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">1.532509e-09</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WhM1FeMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">5.071750e-01</span>
    <span class="n">dGdT</span>        <span class="mf">1.104680e-04</span>
    <span class="n">dGdP</span>       <span class="o">-</span><span class="mf">8.323900e-07</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">1.345163e-07</span>
    <span class="n">d2GdTdP</span>     <span class="mf">5.392714e-10</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">4.893799e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">1.246762e-12</span>
    <span class="n">d3GdTdP2</span>   <span class="o">-</span><span class="mf">3.941558e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WvM1FeMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">5.071750e-01</span>
    <span class="n">dGdT</span>        <span class="mf">1.104680e-04</span>
    <span class="n">dGdP</span>        <span class="mf">5.071742e-01</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">1.345163e-07</span>
    <span class="n">d2GdTdP</span>     <span class="mf">1.104686e-04</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">1.664780e-06</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">2.776530e-07</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">2.286975e-09</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WhM2FeMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">1.163339e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.648974e-06</span>
    <span class="n">dGdP</span>        <span class="mf">4.256570e-08</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">9.448163e-09</span>
    <span class="n">d2GdTdP</span>     <span class="mf">9.544848e-11</span>
    <span class="n">d2GdP2</span>     <span class="o">-</span><span class="mf">9.019834e-13</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">6.851010e-13</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">2.674830e-15</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
<span class="n">Derivative</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span>  <span class="n">WvM2FeMg</span>  <span class="n">of</span>
    <span class="n">G</span>           <span class="mf">1.163339e-01</span>
    <span class="n">dGdT</span>       <span class="o">-</span><span class="mf">5.648974e-06</span>
    <span class="n">dGdP</span>        <span class="mf">1.163339e-01</span>
    <span class="n">d2GdT2</span>     <span class="o">-</span><span class="mf">9.448163e-09</span>
    <span class="n">d2GdTdP</span>    <span class="o">-</span><span class="mf">5.648879e-06</span>
    <span class="n">d2GdP2</span>      <span class="mf">8.513050e-08</span>
    <span class="n">d3GdT3</span>               <span class="n">nan</span>
    <span class="n">d3GdT2dP</span>   <span class="o">-</span><span class="mf">3.478314e-08</span>
    <span class="n">d3GdTdP2</span>    <span class="mf">6.212044e-10</span>
    <span class="n">d3GdP3</span>               <span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="section" id="parameter-derivatives-of-the-chemical-potential">
<h3>Parameter derivatives of the chemical potential<a class="headerlink" href="#parameter-derivatives-of-the-chemical-potential" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printResult</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;dmu[*]/d </span><span class="si">{0:&lt;10.10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:13.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&lt;12.12s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;         </span><span class="si">{0:&lt;18.18s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[</span><span class="si">{0:3d}</span><span class="s2">]</span><span class="si">{1:&lt;8.8s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">))]</span>
    <span class="nb">print</span> <span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">printLabels</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nparam</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Complex_Solution</span><span class="o">.</span><span class="n">cy_Orthopyroxene_Complex_Solution_dparam_dgdn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">printResult</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">result</span><span class="p">,</span> <span class="s1">&#39;J/m^2/p-unit&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                            <span class="p">[</span>  <span class="mi">0</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">1</span><span class="p">]</span>         <span class="p">[</span>  <span class="mi">2</span><span class="p">]</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">T_r</span>         <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">P_r</span>         <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span>  <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Fh</span>         <span class="o">-</span><span class="mf">4.394940e-02</span>  <span class="mf">2.557182e-01</span>  <span class="mf">1.125863e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Fs</span>          <span class="mf">8.789879e+01</span> <span class="o">-</span><span class="mf">5.114364e+02</span> <span class="o">-</span><span class="mf">2.251726e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Fv</span>         <span class="o">-</span><span class="mf">4.394940e-02</span>  <span class="mf">2.557182e-01</span>  <span class="mf">1.125863e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Hex</span>         <span class="mf">2.268990e-03</span>  <span class="mf">7.547392e-02</span>  <span class="mf">7.018803e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Vex</span>         <span class="mf">2.268990e-03</span>  <span class="mf">7.547392e-02</span>  <span class="mf">7.018803e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Hx</span>         <span class="o">-</span><span class="mf">1.593030e-02</span>  <span class="mf">1.178342e-01</span>  <span class="mf">1.392573e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">Vx</span>         <span class="o">-</span><span class="mf">1.593030e-02</span>  <span class="mf">1.178342e-01</span>  <span class="mf">1.392573e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WhM2CaMg</span>    <span class="mf">9.792966e-02</span> <span class="o">-</span><span class="mf">1.402945e-01</span>  <span class="mf">3.959693e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WvM2CaMg</span>    <span class="mf">9.792966e-02</span> <span class="o">-</span><span class="mf">1.402945e-01</span>  <span class="mf">3.959693e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WhM2CaFe</span>    <span class="mf">3.247158e-02</span>  <span class="mf">2.706957e-01</span>  <span class="mf">1.220968e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WvM2CaFe</span>    <span class="mf">3.247158e-02</span>  <span class="mf">2.706957e-01</span>  <span class="mf">1.220968e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WhM1FeMg</span>    <span class="mf">5.632443e-02</span>  <span class="mf">4.706427e-01</span> <span class="o">-</span><span class="mf">9.196394e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WvM1FeMg</span>    <span class="mf">5.632443e-02</span>  <span class="mf">4.706427e-01</span> <span class="o">-</span><span class="mf">9.196394e-02</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WhM2FeMg</span>   <span class="o">-</span><span class="mf">3.372310e-02</span> <span class="o">-</span><span class="mf">2.112597e-02</span>  <span class="mf">1.375234e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
<span class="n">dmu</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">/</span><span class="n">d</span> <span class="n">WvM2FeMg</span>   <span class="o">-</span><span class="mf">3.372310e-02</span> <span class="o">-</span><span class="mf">2.112597e-02</span>  <span class="mf">1.375234e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">-</span><span class="n">unit</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>