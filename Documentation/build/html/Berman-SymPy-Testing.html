<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Berman SymPy Testing Theory and Code Generation &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="None"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="search" title="Search" href="search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="index.html">
      <img style="border: 0;" alt="ENKI" src="_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="index.html">Thermoengine 1.0.1 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="berman-sympy-testing-theory-and-code-generation">
<h1>Berman SymPy Testing Theory and Code Generation<a class="headerlink" href="#berman-sympy-testing-theory-and-code-generation" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="standard-state-properties-structure-of-the-equations">
<h2>Standard State Properties - Structure of the Equations<a class="headerlink" href="#standard-state-properties-structure-of-the-equations" title="Permalink to this headline">¶</a></h2>
<p>There are three classes of terms: - Terms that apply over the whole of
<span class="math notranslate nohighlight">\(T\)</span>-, <span class="math notranslate nohighlight">\(P\)</span>-space, <span class="math notranslate nohighlight">\(T_r \le T\)</span>, <span class="math notranslate nohighlight">\(P_r \le P\)</span> -
Terms that apply over a specified range of <span class="math notranslate nohighlight">\(T\)</span>-, <span class="math notranslate nohighlight">\(P\)</span>-space,
<span class="math notranslate nohighlight">\((T_{r_\lambda},P_{r_\lambda}) \le (T,P) \le (T_\lambda,P_\lambda)\)</span>
- Terms that apply to a specific <span class="math notranslate nohighlight">\(T_t\)</span> and <span class="math notranslate nohighlight">\(P_t\)</span> and higher
<span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(T_t \le T\)</span>, <span class="math notranslate nohighlight">\(P_t \le P\)</span></p>
<p>Second-order phase transitions (<span class="math notranslate nohighlight">\(lambda\)</span>-transitions) are an
example of the second type, as are order disorder transformations.
First-order phase transitions are an example of the third type.</p>
</div>
<div class="section" id="berman-terms-valid-over-the-whole-of-t-p-space">
<h2>Berman terms valid over the whole of T,P space<a class="headerlink" href="#berman-terms-valid-over-the-whole-of-t-p-space" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Parameters of the Berman (1988) model that pertain to the whole of
<span class="math notranslate nohighlight">\(T\)</span>-<span class="math notranslate nohighlight">\(P\)</span> space: - <span class="math notranslate nohighlight">\(\Delta{H_{T_r,P_r}}\)</span>, the enthalpy
of formation from the elements at <span class="math notranslate nohighlight">\(T_r\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span> -
<span class="math notranslate nohighlight">\(S_{T_r,P_r}\)</span>, the third law entropy at <span class="math notranslate nohighlight">\(T_r\)</span> and
<span class="math notranslate nohighlight">\(P_r\)</span> - <span class="math notranslate nohighlight">\(V_{T_r,P_r}\)</span>, the volume at <span class="math notranslate nohighlight">\(T_r\)</span> and
<span class="math notranslate nohighlight">\(P_r\)</span> - <span class="math notranslate nohighlight">\(k_0\)</span>, <span class="math notranslate nohighlight">\(k_1\)</span>, <span class="math notranslate nohighlight">\(k_2\)</span>, and <span class="math notranslate nohighlight">\(k_3\)</span>,
coefficients in the reference pressure heat capacity expression</div>
<div class="line">- <span class="math notranslate nohighlight">\(v_1\)</span>, <span class="math notranslate nohighlight">\(v_2\)</span>, <span class="math notranslate nohighlight">\(v_3\)</span>, and <span class="math notranslate nohighlight">\(v_4\)</span>, coefficients
in Berman Equation of State</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tr</span><span class="p">,</span><span class="n">Pr</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_r P_r&#39;</span><span class="p">)</span>
<span class="n">k0</span><span class="p">,</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">,</span><span class="n">k3</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k0 k1 k2 k3&#39;</span><span class="p">)</span>
<span class="n">VTrPr</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v4</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;V_TrPr v1 v2 v3 v4&#39;</span><span class="p">)</span>
<span class="n">STrPr</span><span class="p">,</span><span class="n">HTrPr</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;S_TrPr H_TrPr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Input variables:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T P&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Heat capacity at constant pressure. Berman and Brown (1985) form.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CpPr</span> <span class="o">=</span> <span class="n">k0</span><span class="o">+</span><span class="n">k1</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">k3</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span>
<span class="n">CpPr</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[k_{0} + \frac{k_{2}}{T^{2}} + \frac{k_{3}}{T^{3}} + \frac{k_{1}}{\sqrt{T}}\]</div>
<p>Apparent enthalpy of formation at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span>. The
quantity is apparent because the heat capacity of the substance is
integrated up in <span class="math notranslate nohighlight">\(T\)</span> from <span class="math notranslate nohighlight">\(T_r\)</span>, but the enthalpy of the
elements are left at <span class="math notranslate nohighlight">\(T_r\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HPr</span> <span class="o">=</span> <span class="n">HTrPr</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">CpPr</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">Tr</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">HPr</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[H_{TrPr} + 2 \sqrt{T} k_{1} + T k_{0} - 2 \sqrt{T_{r}} k_{1} - T_{r} k_{0} + \frac{k_{2}}{T_{r}} + \frac{k_{3}}{2 T_{r}^{2}} - \frac{k_{2}}{T} - \frac{k_{3}}{2 T^{2}}\]</div>
<p>Entropy at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SPr</span> <span class="o">=</span> <span class="n">STrPr</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">CpPr</span><span class="o">/</span><span class="n">T</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">Tr</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">SPr</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[S_{TrPr} + k_{0} \log{\left (T \right )} - k_{0} \log{\left (T_{r} \right )} + \frac{k_{2}}{2 T_{r}^{2}} + \frac{k_{3}}{3 T_{r}^{3}} + \frac{2 k_{1}}{\sqrt{T_{r}}} - \frac{k_{2}}{2 T^{2}} - \frac{k_{3}}{3 T^{3}} - \frac{2 k_{1}}{\sqrt{T}}\]</div>
<p>Volume at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P\)</span> evaluated using the Berman (1988)
Equation of State.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">VTrPr</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">v1</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">Pr</span><span class="p">)</span><span class="o">+</span><span class="n">v2</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">Pr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span><span class="o">+</span><span class="n">v4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">V</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[V_{TrPr} \left(v_{1} \left(P - P_{r}\right) + v_{2} \left(P - P_{r}\right)^{2} + v_{3} \left(T - T_{r}\right) + v_{4} \left(T - T_{r}\right)^{2} + 1\right)\]</div>
<p>Apparent Gibbs Free Energy of formation at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPr</span> <span class="o">=</span> <span class="n">HPr</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">SPr</span>
<span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">GPr</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[H_{TrPr} - S_{TrPr} T + 4 \sqrt{T} k_{1} - T k_{0} \log{\left (T \right )} + T k_{0} \log{\left (T_{r} \right )} + T k_{0} - \frac{T k_{2}}{2 T_{r}^{2}} - \frac{T k_{3}}{3 T_{r}^{3}} - \frac{2 T k_{1}}{\sqrt{T_{r}}} - 2 \sqrt{T_{r}} k_{1} - T_{r} k_{0} + \frac{k_{2}}{T_{r}} + \frac{k_{3}}{2 T_{r}^{2}} - \frac{k_{2}}{2 T} - \frac{k_{3}}{6 T^{2}}\]</div>
<p>Apparent Gibbs Free Energy of formation at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">GPr</span> <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">V</span><span class="p">,(</span><span class="n">P</span><span class="p">,</span><span class="n">Pr</span><span class="p">,</span><span class="n">P</span><span class="p">))</span>
<span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[H_{TrPr} + \frac{P^{3} V_{TrPr} v_{2}}{3} - P^{2} P_{r} V_{TrPr} v_{2} + \frac{P^{2} V_{TrPr} v_{1}}{2} + P P_{r}^{2} V_{TrPr} v_{2} - P P_{r} V_{TrPr} v_{1} + P T^{2} V_{TrPr} v_{4} - 2 P T T_{r} V_{TrPr} v_{4} + P T V_{TrPr} v_{3} + P T_{r}^{2} V_{TrPr} v_{4} - P T_{r} V_{TrPr} v_{3} + P V_{TrPr} - \frac{P_{r}^{3} V_{TrPr} v_{2}}{3} + \frac{P_{r}^{2} V_{TrPr} v_{1}}{2} - P_{r} T^{2} V_{TrPr} v_{4} + 2 P_{r} T T_{r} V_{TrPr} v_{4} - P_{r} T V_{TrPr} v_{3} - P_{r} T_{r}^{2} V_{TrPr} v_{4} + P_{r} T_{r} V_{TrPr} v_{3} - P_{r} V_{TrPr} - S_{TrPr} T + 4 \sqrt{T} k_{1} - T k_{0} \log{\left (T \right )} + T k_{0} \log{\left (T_{r} \right )} + T k_{0} - \frac{T k_{2}}{2 T_{r}^{2}} - \frac{T k_{3}}{3 T_{r}^{3}} - \frac{2 T k_{1}}{\sqrt{T_{r}}} - 2 \sqrt{T_{r}} k_{1} - T_{r} k_{0} + \frac{k_{2}}{T_{r}} + \frac{k_{3}}{2 T_{r}^{2}} - \frac{k_{2}}{2 T} - \frac{k_{3}}{6 T^{2}}\]</div>
</div>
<div class="section" id="berman-terms-valid-over-an-interval-of-t-p-space">
<h2>Berman terms valid over an interval of T,P space<a class="headerlink" href="#berman-terms-valid-over-an-interval-of-t-p-space" title="Permalink to this headline">¶</a></h2>
<p>Parameters of the Berman (1988) lambda transition model: - <span class="math notranslate nohighlight">\(l_1\)</span>
and <span class="math notranslate nohighlight">\(l_2\)</span>, coefficients in Berman (1988)’s <span class="math notranslate nohighlight">\(lambda\)</span>-heat
capacity model - <span class="math notranslate nohighlight">\(k_{\lambda}\)</span>,
<span class="math notranslate nohighlight">\(\frac{{d{T_\lambda }}}{{dP}}\)</span> in Berman (1988)’s
<span class="math notranslate nohighlight">\(lambda\)</span>-transition model - <span class="math notranslate nohighlight">\(T_{\lambda,{P_r}}\)</span>, Temperature
of the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at reference pressure -
<span class="math notranslate nohighlight">\(T_{\lambda,{ref}}\)</span>, Temperature of the lower bound of the heat
capacity integral for the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at reference
pressure</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;l1 l2&#39;</span><span class="p">)</span>
<span class="n">kl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k_lambda&#39;</span><span class="p">)</span>
<span class="n">TlPr</span><span class="p">,</span> <span class="n">Tlref</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_lambda_Pr T_lambda_ref&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(T_{\lambda}\)</span> at <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tl</span> <span class="o">=</span> <span class="n">TlPr</span> <span class="o">+</span> <span class="n">kl</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">Pr</span><span class="p">)</span>
<span class="n">Tl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\]</div>
<p>Temperature difference between <span class="math notranslate nohighlight">\(T_{lambda}\)</span> at <span class="math notranslate nohighlight">\(P\)</span> and
<span class="math notranslate nohighlight">\(P_r\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span> <span class="o">=</span> <span class="n">TlPr</span> <span class="o">-</span> <span class="n">Tl</span>
<span class="n">td</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- k_{\lambda} \left(P - P_{r}\right)\]</div>
<p>Reference temperature for lower limit of heat capacity integral.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span> <span class="o">=</span> <span class="n">Tlref</span> <span class="o">-</span> <span class="n">td</span>
<span class="n">tr</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\]</div>
<p>Heat capacity due to the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at <span class="math notranslate nohighlight">\(T\)</span> and
<span class="math notranslate nohighlight">\(P\)</span>. Valid: <span class="math notranslate nohighlight">\(T_r \le T \le T_{\lambda}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cpl</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">td</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">l1</span><span class="o">+</span><span class="n">l2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">td</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Cpl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\left(T - k_{\lambda} \left(P - P_{r}\right)\right) \left(l_{1} + l_{2} \left(T - k_{\lambda} \left(P - P_{r}\right)\right)\right)^{2}\]</div>
<p>Enthalpy due to the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at <span class="math notranslate nohighlight">\(T\)</span> and
<span class="math notranslate nohighlight">\(P\)</span>. Valid: <span class="math notranslate nohighlight">\(T_r \le T \le T_{\lambda}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">Cpl</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">Hl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T^{4} l_{2}^{2}}{4} + T^{3} \left(- P k_{\lambda} l_{2}^{2} + P_{r} k_{\lambda} l_{2}^{2} + \frac{2 l_{1} l_{2}}{3}\right) + T^{2} \left(\frac{3 P^{2} k_{\lambda}^{2} l_{2}^{2}}{2} - 3 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 2 P k_{\lambda} l_{1} l_{2} + \frac{3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2}}{2} + 2 P_{r} k_{\lambda} l_{1} l_{2} + \frac{l_{1}^{2}}{2}\right) + T \left(- P^{3} k_{\lambda}^{3} l_{2}^{2} + 3 P^{2} P_{r} k_{\lambda}^{3} l_{2}^{2} + 2 P^{2} k_{\lambda}^{2} l_{1} l_{2} - 3 P P_{r}^{2} k_{\lambda}^{3} l_{2}^{2} - 4 P P_{r} k_{\lambda}^{2} l_{1} l_{2} - P k_{\lambda} l_{1}^{2} + P_{r}^{3} k_{\lambda}^{3} l_{2}^{2} + 2 P_{r}^{2} k_{\lambda}^{2} l_{1} l_{2} + P_{r} k_{\lambda} l_{1}^{2}\right) - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{4}}{4} - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3} \left(- P k_{\lambda} l_{2}^{2} + P_{r} k_{\lambda} l_{2}^{2} + \frac{2 l_{1} l_{2}}{3}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(\frac{3 P^{2} k_{\lambda}^{2} l_{2}^{2}}{2} - 3 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 2 P k_{\lambda} l_{1} l_{2} + \frac{3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2}}{2} + 2 P_{r} k_{\lambda} l_{1} l_{2} + \frac{l_{1}^{2}}{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(- P^{3} k_{\lambda}^{3} l_{2}^{2} + 3 P^{2} P_{r} k_{\lambda}^{3} l_{2}^{2} + 2 P^{2} k_{\lambda}^{2} l_{1} l_{2} - 3 P P_{r}^{2} k_{\lambda}^{3} l_{2}^{2} - 4 P P_{r} k_{\lambda}^{2} l_{1} l_{2} - P k_{\lambda} l_{1}^{2} + P_{r}^{3} k_{\lambda}^{3} l_{2}^{2} + 2 P_{r}^{2} k_{\lambda}^{2} l_{1} l_{2} + P_{r} k_{\lambda} l_{1}^{2}\right)\]</div>
<p>Entropy due to the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at <span class="math notranslate nohighlight">\(T\)</span> and
<span class="math notranslate nohighlight">\(P\)</span>. Valid: <span class="math notranslate nohighlight">\(T_r \le T \le T_{\lambda}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">Cpl</span><span class="o">/</span><span class="n">T</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">Sl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T^{3} l_{2}^{2}}{3} + T^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) + T \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) - k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T \right )} + k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3}}{3} - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right)\]</div>
<p>Gibbs Free Energy due to the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at <span class="math notranslate nohighlight">\(T\)</span> and
<span class="math notranslate nohighlight">\(P\)</span>. Valid: <span class="math notranslate nohighlight">\(T_r \le T \le T_{\lambda}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gl</span> <span class="o">=</span> <span class="n">Hl</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">Sl</span>
<span class="n">Gl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T^{4} l_{2}^{2}}{4} + T^{3} \left(- P k_{\lambda} l_{2}^{2} + P_{r} k_{\lambda} l_{2}^{2} + \frac{2 l_{1} l_{2}}{3}\right) + T^{2} \left(\frac{3 P^{2} k_{\lambda}^{2} l_{2}^{2}}{2} - 3 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 2 P k_{\lambda} l_{1} l_{2} + \frac{3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2}}{2} + 2 P_{r} k_{\lambda} l_{1} l_{2} + \frac{l_{1}^{2}}{2}\right) - T \left(\frac{T^{3} l_{2}^{2}}{3} + T^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) + T \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) - k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T \right )} + k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3}}{3} - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right)\right) + T \left(- P^{3} k_{\lambda}^{3} l_{2}^{2} + 3 P^{2} P_{r} k_{\lambda}^{3} l_{2}^{2} + 2 P^{2} k_{\lambda}^{2} l_{1} l_{2} - 3 P P_{r}^{2} k_{\lambda}^{3} l_{2}^{2} - 4 P P_{r} k_{\lambda}^{2} l_{1} l_{2} - P k_{\lambda} l_{1}^{2} + P_{r}^{3} k_{\lambda}^{3} l_{2}^{2} + 2 P_{r}^{2} k_{\lambda}^{2} l_{1} l_{2} + P_{r} k_{\lambda} l_{1}^{2}\right) - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{4}}{4} - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3} \left(- P k_{\lambda} l_{2}^{2} + P_{r} k_{\lambda} l_{2}^{2} + \frac{2 l_{1} l_{2}}{3}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(\frac{3 P^{2} k_{\lambda}^{2} l_{2}^{2}}{2} - 3 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 2 P k_{\lambda} l_{1} l_{2} + \frac{3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2}}{2} + 2 P_{r} k_{\lambda} l_{1} l_{2} + \frac{l_{1}^{2}}{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(- P^{3} k_{\lambda}^{3} l_{2}^{2} + 3 P^{2} P_{r} k_{\lambda}^{3} l_{2}^{2} + 2 P^{2} k_{\lambda}^{2} l_{1} l_{2} - 3 P P_{r}^{2} k_{\lambda}^{3} l_{2}^{2} - 4 P P_{r} k_{\lambda}^{2} l_{1} l_{2} - P k_{\lambda} l_{1}^{2} + P_{r}^{3} k_{\lambda}^{3} l_{2}^{2} + 2 P_{r}^{2} k_{\lambda}^{2} l_{1} l_{2} + P_{r} k_{\lambda} l_{1}^{2}\right)\]</div>
<p>Gibbs Free Energy due to the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition at <span class="math notranslate nohighlight">\(T\)</span> and
<span class="math notranslate nohighlight">\(P\)</span> when <span class="math notranslate nohighlight">\(k_{\lambda}\)</span> is zero. Valid:
<span class="math notranslate nohighlight">\(T_r \le T \le T_{\lambda}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Gl</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- \frac{T^{4} l_{2}^{2}}{12} - \frac{T^{3} l_{1} l_{2}}{3} - \frac{T^{2} l_{1}^{2}}{2} + \frac{T T_{\lambda ref}^{3} l_{2}^{2}}{3} + T T_{\lambda ref}^{2} l_{1} l_{2} + T T_{\lambda ref} l_{1}^{2} - \frac{T_{\lambda ref}^{4} l_{2}^{2}}{4} - \frac{2 T_{\lambda ref}^{3} l_{1} l_{2}}{3} - \frac{T_{\lambda ref}^{2} l_{1}^{2}}{2}\]</div>
<p>The volume of the <span class="math notranslate nohighlight">\(\lambda\)</span>-transition is given by differentiation
of the Gibbs Free Energy:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="n">Vl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{k_{\lambda} \left(T \left(2 k_{\lambda} \left(- P + P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} + \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(6 P^{2} k_{\lambda}^{2} l_{2}^{2} - 12 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 8 P k_{\lambda} l_{1} l_{2} + 6 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 8 P_{r} k_{\lambda} l_{1} l_{2} + 3 T^{2} l_{2}^{2} + 4 T l_{2} \left(- 3 P k_{\lambda} l_{2} + 3 P_{r} k_{\lambda} l_{2} + 2 l_{1}\right) - 4 k_{\lambda} l_{2} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right) \log{\left (T \right )} + 4 k_{\lambda} l_{2} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right) \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} + 2 l_{1}^{2} - l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} - 2 l_{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(- 3 P k_{\lambda} l_{2} + 3 P_{r} k_{\lambda} l_{2} + 2 l_{1}\right) + 2 \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T \right )} - 2 \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )}\right)\right) + 2 \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(- T^{3} l_{2}^{2} + T^{2} l_{2} \left(3 P k_{\lambda} l_{2} - 3 P_{r} k_{\lambda} l_{2} - 2 l_{1}\right) - T \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) - k_{\lambda} \left(- P^{3} k_{\lambda}^{2} l_{2}^{2} + 3 P^{2} P_{r} k_{\lambda}^{2} l_{2}^{2} + 2 P^{2} k_{\lambda} l_{1} l_{2} - 3 P P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} - 4 P P_{r} k_{\lambda} l_{1} l_{2} - P l_{1}^{2} + P_{r}^{3} k_{\lambda}^{2} l_{2}^{2} + 2 P_{r}^{2} k_{\lambda} l_{1} l_{2} + P_{r} l_{1}^{2}\right)\right)\right)}{2 \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)}\]</div>
<div class="section" id="for-t-t-lambda-we-have-the-following-contributions">
<h3>For <span class="math notranslate nohighlight">\(T &gt; T_{\lambda}\)</span>, we have the following contributions:<a class="headerlink" href="#for-t-t-lambda-we-have-the-following-contributions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CpatTl</span> <span class="o">=</span> <span class="n">Cpl</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Tl</span><span class="p">)</span>
<span class="n">CpatTl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[T_{\lambda Pr} \left(T_{\lambda Pr} l_{2} + l_{1}\right)^{2}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HatTl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hl</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Tl</span><span class="p">))</span>
<span class="n">HatTl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T_{\lambda Pr}^{4} l_{2}^{2}}{4} + \frac{2 T_{\lambda Pr}^{3} l_{1} l_{2}}{3} + \frac{T_{\lambda Pr}^{2} l_{1}^{2}}{2} - \frac{T_{\lambda ref}^{4} l_{2}^{2}}{4} - \frac{2 T_{\lambda ref}^{3} l_{1} l_{2}}{3} - \frac{T_{\lambda ref}^{2} l_{1}^{2}}{2}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SatTl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Sl</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Tl</span><span class="p">))</span>
<span class="n">SatTl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right) \right )} + k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} + \frac{l_{2}^{2} \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right)^{3}}{3} - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3}}{3} + \frac{l_{2} \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- 3 P k_{\lambda} l_{2} + 3 P_{r} k_{\lambda} l_{2} + 2 l_{1}\right)}{2} + \frac{l_{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(3 P k_{\lambda} l_{2} - 3 P_{r} k_{\lambda} l_{2} - 2 l_{1}\right)}{2} + \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right)\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T_{\lambda Pr}^{3} l_{2}^{2}}{3} + T_{\lambda Pr}^{2} l_{1} l_{2} + T_{\lambda Pr} l_{1}^{2} - \frac{T_{\lambda ref}^{3} l_{2}^{2}}{3} - T_{\lambda ref}^{2} l_{1} l_{2} - T_{\lambda ref} l_{1}^{2}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GatTl</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">HatTl</span><span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">SatTl</span><span class="p">)</span>
<span class="n">GatTl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{T \left(6 k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right) \right )} - 6 k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} - 2 l_{2}^{2} \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right)^{3} + 2 l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3} - 3 l_{2} \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- 3 P k_{\lambda} l_{2} + 3 P_{r} k_{\lambda} l_{2} + 2 l_{1}\right) + 3 l_{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- 3 P k_{\lambda} l_{2} + 3 P_{r} k_{\lambda} l_{2} + 2 l_{1}\right) - 6 \left(T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) + 6 \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right)\right)}{6} + \frac{T_{\lambda Pr}^{4} l_{2}^{2}}{4} + \frac{2 T_{\lambda Pr}^{3} l_{1} l_{2}}{3} + \frac{T_{\lambda Pr}^{2} l_{1}^{2}}{2} - \frac{T_{\lambda ref}^{4} l_{2}^{2}}{4} - \frac{2 T_{\lambda ref}^{3} l_{1} l_{2}}{3} - \frac{T_{\lambda ref}^{2} l_{1}^{2}}{2}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- \frac{T \left(T_{\lambda Pr}^{3} l_{2}^{2} + 3 T_{\lambda Pr}^{2} l_{1} l_{2} + 3 T_{\lambda Pr} l_{1}^{2} - T_{\lambda ref}^{3} l_{2}^{2} - 3 T_{\lambda ref}^{2} l_{1} l_{2} - 3 T_{\lambda ref} l_{1}^{2}\right)}{3} + \frac{T_{\lambda Pr}^{4} l_{2}^{2}}{4} + \frac{2 T_{\lambda Pr}^{3} l_{1} l_{2}}{3} + \frac{T_{\lambda Pr}^{2} l_{1}^{2}}{2} - \frac{T_{\lambda ref}^{4} l_{2}^{2}}{4} - \frac{2 T_{\lambda ref}^{3} l_{1} l_{2}}{3} - \frac{T_{\lambda ref}^{2} l_{1}^{2}}{2}\]</div>
</div>
</div>
<div class="section" id="berman-terms-valid-at-t-ge-t-t">
<h2>Berman terms valid at T <span class="math notranslate nohighlight">\(\ge\)</span> <span class="math notranslate nohighlight">\(T_t\)</span><a class="headerlink" href="#berman-terms-valid-at-t-ge-t-t" title="Permalink to this headline">¶</a></h2>
<p>Berman parameters (in this case <span class="math notranslate nohighlight">\(T_t\)</span> is equivalent to
<span class="math notranslate nohighlight">\(T_{\lambda}\)</span>: - <span class="math notranslate nohighlight">\({{\Delta}_t}H\)</span>, First order enthalpy
contribution at <span class="math notranslate nohighlight">\(T_{\lambda}\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deltaHt</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;H_t&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\({{\Delta}_t}S\)</span>, First order enropy contribution at
<span class="math notranslate nohighlight">\(T_{\lambda}\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deltaSt</span> <span class="o">=</span> <span class="n">deltaHt</span><span class="o">/</span><span class="n">Tl</span>
<span class="n">deltaSt</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{H_{t}}{T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)}\]</div>
<div class="section" id="above-t-lambda-the-following-term-is-convenient-to-define">
<h3>Above <span class="math notranslate nohighlight">\(T_{\lambda}\)</span> the following term is convenient to define<a class="headerlink" href="#above-t-lambda-the-following-term-is-convenient-to-define" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GaboveTl</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">Tl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">deltaSt</span><span class="o">+</span><span class="n">Sl</span><span class="p">)</span>
<span class="n">GaboveTl</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\left(- T + T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)\right) \left(\frac{H_{t}}{T_{\lambda Pr} + k_{\lambda} \left(P - P_{r}\right)} + \frac{T^{3} l_{2}^{2}}{3} + T^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) + T \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right) - k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T \right )} + k_{\lambda} \left(P - P_{r}\right) \left(- P k_{\lambda} l_{2} + P_{r} k_{\lambda} l_{2} + l_{1}\right)^{2} \log{\left (T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right) \right )} - \frac{l_{2}^{2} \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{3}}{3} - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right)^{2} \left(- \frac{3 P k_{\lambda} l_{2}^{2}}{2} + \frac{3 P_{r} k_{\lambda} l_{2}^{2}}{2} + l_{1} l_{2}\right) - \left(T_{\lambda ref} + k_{\lambda} \left(P - P_{r}\right)\right) \left(3 P^{2} k_{\lambda}^{2} l_{2}^{2} - 6 P P_{r} k_{\lambda}^{2} l_{2}^{2} - 4 P k_{\lambda} l_{1} l_{2} + 3 P_{r}^{2} k_{\lambda}^{2} l_{2}^{2} + 4 P_{r} k_{\lambda} l_{1} l_{2} + l_{1}^{2}\right)\right)\]</div>
</div>
</div>
<div class="section" id="id1">
<h2>Berman terms valid over an interval of T,P space<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Parameters of the Berman (1988) order-disorder model: - <span class="math notranslate nohighlight">\(d_0\)</span>,
<span class="math notranslate nohighlight">\(d_1\)</span>, <span class="math notranslate nohighlight">\(d_2\)</span>, <span class="math notranslate nohighlight">\(d_3\)</span>, <span class="math notranslate nohighlight">\(d_4\)</span>, <span class="math notranslate nohighlight">\(d_5\)</span>,
order-disorder coefficients from the Berman (1988) model -
<span class="math notranslate nohighlight">\(T_{D_{ref}}\)</span>, <span class="math notranslate nohighlight">\(T_D\)</span>, minimum, maximum temperature of
ordering interval, <span class="math notranslate nohighlight">\(T_{D_{ref}} \le T \le T_D\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d0</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">d3</span><span class="p">,</span><span class="n">d4</span><span class="p">,</span><span class="n">d5</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;d0 d1 d2 d3 d4 d5&#39;</span><span class="p">)</span>
<span class="n">TD</span><span class="p">,</span><span class="n">TDref</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_D T_D_ref&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Heat capacity of disorder at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CpDs</span> <span class="o">=</span> <span class="n">d0</span> <span class="o">+</span> <span class="n">d1</span><span class="o">/</span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">d2</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d3</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">d4</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span>
<span class="n">CpDs</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[T^{2} d_{4} + T d_{3} + d_{0} + \frac{d_{2}}{T^{2}} + \frac{d_{1}}{\sqrt{T}}\]</div>
<p>Enthalpy of disorder at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HDs</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">CpDs</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">TDref</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">sym</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">HDs</span><span class="p">,(</span><span class="n">d0</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">d3</span><span class="p">,</span><span class="n">d4</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[d_{0} \left(T - T_{D ref}\right) + d_{1} \left(2 \sqrt{T} - 2 \sqrt{T_{D ref}}\right) + d_{2} \left(\frac{1}{T_{D ref}} - \frac{1}{T}\right) + d_{3} \left(\frac{T^{2}}{2} - \frac{T_{D ref}^{2}}{2}\right) + d_{4} \left(\frac{T^{3}}{3} - \frac{T_{D ref}^{3}}{3}\right)\]</div>
<p>Entropy of disorder at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SDs</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">CpDs</span><span class="o">/</span><span class="n">T</span><span class="p">,(</span><span class="n">T</span><span class="p">,</span><span class="n">TDref</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">sym</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">SDs</span><span class="p">,(</span><span class="n">d0</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">d3</span><span class="p">,</span><span class="n">d4</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[d_{0} \left(2 \log{\left (\sqrt{T} \right )} - 2 \log{\left (\sqrt{T_{D ref}} \right )}\right) + d_{1} \left(\frac{2}{\sqrt{T_{D ref}}} - \frac{2}{\sqrt{T}}\right) + d_{2} \left(\frac{1}{2 T_{D ref}^{2}} - \frac{1}{2 T^{2}}\right) + d_{3} \left(T - T_{D ref}\right) + d_{4} \left(\frac{T^{2}}{2} - \frac{T_{D ref}^{2}}{2}\right)\]</div>
<p>Volume of disorder at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VDs</span> <span class="o">=</span> <span class="n">HDs</span><span class="o">/</span><span class="n">d5</span>
<span class="n">VDs</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\frac{2 \sqrt{T} d_{1} + \frac{T^{3} d_{4}}{3} + \frac{T^{2} d_{3}}{2} + T d_{0} - 2 \sqrt{T_{D ref}} d_{1} - \frac{T_{D ref}^{3} d_{4}}{3} - \frac{T_{D ref}^{2} d_{3}}{2} - T_{D ref} d_{0} + \frac{d_{2}}{T_{D ref}} - \frac{d_{2}}{T}}{d_{5}}\]</div>
<p>Gibbs Free Energy of disorder at <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GDs</span> <span class="o">=</span> <span class="n">HDs</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">SDs</span> <span class="o">+</span> <span class="n">VDs</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">Pr</span><span class="p">)</span>
<span class="n">sym</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">GDs</span><span class="p">,(</span><span class="n">d0</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">d3</span><span class="p">,</span><span class="n">d4</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[- T \left(\frac{T^{2} d_{4}}{2} + T d_{3} - \frac{T_{D ref}^{2} d_{4}}{2} - T_{D ref} d_{3} + 2 d_{0} \log{\left (\sqrt{T} \right )} - 2 d_{0} \log{\left (\sqrt{T_{D ref}} \right )} + \frac{d_{2}}{2 T_{D ref}^{2}} + \frac{2 d_{1}}{\sqrt{T_{D ref}}} - \frac{d_{2}}{2 T^{2}} - \frac{2 d_{1}}{\sqrt{T}}\right) + d_{0} \left(T - T_{D ref}\right) + d_{1} \left(2 \sqrt{T} - 2 \sqrt{T_{D ref}}\right) + d_{2} \left(\frac{1}{T_{D ref}} - \frac{1}{T}\right) + d_{3} \left(\frac{T^{2}}{2} - \frac{T_{D ref}^{2}}{2}\right) + d_{4} \left(\frac{T^{3}}{3} - \frac{T_{D ref}^{3}}{3}\right) + \frac{\left(P - P_{r}\right) \left(2 \sqrt{T} d_{1} + \frac{T^{3} d_{4}}{3} + \frac{T^{2} d_{3}}{2} + T d_{0} - 2 \sqrt{T_{D ref}} d_{1} - \frac{T_{D ref}^{3} d_{4}}{3} - \frac{T_{D ref}^{2} d_{3}}{2} - T_{D ref} d_{0} + \frac{d_{2}}{T_{D ref}} - \frac{d_{2}}{T}\right)}{d_{5}}\]</div>
<div class="section" id="disordering-gibbs-energy-at-t-d">
<h3>Disordering Gibbs energy at <span class="math notranslate nohighlight">\(T_D\)</span><a class="headerlink" href="#disordering-gibbs-energy-at-t-d" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GDsAtTD</span> <span class="o">=</span> <span class="n">GDs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">TD</span><span class="p">)</span>
<span class="n">GDsAtTD</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[2 \sqrt{T_{D}} d_{1} + \frac{T_{D}^{3} d_{4}}{3} + \frac{T_{D}^{2} d_{3}}{2} + T_{D} d_{0} - T_{D} \left(\frac{T_{D}^{2} d_{4}}{2} + T_{D} d_{3} - \frac{T_{D ref}^{2} d_{4}}{2} - T_{D ref} d_{3} + 2 d_{0} \log{\left (\sqrt{T_{D}} \right )} - 2 d_{0} \log{\left (\sqrt{T_{D ref}} \right )} + \frac{d_{2}}{2 T_{D ref}^{2}} + \frac{2 d_{1}}{\sqrt{T_{D ref}}} - \frac{d_{2}}{2 T_{D}^{2}} - \frac{2 d_{1}}{\sqrt{T_{D}}}\right) - 2 \sqrt{T_{D ref}} d_{1} - \frac{T_{D ref}^{3} d_{4}}{3} - \frac{T_{D ref}^{2} d_{3}}{2} - T_{D ref} d_{0} + \frac{\left(P - P_{r}\right) \left(2 \sqrt{T_{D}} d_{1} + \frac{T_{D}^{3} d_{4}}{3} + \frac{T_{D}^{2} d_{3}}{2} + T_{D} d_{0} - 2 \sqrt{T_{D ref}} d_{1} - \frac{T_{D ref}^{3} d_{4}}{3} - \frac{T_{D ref}^{2} d_{3}}{2} - T_{D ref} d_{0} + \frac{d_{2}}{T_{D ref}} - \frac{d_{2}}{T_{D}}\right)}{d_{5}} + \frac{d_{2}}{T_{D ref}} - \frac{d_{2}}{T_{D}}\]</div>
</div>
<div class="section" id="above-t-d-the-following-term-is-convenient-to-define">
<h3>Above <span class="math notranslate nohighlight">\(T_D\)</span> the following term is convenient to define<a class="headerlink" href="#above-t-d-the-following-term-is-convenient-to-define" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GDsAboveTD</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">TD</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SDs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">TD</span><span class="p">))</span>
<span class="n">GDsAboveTD</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\left(- T + T_{D}\right) \left(\frac{T_{D}^{2} d_{4}}{2} + T_{D} d_{3} - \frac{T_{D ref}^{2} d_{4}}{2} - T_{D ref} d_{3} + 2 d_{0} \log{\left (\sqrt{T_{D}} \right )} - 2 d_{0} \log{\left (\sqrt{T_{D ref}} \right )} + \frac{d_{2}}{2 T_{D ref}^{2}} + \frac{2 d_{1}}{\sqrt{T_{D ref}}} - \frac{d_{2}}{2 T_{D}^{2}} - \frac{2 d_{1}}{\sqrt{T_{D}}}\right)\]</div>
</div>
</div>
</div>
<div class="section" id="use-code-printers-to-construct-c-package-code">
<h1>Use code printers to construct “C” package code<a class="headerlink" href="#use-code-printers-to-construct-c-package-code" title="Permalink to this headline">¶</a></h1>
<p>Make the berman_calc.h and the berman_calib.h include files</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="o">=</span> <span class="s1">&#39;berman&#39;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_TrPr&#39;</span><span class="p">,</span> <span class="s1">&#39;S_TrPr&#39;</span><span class="p">,</span> <span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">,</span> <span class="s1">&#39;k3&#39;</span><span class="p">,</span> <span class="s1">&#39;V_TrPr&#39;</span><span class="p">,</span> <span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> \
          <span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;k_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;T_lambda_Pr&#39;</span><span class="p">,</span> <span class="s1">&#39;T_lambda_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;H_t&#39;</span><span class="p">,</span> \
          <span class="s1">&#39;d0&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4&#39;</span><span class="p">,</span> <span class="s1">&#39;d5&#39;</span><span class="p">,</span> <span class="s1">&#39;T_D&#39;</span><span class="p">,</span> <span class="s1">&#39;T_D_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;T_r&#39;</span><span class="p">,</span> <span class="s1">&#39;P_r&#39;</span><span class="p">]</span>
<span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;J/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K^(1/2)-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J-K/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J-K^2/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/bar&#39;</span><span class="p">,</span> <span class="s1">&#39;1/bar&#39;</span><span class="p">,</span> <span class="s1">&#39;1/bar^2&#39;</span><span class="p">,</span> <span class="s1">&#39;1/K&#39;</span><span class="p">,</span> <span class="s1">&#39;1/K^2&#39;</span><span class="p">,</span> \
        <span class="s1">&#39;J^(1/2)/K-m^(1/2)&#39;</span><span class="p">,</span> <span class="s1">&#39;J^(1/2)/K^2-m^(1/2)&#39;</span><span class="p">,</span> <span class="s1">&#39;K/bar&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;J/m&#39;</span><span class="p">,</span> \
        <span class="s1">&#39;J/K-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K^(1/2)-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J-K/m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K^2-m&#39;</span><span class="p">,</span> <span class="s1">&#39;J/K^3-m&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Subclass the C99 code printer to expand <span class="math notranslate nohighlight">\(x^2\)</span>, <span class="math notranslate nohighlight">\(x^3\)</span>, and
<span class="math notranslate nohighlight">\(x^4\)</span> as multiplication rather than pow(x, (double)n)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.printing.ccode</span> <span class="kn">import</span> <span class="n">C99CodePrinter</span>
<span class="k">class</span> <span class="nc">SubCodePrinter</span><span class="p">(</span><span class="n">C99CodePrinter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_print_Pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_integer</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">exp</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;)*(&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">)])</span>
            <span class="k">return</span> <span class="s1">&#39;((&#39;</span> <span class="o">+</span> <span class="n">result</span> <span class="o">+</span> <span class="s1">&#39;))&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_print_Pow</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="n">printer</span> <span class="o">=</span> <span class="n">SubCodePrinter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.printing.codeprinter</span> <span class="kn">import</span> <span class="n">Assignment</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Tr</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;T_r + 2&#39;</span>
</pre></div>
</div>
<p>Function template for primary routines in berman_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>mkdir -p working
<span class="o">%</span><span class="k">cd</span> working
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span><span class="o">/</span><span class="n">working</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_calc_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_</span><span class="si">{func}</span><span class="s2">(double T, double P) {{</span>
<span class="s2">    double result = </span><span class="si">{g_code}</span><span class="s2">;</span>
<span class="s2">    if ((l1 != 0.0) || (l2 != 0.0)) {{</span>
<span class="s2">      if (((</span><span class="si">{tlmin}</span><span class="s2">) &lt; T) &amp;&amp; ((</span><span class="si">{tlmax}</span><span class="s2">) &gt;= T)) {{</span>
<span class="s2">        result += </span><span class="si">{gl_code}</span><span class="s2">;</span>
<span class="s2">      }} else if (T &gt; (</span><span class="si">{tlmax}</span><span class="s2">)) {{</span>
<span class="s2">        result += </span><span class="si">{glmax_code}</span><span class="s2">;</span>
<span class="s2">      }}</span>
<span class="s2">    }}</span>
<span class="s2">    if ((H_t != 0.0) &amp;&amp; (T &gt;= (</span><span class="si">{tlmax}</span><span class="s2">))) {{</span>
<span class="s2">      result += </span><span class="si">{glabove_code}</span><span class="s2">;</span>
<span class="s2">    }}</span>
<span class="s2">    if ((d0 != 0.0) || (d1 != 0.0) || (d2 != 0.0) || (d3 != 0.0) || (d4 != 0.0) || (d5 != 0.0)) {{</span>
<span class="s2">      if ((T_D_ref &lt; T) &amp;&amp; (T_D &gt; T)) {{</span>
<span class="s2">        result += </span><span class="si">{gd_code}</span><span class="s2">;</span>
<span class="s2">      }} else if (T &gt;= T_D) {{</span>
<span class="s2">        result += </span><span class="si">{gdmax_code}</span><span class="s2">;</span>
<span class="s2">        result += </span><span class="si">{gdabove_code}</span><span class="s2">;</span>
<span class="s2">      }}</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>
<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Primary routines in berman_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;dgdt&#39;</span><span class="p">,</span> <span class="s1">&#39;dgdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdt2&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdtdp&#39;</span><span class="p">,</span> <span class="s1">&#39;d2gdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdt3&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdt2dp&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdtdp2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3gdp3&#39;</span><span class="p">]</span>
<span class="n">G_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">G</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                       <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">Gl_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">Gl</span><span class="p">,</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                        <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">Gl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">GatTl_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">GatTl</span><span class="p">,</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                           <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                           <span class="n">GatTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">GaboveTl_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">GaboveTl</span><span class="p">,</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> \
                              <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> \
                              <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GaboveTl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">GDs_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">GDs</span><span class="p">,</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                         <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">GDsAtTD_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">GDsAtTD</span><span class="p">,</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                             <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> \
                             <span class="n">GDsAtTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
<span class="n">GDsAboveTD_matrix</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">GDsAboveTD</span><span class="p">,</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> \
                                <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">),</span> \
                                <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">),</span> <span class="n">GDsAboveTD</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_calc</span> <span class="o">=</span> <span class="s1">&#39;#include &lt;math.h&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">)):</span>
    <span class="n">berman_calc</span> <span class="o">+=</span> <span class="n">berman_calc_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                              <span class="n">func</span><span class="o">=</span><span class="n">f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                              <span class="n">g_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">tlmin</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">tr</span><span class="p">),</span> \
                              <span class="n">tlmax</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Tl</span><span class="p">),</span> \
                              <span class="n">gl_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Gl_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">glmax_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GatTl_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">glabove_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GaboveTl_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">gd_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDs_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">gdmax_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDsAtTD_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
                              <span class="n">gdabove_code</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDsAboveTD_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                             <span class="p">)</span>
</pre></div>
</div>
<p>Add convenience routiines to berman_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convenience_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_s(double T, double P) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_dgdt(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_v(double T, double P) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_cv(double T, double P) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P);</span>
<span class="s2">    double dvdt = </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P);</span>
<span class="s2">    double dvdp = </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P);</span>
<span class="s2">    result += T*dvdt*dvdt/dvdp;</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_cp(double T, double P) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P) {{</span>
<span class="s2">    double result = -T*</span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P) - </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_alpha(double T, double P) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P)/</span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_beta(double T, double P) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P)/</span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_K(double T, double P) {{</span>
<span class="s2">    double result = -</span><span class="si">{module}</span><span class="s2">_dgdp(T, P)/</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P);</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_Kp(double T, double P) {{</span>
<span class="s2">    double result = </span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">    result *= </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P);</span>
<span class="s2">    result /= pow(</span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P), 2.0);</span>
<span class="s2">    return result - 1.0;</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_calc</span> <span class="o">+=</span> <span class="n">convenience_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">)</span>
</pre></div>
</div>
<p>Write contents to berman_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(berman_calc)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;berman_calc.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_calc</span><span class="p">)</span>
</pre></div>
</div>
<p>Function template for primary routines in berman_calc.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_calib_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">#include &lt;math.h&gt;</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_dparam_</span><span class="si">{func}</span><span class="s2">(double T, double P, int index) {{</span>
<span class="s2">    double result = 0.0;</span>
<span class="s2">    switch (index) {{</span>
<span class="s2">    case 0:</span>
<span class="s2">        result += </span><span class="si">{g_code[0]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 1:</span>
<span class="s2">        result += </span><span class="si">{g_code[1]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 2:</span>
<span class="s2">        result += </span><span class="si">{g_code[2]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 3:</span>
<span class="s2">        result += </span><span class="si">{g_code[3]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 4:</span>
<span class="s2">        result += </span><span class="si">{g_code[4]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 5:</span>
<span class="s2">        result += </span><span class="si">{g_code[5]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 6:</span>
<span class="s2">        result += </span><span class="si">{g_code[6]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 7:</span>
<span class="s2">        result += </span><span class="si">{g_code[7]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 8:</span>
<span class="s2">        result += </span><span class="si">{g_code[8]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 9:</span>
<span class="s2">        result += </span><span class="si">{g_code[9]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 10:</span>
<span class="s2">        result += </span><span class="si">{g_code[10]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 25:</span>
<span class="s2">        result += </span><span class="si">{g_code[25]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 26:</span>
<span class="s2">        result += </span><span class="si">{g_code[26]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    default:</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">    if ((l1 != 0.0) || (l2 != 0.0)) {{</span>
<span class="s2">      if (((</span><span class="si">{tlmin}</span><span class="s2">) &lt; T) &amp;&amp; ((</span><span class="si">{tlmax}</span><span class="s2">) &gt; T)) {{</span>
<span class="s2">        switch (index) {{</span>
<span class="s2">        case 11:</span>
<span class="s2">            result += </span><span class="si">{gl_code[11]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 12:</span>
<span class="s2">            result += </span><span class="si">{gl_code[12]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 13:</span>
<span class="s2">            result += </span><span class="si">{gl_code[13]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 14:</span>
<span class="s2">            result += </span><span class="si">{gl_code[14]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 15:</span>
<span class="s2">            result += </span><span class="si">{gl_code[15]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        default:</span>
<span class="s2">            break;</span>
<span class="s2">        }}</span>
<span class="s2">      }} else if (T &gt;= (</span><span class="si">{tlmax}</span><span class="s2">)) {{</span>
<span class="s2">        switch (index) {{</span>
<span class="s2">        case 11:</span>
<span class="s2">            result += </span><span class="si">{glmax_code[11]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 12:</span>
<span class="s2">            result += </span><span class="si">{glmax_code[12]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 13:</span>
<span class="s2">            result += </span><span class="si">{glmax_code[13]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 14:</span>
<span class="s2">            result += </span><span class="si">{glmax_code[14]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 15:</span>
<span class="s2">            result += </span><span class="si">{glmax_code[15]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        default:</span>
<span class="s2">            break;</span>
<span class="s2">        }}</span>
<span class="s2">      }}</span>
<span class="s2">    }}</span>
<span class="s2">    if ((H_t != 0.0) &amp;&amp; (T &gt;= (</span><span class="si">{tlmax}</span><span class="s2">))) {{</span>
<span class="s2">      switch (index) {{</span>
<span class="s2">        case 16:</span>
<span class="s2">            result += </span><span class="si">{glabove_code[16]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        default:</span>
<span class="s2">            break;</span>
<span class="s2">        }}</span>
<span class="s2">    }}</span>
<span class="s2">    if ((d0 != 0.0) || (d1 != 0.0) || (d2 != 0.0) || (d3 != 0.0) || (d4 != 0.0) || (d5 != 0.0)) {{</span>
<span class="s2">      if ((T_D_ref &lt; T) &amp;&amp; (T_D &gt; T)) {{</span>
<span class="s2">        switch (index) {{</span>
<span class="s2">        case 17:</span>
<span class="s2">            result += </span><span class="si">{gd_code[17]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 18:</span>
<span class="s2">            result += </span><span class="si">{gd_code[18]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 19:</span>
<span class="s2">            result += </span><span class="si">{gd_code[19]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 20:</span>
<span class="s2">            result += </span><span class="si">{gd_code[20]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 21:</span>
<span class="s2">            result += </span><span class="si">{gd_code[21]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 22:</span>
<span class="s2">            result += </span><span class="si">{gd_code[22]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 23:</span>
<span class="s2">            result += </span><span class="si">{gd_code[23]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 24:</span>
<span class="s2">            result += </span><span class="si">{gd_code[24]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        default:</span>
<span class="s2">            break;</span>
<span class="s2">        }}</span>
<span class="s2">      }} else if (T &gt;= T_D) {{</span>
<span class="s2">        switch (index) {{</span>
<span class="s2">        case 17:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[17]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[17]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 18:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[18]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[18]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 19:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[19]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[19]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 20:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[20]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[20]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 21:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[21]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[21]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 22:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[22]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[22]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 23:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[23]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[23]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        case 24:</span>
<span class="s2">            result += </span><span class="si">{gdmax_code[24]}</span><span class="s2">;</span>
<span class="s2">            result += </span><span class="si">{gdabove_code[24]}</span><span class="s2">;</span>
<span class="s2">            break;</span>
<span class="s2">        default:</span>
<span class="s2">            break;</span>
<span class="s2">        }}</span>
<span class="s2">      }}</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>
<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symparam</span> <span class="o">=</span> <span class="n">HTrPr</span><span class="p">,</span> <span class="n">STrPr</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">VTrPr</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">kl</span><span class="p">,</span> <span class="n">TlPr</span><span class="p">,</span> <span class="n">Tlref</span><span class="p">,</span> <span class="n">deltaHt</span><span class="p">,</span> \
           <span class="n">d0</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d5</span><span class="p">,</span> <span class="n">TD</span><span class="p">,</span> <span class="n">TDref</span><span class="p">,</span> <span class="n">Tr</span><span class="p">,</span> <span class="n">Pr</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">G_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">Gl_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Gl_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">GatTl_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">GatTl_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">GaboveTl_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">GaboveTl_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">GDs_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">GDs_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">GDsAtTD_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">GDsAtTD_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
<span class="n">GDsAboveTD_param_jac</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">GDsAboveTD_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">symparam</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_calib</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">)):</span>
    <span class="n">G_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">G_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">Gl_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Gl_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">GatTl_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GatTl_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">GaboveTl_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GaboveTl_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">GDs_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDs_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">GDsAtTD_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDsAtTD_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>
    <span class="n">GDsAboveTD_jac_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">GDsAboveTD_param_jac</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">]</span>

    <span class="n">berman_calib</span> <span class="o">+=</span> <span class="n">berman_calib_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                              <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                              <span class="n">func</span><span class="o">=</span><span class="n">f_list</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                              <span class="n">g_code</span><span class="o">=</span><span class="n">G_jac_list</span><span class="p">,</span> \
                              <span class="n">tlmin</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">tr</span><span class="p">),</span> \
                              <span class="n">tlmax</span><span class="o">=</span><span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">Tl</span><span class="p">),</span> \
                              <span class="n">gl_code</span><span class="o">=</span><span class="n">Gl_jac_list</span><span class="p">,</span> \
                              <span class="n">glmax_code</span><span class="o">=</span><span class="n">GatTl_jac_list</span><span class="p">,</span> \
                              <span class="n">glabove_code</span><span class="o">=</span><span class="n">GaboveTl_jac_list</span><span class="p">,</span> \
                              <span class="n">gd_code</span><span class="o">=</span><span class="n">GDs_jac_list</span><span class="p">,</span> \
                              <span class="n">gdmax_code</span><span class="o">=</span><span class="n">GDsAtTD_jac_list</span><span class="p">,</span> \
                              <span class="n">gdabove_code</span><span class="o">=</span><span class="n">GDsAboveTD_jac_list</span>
                             <span class="p">)</span>
</pre></div>
</div>
<p>Add convenience routines to berman_calib.h</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_get_param_number(void) {{</span>
<span class="s2">    return </span><span class="si">{number_params}</span><span class="s2">;</span>
<span class="s2">}}</span>

<span class="s2">static const char *paramNames[</span><span class="si">{number_params}</span><span class="s2">] = </span><span class="si">{names_params}</span><span class="s2">;</span>
<span class="s2">static const char *paramUnits[</span><span class="si">{number_params}</span><span class="s2">] = </span><span class="si">{units_params}</span><span class="s2">;</span>

<span class="s2">static const char **</span><span class="si">{module}</span><span class="s2">_get_param_names(void) {{</span>
<span class="s2">    return paramNames;</span>
<span class="s2">}}</span>

<span class="s2">static const char **</span><span class="si">{module}</span><span class="s2">_get_param_units(void) {{</span>
<span class="s2">    return paramUnits;</span>
<span class="s2">}}</span>

<span class="s2">static void </span><span class="si">{module}</span><span class="s2">_get_param_values(double *values) {{</span>
<span class="s2">    values[ 0] = </span><span class="si">{value_params[0]}</span><span class="s2">;</span>
<span class="s2">    values[ 1] = </span><span class="si">{value_params[1]}</span><span class="s2">;</span>
<span class="s2">    values[ 2] = </span><span class="si">{value_params[2]}</span><span class="s2">;</span>
<span class="s2">    values[ 3] = </span><span class="si">{value_params[3]}</span><span class="s2">;</span>
<span class="s2">    values[ 4] = </span><span class="si">{value_params[4]}</span><span class="s2">;</span>
<span class="s2">    values[ 5] = </span><span class="si">{value_params[5]}</span><span class="s2">;</span>
<span class="s2">    values[ 6] = </span><span class="si">{value_params[6]}</span><span class="s2">;</span>
<span class="s2">    values[ 7] = </span><span class="si">{value_params[7]}</span><span class="s2">;</span>
<span class="s2">    values[ 8] = </span><span class="si">{value_params[8]}</span><span class="s2">;</span>
<span class="s2">    values[ 9] = </span><span class="si">{value_params[9]}</span><span class="s2">;</span>
<span class="s2">    values[10] = </span><span class="si">{value_params[10]}</span><span class="s2">;</span>
<span class="s2">    values[11] = </span><span class="si">{value_params[11]}</span><span class="s2">;</span>
<span class="s2">    values[12] = </span><span class="si">{value_params[12]}</span><span class="s2">;</span>
<span class="s2">    values[13] = </span><span class="si">{value_params[13]}</span><span class="s2">;</span>
<span class="s2">    values[14] = </span><span class="si">{value_params[14]}</span><span class="s2">;</span>
<span class="s2">    values[15] = </span><span class="si">{value_params[15]}</span><span class="s2">;</span>
<span class="s2">    values[16] = </span><span class="si">{value_params[16]}</span><span class="s2">;</span>
<span class="s2">    values[17] = </span><span class="si">{value_params[17]}</span><span class="s2">;</span>
<span class="s2">    values[18] = </span><span class="si">{value_params[18]}</span><span class="s2">;</span>
<span class="s2">    values[19] = </span><span class="si">{value_params[19]}</span><span class="s2">;</span>
<span class="s2">    values[20] = </span><span class="si">{value_params[20]}</span><span class="s2">;</span>
<span class="s2">    values[21] = </span><span class="si">{value_params[21]}</span><span class="s2">;</span>
<span class="s2">    values[22] = </span><span class="si">{value_params[22]}</span><span class="s2">;</span>
<span class="s2">    values[23] = </span><span class="si">{value_params[23]}</span><span class="s2">;</span>
<span class="s2">    values[24] = </span><span class="si">{value_params[24]}</span><span class="s2">;</span>
<span class="s2">    values[25] = </span><span class="si">{value_params[25]}</span><span class="s2">;</span>
<span class="s2">    values[26] = </span><span class="si">{value_params[26]}</span><span class="s2">;</span>
<span class="s2">}}</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_set_param_values(double *values) {{</span>
<span class="s2">    </span><span class="si">{value_params[0]}</span><span class="s2">  = values[ 0];</span>
<span class="s2">    </span><span class="si">{value_params[1]}</span><span class="s2">  = values[ 1];</span>
<span class="s2">    </span><span class="si">{value_params[2]}</span><span class="s2">  = values[ 2];</span>
<span class="s2">    </span><span class="si">{value_params[3]}</span><span class="s2">  = values[ 3];</span>
<span class="s2">    </span><span class="si">{value_params[4]}</span><span class="s2">  = values[ 4];</span>
<span class="s2">    </span><span class="si">{value_params[5]}</span><span class="s2">  = values[ 5];</span>
<span class="s2">    </span><span class="si">{value_params[6]}</span><span class="s2">  = values[ 6];</span>
<span class="s2">    </span><span class="si">{value_params[7]}</span><span class="s2">  = values[ 7];</span>
<span class="s2">    </span><span class="si">{value_params[8]}</span><span class="s2">  = values[ 8];</span>
<span class="s2">    </span><span class="si">{value_params[9]}</span><span class="s2">  = values[ 9];</span>
<span class="s2">    </span><span class="si">{value_params[10]}</span><span class="s2"> = values[10];</span>
<span class="s2">    </span><span class="si">{value_params[11]}</span><span class="s2"> = values[11];</span>
<span class="s2">    </span><span class="si">{value_params[12]}</span><span class="s2"> = values[12];</span>
<span class="s2">    </span><span class="si">{value_params[13]}</span><span class="s2"> = values[13];</span>
<span class="s2">    </span><span class="si">{value_params[14]}</span><span class="s2"> = values[14];</span>
<span class="s2">    </span><span class="si">{value_params[15]}</span><span class="s2"> = values[15];</span>
<span class="s2">    </span><span class="si">{value_params[16]}</span><span class="s2"> = values[16];</span>
<span class="s2">    </span><span class="si">{value_params[17]}</span><span class="s2"> = values[17];</span>
<span class="s2">    </span><span class="si">{value_params[18]}</span><span class="s2"> = values[18];</span>
<span class="s2">    </span><span class="si">{value_params[19]}</span><span class="s2"> = values[19];</span>
<span class="s2">    </span><span class="si">{value_params[20]}</span><span class="s2"> = values[20];</span>
<span class="s2">    </span><span class="si">{value_params[21]}</span><span class="s2"> = values[21];</span>
<span class="s2">    </span><span class="si">{value_params[22]}</span><span class="s2"> = values[22];</span>
<span class="s2">    </span><span class="si">{value_params[23]}</span><span class="s2"> = values[23];</span>
<span class="s2">    </span><span class="si">{value_params[24]}</span><span class="s2"> = values[24];</span>
<span class="s2">    </span><span class="si">{value_params[25]}</span><span class="s2"> = values[25];</span>
<span class="s2">    </span><span class="si">{value_params[26]}</span><span class="s2"> = values[26];</span>
<span class="s2">    return 1;</span>
<span class="s2">}}</span>

<span class="s2">static double </span><span class="si">{module}</span><span class="s2">_get_param_value(int index) {{</span>
<span class="s2">    double result = 0.0;</span>
<span class="s2">    switch (index) {{</span>
<span class="s2">    case 0:</span>
<span class="s2">        result = </span><span class="si">{value_params[0]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 1:</span>
<span class="s2">        result = </span><span class="si">{value_params[1]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 2:</span>
<span class="s2">        result = </span><span class="si">{value_params[2]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 3:</span>
<span class="s2">        result = </span><span class="si">{value_params[3]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 4:</span>
<span class="s2">        result = </span><span class="si">{value_params[4]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 5:</span>
<span class="s2">        result = </span><span class="si">{value_params[5]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 6:</span>
<span class="s2">        result = </span><span class="si">{value_params[6]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 7:</span>
<span class="s2">        result = </span><span class="si">{value_params[7]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 8:</span>
<span class="s2">        result = </span><span class="si">{value_params[8]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 9:</span>
<span class="s2">        result = </span><span class="si">{value_params[9]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 10:</span>
<span class="s2">        result = </span><span class="si">{value_params[10]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 11:</span>
<span class="s2">        result = </span><span class="si">{value_params[11]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 12:</span>
<span class="s2">        result = </span><span class="si">{value_params[12]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 13:</span>
<span class="s2">        result = </span><span class="si">{value_params[13]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 14:</span>
<span class="s2">        result = </span><span class="si">{value_params[14]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 15:</span>
<span class="s2">        result = </span><span class="si">{value_params[15]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 16:</span>
<span class="s2">        result = </span><span class="si">{value_params[16]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 17:</span>
<span class="s2">        result = </span><span class="si">{value_params[17]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 18:</span>
<span class="s2">        result = </span><span class="si">{value_params[18]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 19:</span>
<span class="s2">        result = </span><span class="si">{value_params[19]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 20:</span>
<span class="s2">        result = </span><span class="si">{value_params[20]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 21:</span>
<span class="s2">        result = </span><span class="si">{value_params[21]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 22:</span>
<span class="s2">        result = </span><span class="si">{value_params[22]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 23:</span>
<span class="s2">        result = </span><span class="si">{value_params[23]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 24:</span>
<span class="s2">        result = </span><span class="si">{value_params[24]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 25:</span>
<span class="s2">        result = </span><span class="si">{value_params[25]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    case 26:</span>
<span class="s2">        result = </span><span class="si">{value_params[26]}</span><span class="s2">;</span>
<span class="s2">        break;</span>
<span class="s2">    default:</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="s2">static int </span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value) {{</span>
<span class="s2">    int result = 1;</span>
<span class="s2">    switch (index) {{</span>
<span class="s2">    case 0:</span>
<span class="s2">        </span><span class="si">{value_params[0]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 1:</span>
<span class="s2">        </span><span class="si">{value_params[1]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 2:</span>
<span class="s2">        </span><span class="si">{value_params[2]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 3:</span>
<span class="s2">        </span><span class="si">{value_params[3]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 4:</span>
<span class="s2">        </span><span class="si">{value_params[4]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 5:</span>
<span class="s2">        </span><span class="si">{value_params[5]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 6:</span>
<span class="s2">        </span><span class="si">{value_params[6]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 7:</span>
<span class="s2">        </span><span class="si">{value_params[7]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 8:</span>
<span class="s2">        </span><span class="si">{value_params[8]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 9:</span>
<span class="s2">        </span><span class="si">{value_params[9]}</span><span class="s2">  = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 10:</span>
<span class="s2">        </span><span class="si">{value_params[10]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 11:</span>
<span class="s2">        </span><span class="si">{value_params[11]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 12:</span>
<span class="s2">        </span><span class="si">{value_params[12]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 13:</span>
<span class="s2">        </span><span class="si">{value_params[13]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 14:</span>
<span class="s2">        </span><span class="si">{value_params[14]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 15:</span>
<span class="s2">        </span><span class="si">{value_params[15]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 16:</span>
<span class="s2">        </span><span class="si">{value_params[16]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 17:</span>
<span class="s2">        </span><span class="si">{value_params[17]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 18:</span>
<span class="s2">        </span><span class="si">{value_params[18]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 19:</span>
<span class="s2">        </span><span class="si">{value_params[19]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 20:</span>
<span class="s2">        </span><span class="si">{value_params[20]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 21:</span>
<span class="s2">        </span><span class="si">{value_params[21]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 22:</span>
<span class="s2">        </span><span class="si">{value_params[22]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 23:</span>
<span class="s2">        </span><span class="si">{value_params[23]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 24:</span>
<span class="s2">        </span><span class="si">{value_params[24]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 25:</span>
<span class="s2">        </span><span class="si">{value_params[25]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    case 26:</span>
<span class="s2">        </span><span class="si">{value_params[26]}</span><span class="s2"> = value;</span>
<span class="s2">        break;</span>
<span class="s2">    default:</span>
<span class="s2">        result = 0;</span>
<span class="s2">        break;</span>
<span class="s2">    }}</span>
<span class="s2">    return result;</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">berman_calib</span> <span class="o">+=</span> <span class="n">extra_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
                                      <span class="n">number_params</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> \
                                      <span class="n">names_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span> \
                                      <span class="n">units_params</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;}&#39;</span><span class="p">),</span> \
                                      <span class="n">value_params</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(berman_calib)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;berman_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_calib</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="get-the-berman-1988-database-as-a-pandas-data-frame">
<h1>Get the Berman (1988) database as a Panda’s data frame<a class="headerlink" href="#get-the-berman-1988-database-as-a-pandas-data-frame" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berman_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;../berman_1988.json&#39;</span><span class="p">)</span>
<span class="n">berman_df</span><span class="p">[</span><span class="s1">&#39;T_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">298.15</span>
<span class="n">berman_df</span><span class="p">[</span><span class="s1">&#39;P_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">berman_df</span> <span class="o">=</span> <span class="n">berman_df</span><span class="p">[[</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span> <span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">]</span>
<span class="n">berman_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#print(berman_df.head())</span>
<span class="c1">#print(list(berman_df))</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">berman_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">42</span><span class="p">,:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(1)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="c1">#print(printer.doprint(Assignment(symparam[0], row[params[0]])))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Potassium_Feldspar</span>
<span class="n">KAlSi3O8</span>
<span class="n">H_TrPr</span> <span class="o">-</span><span class="mf">3970790.781</span>
<span class="n">H_TrPr</span>         <span class="o">-</span><span class="mf">3.97079e+06</span>
<span class="n">S_TrPr</span>              <span class="mf">214.145</span>
<span class="n">k0</span>                  <span class="mf">381.372</span>
<span class="n">k1</span>                 <span class="o">-</span><span class="mf">1941.05</span>
<span class="n">k2</span>                <span class="o">-</span><span class="mi">12037252</span>
<span class="n">k3</span>               <span class="mi">1836425472</span>
<span class="n">V_TrPr</span>               <span class="mf">10.869</span>
<span class="n">v1</span>              <span class="o">-</span><span class="mf">1.8045e-06</span>
<span class="n">v2</span>                        <span class="mi">0</span>
<span class="n">v3</span>              <span class="mf">1.51451e-05</span>
<span class="n">v4</span>                  <span class="mf">5.5e-09</span>
<span class="n">l1</span>                        <span class="mi">0</span>
<span class="n">l2</span>                        <span class="mi">0</span>
<span class="n">k_lambda</span>                  <span class="mi">0</span>
<span class="n">T_lambda_Pr</span>               <span class="mi">0</span>
<span class="n">T_lambda_ref</span>              <span class="mi">0</span>
<span class="n">H_t</span>                       <span class="mi">0</span>
<span class="n">d0</span>                  <span class="mf">282.983</span>
<span class="n">d1</span>                 <span class="o">-</span><span class="mf">4831.38</span>
<span class="n">d2</span>              <span class="mf">3.62071e+06</span>
<span class="n">d3</span>                 <span class="o">-</span><span class="mf">0.15733</span>
<span class="n">d4</span>                <span class="mf">3.477e-05</span>
<span class="n">d5</span>                   <span class="mi">410630</span>
<span class="n">T_D</span>                 <span class="mf">1436.15</span>
<span class="n">T_D_ref</span>              <span class="mf">298.15</span>
<span class="n">T_r</span>                  <span class="mf">298.15</span>
<span class="n">P_r</span>                       <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elements</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../elements.csv&#39;</span><span class="p">)</span>
<span class="n">entropies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../entropies.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        Name Abbrv       MW
0      dummy     !  0.00000
1   hydrogen     H  1.00790
2     helium    He  4.00260
3    lithium    Li  6.94000
4  beryllium    Be  9.01218
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_formula</span><span class="p">(</span><span class="n">formula_string</span><span class="o">=</span><span class="s2">&quot;Si(1)O(2)&quot;</span><span class="p">):</span>
    <span class="n">formula</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">elmvector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="s1">&#39;Abbrv&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mw</span> <span class="o">+=</span> <span class="n">element</span><span class="o">.</span><span class="n">MW</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">elmvector</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span>
<span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span> <span class="o">=</span> <span class="n">parse_formula</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mw</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">elmvector</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">278.33524</span>
<span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">8.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">3.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">1.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span>
 <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_c_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static const int identifier = </span><span class="si">{git_identifier}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[0]}</span><span class="s2"> = </span><span class="si">{param_values[0]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[1]}</span><span class="s2"> = </span><span class="si">{param_values[1]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[2]}</span><span class="s2"> = </span><span class="si">{param_values[2]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[3]}</span><span class="s2"> = </span><span class="si">{param_values[3]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[4]}</span><span class="s2"> = </span><span class="si">{param_values[4]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[5]}</span><span class="s2"> = </span><span class="si">{param_values[5]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[6]}</span><span class="s2"> = </span><span class="si">{param_values[6]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[7]}</span><span class="s2"> = </span><span class="si">{param_values[7]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[8]}</span><span class="s2"> = </span><span class="si">{param_values[8]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[9]}</span><span class="s2"> = </span><span class="si">{param_values[9]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[10]}</span><span class="s2"> = </span><span class="si">{param_values[10]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[11]}</span><span class="s2"> = </span><span class="si">{param_values[11]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[12]}</span><span class="s2"> = </span><span class="si">{param_values[12]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[13]}</span><span class="s2"> = </span><span class="si">{param_values[13]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[14]}</span><span class="s2"> = </span><span class="si">{param_values[14]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[15]}</span><span class="s2"> = </span><span class="si">{param_values[15]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[16]}</span><span class="s2"> = </span><span class="si">{param_values[16]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[17]}</span><span class="s2"> = </span><span class="si">{param_values[17]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[18]}</span><span class="s2"> = </span><span class="si">{param_values[18]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[19]}</span><span class="s2"> = </span><span class="si">{param_values[19]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[20]}</span><span class="s2"> = </span><span class="si">{param_values[20]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[21]}</span><span class="s2"> = </span><span class="si">{param_values[21]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[22]}</span><span class="s2"> = </span><span class="si">{param_values[22]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[23]}</span><span class="s2"> = </span><span class="si">{param_values[23]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[24]}</span><span class="s2"> = </span><span class="si">{param_values[24]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[25]}</span><span class="s2"> = </span><span class="si">{param_values[25]}</span><span class="s2">;</span>
<span class="s2">static const double </span><span class="si">{param_names[26]}</span><span class="s2"> = </span><span class="si">{param_values[26]}</span><span class="s2">;</span>

<span class="s2">#include &quot;berman_calc.h&quot;</span>

<span class="s2">const int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_identifier(void) {{</span>
<span class="s2">    return identifier;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_name(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{phase}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_formula(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{formula}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">const double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_mw(void) {{</span>
<span class="s2">    return </span><span class="si">{mw}</span><span class="s2">;</span>
<span class="s2">}}</span>

<span class="s2">static const double elmformula[106] = {{</span>
<span class="s2">        </span><span class="si">{elmvector[0]}</span><span class="s2">,</span><span class="si">{elmvector[1]}</span><span class="s2">,</span><span class="si">{elmvector[2]}</span><span class="s2">,</span><span class="si">{elmvector[3]}</span><span class="s2">,</span><span class="si">{elmvector[4]}</span><span class="s2">,</span><span class="si">{elmvector[5]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[6]}</span><span class="s2">,</span><span class="si">{elmvector[7]}</span><span class="s2">,</span><span class="si">{elmvector[8]}</span><span class="s2">,</span><span class="si">{elmvector[9]}</span><span class="s2">,</span><span class="si">{elmvector[10]}</span><span class="s2">,</span><span class="si">{elmvector[11]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[12]}</span><span class="s2">,</span><span class="si">{elmvector[13]}</span><span class="s2">,</span><span class="si">{elmvector[14]}</span><span class="s2">,</span><span class="si">{elmvector[15]}</span><span class="s2">,</span><span class="si">{elmvector[16]}</span><span class="s2">,</span><span class="si">{elmvector[17]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[18]}</span><span class="s2">,</span><span class="si">{elmvector[19]}</span><span class="s2">,</span><span class="si">{elmvector[20]}</span><span class="s2">,</span><span class="si">{elmvector[21]}</span><span class="s2">,</span><span class="si">{elmvector[22]}</span><span class="s2">,</span><span class="si">{elmvector[23]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[24]}</span><span class="s2">,</span><span class="si">{elmvector[25]}</span><span class="s2">,</span><span class="si">{elmvector[26]}</span><span class="s2">,</span><span class="si">{elmvector[27]}</span><span class="s2">,</span><span class="si">{elmvector[28]}</span><span class="s2">,</span><span class="si">{elmvector[29]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[30]}</span><span class="s2">,</span><span class="si">{elmvector[31]}</span><span class="s2">,</span><span class="si">{elmvector[32]}</span><span class="s2">,</span><span class="si">{elmvector[33]}</span><span class="s2">,</span><span class="si">{elmvector[34]}</span><span class="s2">,</span><span class="si">{elmvector[35]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[36]}</span><span class="s2">,</span><span class="si">{elmvector[37]}</span><span class="s2">,</span><span class="si">{elmvector[38]}</span><span class="s2">,</span><span class="si">{elmvector[39]}</span><span class="s2">,</span><span class="si">{elmvector[40]}</span><span class="s2">,</span><span class="si">{elmvector[41]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[42]}</span><span class="s2">,</span><span class="si">{elmvector[43]}</span><span class="s2">,</span><span class="si">{elmvector[44]}</span><span class="s2">,</span><span class="si">{elmvector[45]}</span><span class="s2">,</span><span class="si">{elmvector[46]}</span><span class="s2">,</span><span class="si">{elmvector[47]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[48]}</span><span class="s2">,</span><span class="si">{elmvector[49]}</span><span class="s2">,</span><span class="si">{elmvector[50]}</span><span class="s2">,</span><span class="si">{elmvector[51]}</span><span class="s2">,</span><span class="si">{elmvector[52]}</span><span class="s2">,</span><span class="si">{elmvector[53]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[54]}</span><span class="s2">,</span><span class="si">{elmvector[55]}</span><span class="s2">,</span><span class="si">{elmvector[56]}</span><span class="s2">,</span><span class="si">{elmvector[57]}</span><span class="s2">,</span><span class="si">{elmvector[58]}</span><span class="s2">,</span><span class="si">{elmvector[59]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[60]}</span><span class="s2">,</span><span class="si">{elmvector[61]}</span><span class="s2">,</span><span class="si">{elmvector[62]}</span><span class="s2">,</span><span class="si">{elmvector[63]}</span><span class="s2">,</span><span class="si">{elmvector[64]}</span><span class="s2">,</span><span class="si">{elmvector[65]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[66]}</span><span class="s2">,</span><span class="si">{elmvector[67]}</span><span class="s2">,</span><span class="si">{elmvector[68]}</span><span class="s2">,</span><span class="si">{elmvector[69]}</span><span class="s2">,</span><span class="si">{elmvector[70]}</span><span class="s2">,</span><span class="si">{elmvector[71]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[72]}</span><span class="s2">,</span><span class="si">{elmvector[73]}</span><span class="s2">,</span><span class="si">{elmvector[74]}</span><span class="s2">,</span><span class="si">{elmvector[75]}</span><span class="s2">,</span><span class="si">{elmvector[76]}</span><span class="s2">,</span><span class="si">{elmvector[77]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[78]}</span><span class="s2">,</span><span class="si">{elmvector[79]}</span><span class="s2">,</span><span class="si">{elmvector[80]}</span><span class="s2">,</span><span class="si">{elmvector[81]}</span><span class="s2">,</span><span class="si">{elmvector[82]}</span><span class="s2">,</span><span class="si">{elmvector[83]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[84]}</span><span class="s2">,</span><span class="si">{elmvector[85]}</span><span class="s2">,</span><span class="si">{elmvector[86]}</span><span class="s2">,</span><span class="si">{elmvector[87]}</span><span class="s2">,</span><span class="si">{elmvector[88]}</span><span class="s2">,</span><span class="si">{elmvector[89]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[90]}</span><span class="s2">,</span><span class="si">{elmvector[91]}</span><span class="s2">,</span><span class="si">{elmvector[92]}</span><span class="s2">,</span><span class="si">{elmvector[93]}</span><span class="s2">,</span><span class="si">{elmvector[94]}</span><span class="s2">,</span><span class="si">{elmvector[95]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[96]}</span><span class="s2">,</span><span class="si">{elmvector[97]}</span><span class="s2">,</span><span class="si">{elmvector[98]}</span><span class="s2">,</span><span class="si">{elmvector[99]}</span><span class="s2">,</span><span class="si">{elmvector[100]}</span><span class="s2">,</span><span class="si">{elmvector[101]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[102]}</span><span class="s2">,</span><span class="si">{elmvector[103]}</span><span class="s2">,</span><span class="si">{elmvector[104]}</span><span class="s2">,</span><span class="si">{elmvector[105]}</span><span class="s2"></span>
<span class="s2">    }};</span>

<span class="s2">const double *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_elements(void) {{</span>
<span class="s2">    return elmformula;</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_g(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_g(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdt(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdt(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdt2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdtdp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdp2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt3(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt2dp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt2dp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdtdp2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdtdp2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdp3(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_s(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_s(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_v(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_v(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cv(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cv(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dcpdt(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_alpha(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_alpha(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_beta(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_beta(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_K(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_K(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_Kp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_Kp(T, P);</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calib_c_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">static int identifier = </span><span class="si">{git_identifier}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[0]}</span><span class="s2"> = </span><span class="si">{param_values[0]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[1]}</span><span class="s2"> = </span><span class="si">{param_values[1]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[2]}</span><span class="s2"> = </span><span class="si">{param_values[2]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[3]}</span><span class="s2"> = </span><span class="si">{param_values[3]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[4]}</span><span class="s2"> = </span><span class="si">{param_values[4]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[5]}</span><span class="s2"> = </span><span class="si">{param_values[5]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[6]}</span><span class="s2"> = </span><span class="si">{param_values[6]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[7]}</span><span class="s2"> = </span><span class="si">{param_values[7]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[8]}</span><span class="s2"> = </span><span class="si">{param_values[8]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[9]}</span><span class="s2"> = </span><span class="si">{param_values[9]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[10]}</span><span class="s2"> = </span><span class="si">{param_values[10]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[11]}</span><span class="s2"> = </span><span class="si">{param_values[11]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[12]}</span><span class="s2"> = </span><span class="si">{param_values[12]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[13]}</span><span class="s2"> = </span><span class="si">{param_values[13]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[14]}</span><span class="s2"> = </span><span class="si">{param_values[14]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[15]}</span><span class="s2"> = </span><span class="si">{param_values[15]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[16]}</span><span class="s2"> = </span><span class="si">{param_values[16]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[17]}</span><span class="s2"> = </span><span class="si">{param_values[17]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[18]}</span><span class="s2"> = </span><span class="si">{param_values[18]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[19]}</span><span class="s2"> = </span><span class="si">{param_values[19]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[20]}</span><span class="s2"> = </span><span class="si">{param_values[20]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[21]}</span><span class="s2"> = </span><span class="si">{param_values[21]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[22]}</span><span class="s2"> = </span><span class="si">{param_values[22]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[23]}</span><span class="s2"> = </span><span class="si">{param_values[23]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[24]}</span><span class="s2"> = </span><span class="si">{param_values[24]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[25]}</span><span class="s2"> = </span><span class="si">{param_values[25]}</span><span class="s2">;</span>
<span class="s2">static double </span><span class="si">{param_names[26]}</span><span class="s2"> = </span><span class="si">{param_values[26]}</span><span class="s2">;</span>

<span class="s2">#include &quot;berman_calc.h&quot;</span>
<span class="s2">#include &quot;berman_calib.h&quot;</span>

<span class="s2">const int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_identifier(void) {{</span>
<span class="s2">    return identifier;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_name(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{phase}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_formula(void) {{</span>
<span class="s2">    return &quot;</span><span class="si">{formula}</span><span class="s2">&quot;;</span>
<span class="s2">}}</span>

<span class="s2">const double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_mw(void) {{</span>
<span class="s2">    return </span><span class="si">{mw}</span><span class="s2">;</span>
<span class="s2">}}</span>

<span class="s2">static const double elmformula[106] = {{</span>
<span class="s2">        </span><span class="si">{elmvector[0]}</span><span class="s2">,</span><span class="si">{elmvector[1]}</span><span class="s2">,</span><span class="si">{elmvector[2]}</span><span class="s2">,</span><span class="si">{elmvector[3]}</span><span class="s2">,</span><span class="si">{elmvector[4]}</span><span class="s2">,</span><span class="si">{elmvector[5]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[6]}</span><span class="s2">,</span><span class="si">{elmvector[7]}</span><span class="s2">,</span><span class="si">{elmvector[8]}</span><span class="s2">,</span><span class="si">{elmvector[9]}</span><span class="s2">,</span><span class="si">{elmvector[10]}</span><span class="s2">,</span><span class="si">{elmvector[11]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[12]}</span><span class="s2">,</span><span class="si">{elmvector[13]}</span><span class="s2">,</span><span class="si">{elmvector[14]}</span><span class="s2">,</span><span class="si">{elmvector[15]}</span><span class="s2">,</span><span class="si">{elmvector[16]}</span><span class="s2">,</span><span class="si">{elmvector[17]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[18]}</span><span class="s2">,</span><span class="si">{elmvector[19]}</span><span class="s2">,</span><span class="si">{elmvector[20]}</span><span class="s2">,</span><span class="si">{elmvector[21]}</span><span class="s2">,</span><span class="si">{elmvector[22]}</span><span class="s2">,</span><span class="si">{elmvector[23]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[24]}</span><span class="s2">,</span><span class="si">{elmvector[25]}</span><span class="s2">,</span><span class="si">{elmvector[26]}</span><span class="s2">,</span><span class="si">{elmvector[27]}</span><span class="s2">,</span><span class="si">{elmvector[28]}</span><span class="s2">,</span><span class="si">{elmvector[29]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[30]}</span><span class="s2">,</span><span class="si">{elmvector[31]}</span><span class="s2">,</span><span class="si">{elmvector[32]}</span><span class="s2">,</span><span class="si">{elmvector[33]}</span><span class="s2">,</span><span class="si">{elmvector[34]}</span><span class="s2">,</span><span class="si">{elmvector[35]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[36]}</span><span class="s2">,</span><span class="si">{elmvector[37]}</span><span class="s2">,</span><span class="si">{elmvector[38]}</span><span class="s2">,</span><span class="si">{elmvector[39]}</span><span class="s2">,</span><span class="si">{elmvector[40]}</span><span class="s2">,</span><span class="si">{elmvector[41]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[42]}</span><span class="s2">,</span><span class="si">{elmvector[43]}</span><span class="s2">,</span><span class="si">{elmvector[44]}</span><span class="s2">,</span><span class="si">{elmvector[45]}</span><span class="s2">,</span><span class="si">{elmvector[46]}</span><span class="s2">,</span><span class="si">{elmvector[47]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[48]}</span><span class="s2">,</span><span class="si">{elmvector[49]}</span><span class="s2">,</span><span class="si">{elmvector[50]}</span><span class="s2">,</span><span class="si">{elmvector[51]}</span><span class="s2">,</span><span class="si">{elmvector[52]}</span><span class="s2">,</span><span class="si">{elmvector[53]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[54]}</span><span class="s2">,</span><span class="si">{elmvector[55]}</span><span class="s2">,</span><span class="si">{elmvector[56]}</span><span class="s2">,</span><span class="si">{elmvector[57]}</span><span class="s2">,</span><span class="si">{elmvector[58]}</span><span class="s2">,</span><span class="si">{elmvector[59]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[60]}</span><span class="s2">,</span><span class="si">{elmvector[61]}</span><span class="s2">,</span><span class="si">{elmvector[62]}</span><span class="s2">,</span><span class="si">{elmvector[63]}</span><span class="s2">,</span><span class="si">{elmvector[64]}</span><span class="s2">,</span><span class="si">{elmvector[65]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[66]}</span><span class="s2">,</span><span class="si">{elmvector[67]}</span><span class="s2">,</span><span class="si">{elmvector[68]}</span><span class="s2">,</span><span class="si">{elmvector[69]}</span><span class="s2">,</span><span class="si">{elmvector[70]}</span><span class="s2">,</span><span class="si">{elmvector[71]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[72]}</span><span class="s2">,</span><span class="si">{elmvector[73]}</span><span class="s2">,</span><span class="si">{elmvector[74]}</span><span class="s2">,</span><span class="si">{elmvector[75]}</span><span class="s2">,</span><span class="si">{elmvector[76]}</span><span class="s2">,</span><span class="si">{elmvector[77]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[78]}</span><span class="s2">,</span><span class="si">{elmvector[79]}</span><span class="s2">,</span><span class="si">{elmvector[80]}</span><span class="s2">,</span><span class="si">{elmvector[81]}</span><span class="s2">,</span><span class="si">{elmvector[82]}</span><span class="s2">,</span><span class="si">{elmvector[83]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[84]}</span><span class="s2">,</span><span class="si">{elmvector[85]}</span><span class="s2">,</span><span class="si">{elmvector[86]}</span><span class="s2">,</span><span class="si">{elmvector[87]}</span><span class="s2">,</span><span class="si">{elmvector[88]}</span><span class="s2">,</span><span class="si">{elmvector[89]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[90]}</span><span class="s2">,</span><span class="si">{elmvector[91]}</span><span class="s2">,</span><span class="si">{elmvector[92]}</span><span class="s2">,</span><span class="si">{elmvector[93]}</span><span class="s2">,</span><span class="si">{elmvector[94]}</span><span class="s2">,</span><span class="si">{elmvector[95]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[96]}</span><span class="s2">,</span><span class="si">{elmvector[97]}</span><span class="s2">,</span><span class="si">{elmvector[98]}</span><span class="s2">,</span><span class="si">{elmvector[99]}</span><span class="s2">,</span><span class="si">{elmvector[100]}</span><span class="s2">,</span><span class="si">{elmvector[101]}</span><span class="s2">,</span>
<span class="s2">        </span><span class="si">{elmvector[102]}</span><span class="s2">,</span><span class="si">{elmvector[103]}</span><span class="s2">,</span><span class="si">{elmvector[104]}</span><span class="s2">,</span><span class="si">{elmvector[105]}</span><span class="s2"></span>
<span class="s2">    }};</span>

<span class="s2">const double *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_elements(void) {{</span>
<span class="s2">    return elmformula;</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_g(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_g(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdt(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdt(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dgdp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdt2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdt2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdtdp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdtdp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdp2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d2gdp2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt3(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt3(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt2dp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdt2dp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdtdp2(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdtdp2(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdp3(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_d3gdp3(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_s(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_s(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_v(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_v(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cv(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cv(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_cp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dcpdt(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dcpdt(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_alpha(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_alpha(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_beta(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_beta(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_K(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_K(T, P);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_Kp(double T, double P) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_Kp(T, P);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_number(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_number();</span>
<span class="s2">}}</span>

<span class="s2">const char **</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_names(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_names();</span>
<span class="s2">}}</span>

<span class="s2">const char **</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_units(void) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_units();</span>
<span class="s2">}}</span>

<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_values(double *values) {{</span>
<span class="s2">    </span><span class="si">{module}</span><span class="s2">_get_param_values(values);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_values(double *values) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_set_param_values(values);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_value(int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_get_param_value(index);</span>
<span class="s2">}}</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_set_param_value(index, value);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_g(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_g(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdt(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_dgdt(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdp(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_dgdp(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(T, P, index);</span>
<span class="s2">}}</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(double T, double P, int index) {{</span>
<span class="s2">    return </span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(T, P, index);</span>
<span class="s2">}}</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_h_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_name(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_formula(void);</span>
<span class="s2">const double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_mw(void);</span>
<span class="s2">const double *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_elements(void);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_g(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdt(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dgdp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdt2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdtdp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d2gdp2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt3(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdt2dp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdtdp2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_d3gdp3(double T, double P);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_s(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_v(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cv(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_cp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dcpdt(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_alpha(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_beta(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_K(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_Kp(double T, double P);</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calib_h_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>

<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_name(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_formula(void);</span>
<span class="s2">const double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_mw(void);</span>
<span class="s2">const double *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_elements(void);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_g(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdt(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dgdp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdt2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdtdp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d2gdp2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt3(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdt2dp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdtdp2(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_d3gdp3(double T, double P);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_s(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_v(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cv(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_cp(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_dcpdt(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_alpha(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_beta(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_K(double T, double P);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_calib_Kp(double T, double P);</span>

<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_number(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_names(void);</span>
<span class="s2">const char *</span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_units(void);</span>
<span class="s2">void </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_values(double *values);</span>
<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_values(double *values);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_get_param_value(int index);</span>
<span class="s2">int </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_set_param_value(int index, double value);</span>

<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_g(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdt(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_dgdp(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdt2(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdtdp(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d2gdp2(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt3(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdt2dp(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdtdp2(double T, double P, int index);</span>
<span class="s2">double </span><span class="si">{phase}</span><span class="s2">_</span><span class="si">{module}</span><span class="s2">_dparam_d3gdp3(double T, double P, int index);</span>

<span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Generate both fast computation and calibibration code for each phase in
the Berman (1988) database</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">berman_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1">#range(0,1) [0,1,6,48,49,50]</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">berman_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="p">)</span>
    <span class="n">formula</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(1)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">mw</span><span class="p">,</span> <span class="n">elmvector</span> <span class="o">=</span> <span class="n">parse_formula</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Formula</span><span class="p">)</span>
    <span class="n">berman_phase_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">berman_phase_h</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">berman_phase_c</span> <span class="o">+=</span> <span class="n">fast_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
        <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> \
        <span class="n">formula</span><span class="o">=</span><span class="n">formula</span><span class="p">,</span> \
        <span class="n">mw</span><span class="o">=</span><span class="n">mw</span><span class="p">,</span> \
        <span class="n">elmvector</span><span class="o">=</span><span class="n">elmvector</span><span class="p">,</span> \
        <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> \
        <span class="n">param_values</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> \
        <span class="n">git_identifier</span><span class="o">=</span><span class="mi">1</span> \
        <span class="p">)</span>
    <span class="n">berman_phase_h</span> <span class="o">+=</span> <span class="n">fast_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_berman.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_phase_h</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_phase_c</span><span class="p">)</span>
    <span class="n">berman_phase_calib_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">berman_phase_calib_h</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">berman_phase_calib_c</span> <span class="o">+=</span> <span class="n">calib_c_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
        <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> \
        <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> \
        <span class="n">formula</span><span class="o">=</span><span class="n">formula</span><span class="p">,</span> \
        <span class="n">mw</span><span class="o">=</span><span class="n">mw</span><span class="p">,</span> \
        <span class="n">elmvector</span><span class="o">=</span><span class="n">elmvector</span><span class="p">,</span> \
        <span class="n">param_names</span><span class="o">=</span><span class="p">[</span> <span class="n">printer</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">symparam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">],</span> \
        <span class="n">param_values</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> \
        <span class="n">git_identifier</span><span class="o">=</span><span class="mi">1</span> \
        <span class="p">)</span>
    <span class="n">berman_phase_calib_h</span> <span class="o">+=</span> <span class="n">calib_h_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_berman_calib.h&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_phase_calib_h</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39;_berman_calib.c&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">berman_phase_calib_c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Akermanite</span>
<span class="n">Albite</span>
<span class="n">Ca_Al_Pyroxene</span>
<span class="n">Calcite</span>
<span class="n">Chrysotile</span>
<span class="n">Clinochlore</span>
<span class="n">Coesite</span>
<span class="n">Cordierite</span>
<span class="n">Corundum</span>
<span class="n">Alpha_Cristobalite</span>
<span class="n">Beta_Cristobalite</span>
<span class="n">Diaspore</span>
<span class="n">High_Albite</span>
<span class="n">Diopside</span>
<span class="n">Dolomite</span>
<span class="n">Clinoenstatite</span>
<span class="n">Orthoenstatite</span>
<span class="n">Protoenstatite</span>
<span class="n">Fayalite</span>
<span class="n">Ferrosilite</span>
<span class="n">Forsterite</span>
<span class="n">Gehlenite</span>
<span class="n">Grossular</span>
<span class="n">Low_Albite</span>
<span class="n">Hematite</span>
<span class="n">Ilmenite</span>
<span class="n">Jadeite</span>
<span class="n">Kaolinite</span>
<span class="n">Kyanite</span>
<span class="n">Lawsonite</span>
<span class="n">Lime</span>
<span class="n">Magnesite</span>
<span class="n">Magnetite</span>
<span class="n">Margarite</span>
<span class="n">Almandine</span>
<span class="n">Meionite</span>
<span class="n">Merwinite</span>
<span class="n">Monticellite</span>
<span class="n">Muscovite</span>
<span class="n">Paragonite</span>
<span class="n">Periclase</span>
<span class="n">Phlogopite</span>
<span class="n">Potassium_Feldspar</span>
<span class="n">Sanidine</span>
<span class="n">Microcline</span>
<span class="n">Andalusite</span>
<span class="n">Prehnite</span>
<span class="n">Pyrope</span>
<span class="n">Pyrophyllite</span>
<span class="n">A_Quartz</span>
<span class="n">B_Quartz</span>
<span class="n">Rutile</span>
<span class="n">Sillimanite</span>
<span class="n">Sphene</span>
<span class="n">Spinel</span>
<span class="n">Talc</span>
<span class="n">Anorthite</span>
<span class="n">Tremolite</span>
<span class="n">Low_Tridymite</span>
<span class="n">High_Tridymite</span>
<span class="n">Wollastonite</span>
<span class="n">Pseudowollastonite</span>
<span class="n">Zoisite</span>
<span class="n">Clinozoisite</span>
<span class="n">Carbon_Dioxide</span>
<span class="n">Water</span>
<span class="n">Oxygen_Gas</span>
<span class="n">Anthophyllite</span>
<span class="n">Sulfur_Gas</span>
<span class="n">Hydrogen_Gas</span>
<span class="n">Antigorite</span>
<span class="n">Brucite</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> cython
</pre></div>
</div>
<p>Generate the C-code and python extension</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setuptools</span><span class="o">.</span><span class="n">extension</span><span class="o">.</span><span class="n">Extension</span>
<span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">undef_macros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">library_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_library_dirs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_compile_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_link_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">export_symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">swig_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-O0, -O1, -O2, -O3, -Ofast, -Os, -Oz, -Og, -O, -O4
Specify which optimization level to use:

-O0 Means “no optimization”: this level compiles the fastest and generates the most debuggable code.

-O1 Somewhere between -O0 and -O2.

-O2 Moderate level of optimization which enables most optimizations.

-O3 Like -O2, except that it enables optimizations that take longer to perform or that may generate larger code (in an attempt to make the program run faster).

-Ofast Enables all the optimizations from -O3 along with other aggressive optimizations that may violate strict compliance with language standards.

-Os Like -O2 with extra optimizations to reduce code size.

-Oz Like -Os (and thus -O2), but reduces code size further.

-Og Like -O1. In future versions, this option might disable different optimizations in order to improve debuggability.

-O Equivalent to -O2.

-O4 and higher
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> berman.pyxbld
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="c1">#            module name specified by `%%cython_pyximport` magic</span>
<span class="c1">#            |        just `modname + &quot;.pyx&quot;`</span>
<span class="c1">#            |        |</span>
<span class="k">def</span> <span class="nf">make_ext</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">pyxfilename</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">setuptools.extension</span> <span class="kn">import</span> <span class="n">Extension</span>
    <span class="k">return</span> <span class="n">Extension</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span>
                     <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">pyxfilename</span><span class="p">,</span> <span class="s1">&#39;Akermanite_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;Akermanite_berman_calib.c&#39;</span><span class="p">,</span> \
                              <span class="s1">&#39;A_Quartz_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;A_Quartz_berman_calib.c&#39;</span><span class="p">,</span> \
                              <span class="s1">&#39;B_Quartz_berman.c&#39;</span><span class="p">,</span> <span class="s1">&#39;B_Quartz_berman_calib.c&#39;</span><span class="p">,</span> \
                             <span class="p">],</span>
                     <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">get_include</span><span class="p">()],</span> <span class="n">extra_compile_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-O3&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">berman</span><span class="o">.</span><span class="n">pyxbld</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">preallocate</span> <span class="n">our</span> <span class="n">output</span> <span class="n">array</span>
<span class="n">cdef</span> <span class="n">cnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">cnp</span><span class="o">.</span><span class="n">double_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">]</span> <span class="n">dY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="n">now</span> <span class="n">call</span> <span class="n">the</span> <span class="n">C</span> <span class="n">function</span>
<span class="n">c_odes</span><span class="p">(</span><span class="o">&lt;</span><span class="n">double</span> <span class="o">*&gt;</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">double</span> <span class="o">*&gt;</span> <span class="n">dY</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">cython_pyximport</span> berman
import numpy as np
cimport numpy as cnp # cimport gives us access to NumPy&#39;s C API

# here we just replicate the function signature from the header
cdef extern from &quot;Akermanite_berman.h&quot;:
    double Akermanite_berman_g(double t, double p)
    double Akermanite_berman_s(double t, double p)
    double Akermanite_berman_cp(double t, double p)
    double Akermanite_berman_v(double t, double p)
cdef extern from &quot;Akermanite_berman_calib.h&quot;:
    double Akermanite_berman_calib_g(double t, double p)
    double Akermanite_berman_calib_s(double t, double p)
    double Akermanite_berman_calib_cp(double t, double p)
    double Akermanite_berman_calib_v(double t, double p)
cdef extern from &quot;A_Quartz_berman.h&quot;:
    double A_Quartz_berman_g(double t, double p)
    double A_Quartz_berman_s(double t, double p)
    double A_Quartz_berman_cp(double t, double p)
    double A_Quartz_berman_v(double t, double p)
cdef extern from &quot;A_Quartz_berman_calib.h&quot;:
    double A_Quartz_berman_calib_g(double t, double p)
    double A_Quartz_berman_calib_s(double t, double p)
    double A_Quartz_berman_calib_cp(double t, double p)
    double A_Quartz_berman_calib_v(double t, double p)
cdef extern from &quot;B_Quartz_berman.h&quot;:
    double B_Quartz_berman_g(double t, double p)
    double B_Quartz_berman_s(double t, double p)
    double B_Quartz_berman_cp(double t, double p)
    double B_Quartz_berman_v(double t, double p)
cdef extern from &quot;B_Quartz_berman_calib.h&quot;:
    double B_Quartz_berman_calib_g(double t, double p)
    double B_Quartz_berman_calib_s(double t, double p)
    double B_Quartz_berman_calib_cp(double t, double p)
    double B_Quartz_berman_calib_v(double t, double p)

# here is the &quot;wrapper&quot; signature
def cy_Akermanite_berman_g(double t, double p):
    result = Akermanite_berman_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_s(double t, double p):
    result = Akermanite_berman_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_cp(double t, double p):
    result = Akermanite_berman_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_v(double t, double p):
    result = Akermanite_berman_v(&lt;double&gt; t, &lt;double&gt; p)
    return result

def cy_Akermanite_berman_calib_g(double t, double p):
    result = Akermanite_berman_calib_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_calib_s(double t, double p):
    result = Akermanite_berman_calib_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_calib_cp(double t, double p):
    result = Akermanite_berman_calib_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_Akermanite_berman_calib_v(double t, double p):
    result = Akermanite_berman_calib_v(&lt;double&gt; t, &lt;double&gt; p)
    return result

def cy_A_Quartz_berman_g(double t, double p):
    result = A_Quartz_berman_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_s(double t, double p):
    result = A_Quartz_berman_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_cp(double t, double p):
    result = A_Quartz_berman_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_v(double t, double p):
    result = A_Quartz_berman_v(&lt;double&gt; t, &lt;double&gt; p)
    return result

def cy_A_Quartz_berman_calib_g(double t, double p):
    result = A_Quartz_berman_calib_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_calib_s(double t, double p):
    result = A_Quartz_berman_calib_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_calib_cp(double t, double p):
    result = A_Quartz_berman_calib_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_A_Quartz_berman_calib_v(double t, double p):
    result = A_Quartz_berman_calib_v(&lt;double&gt; t, &lt;double&gt; p)
    return result

def cy_B_Quartz_berman_g(double t, double p):
    result = B_Quartz_berman_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_s(double t, double p):
    result = B_Quartz_berman_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_cp(double t, double p):
    result = B_Quartz_berman_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_v(double t, double p):
    result = B_Quartz_berman_v(&lt;double&gt; t, &lt;double&gt; p)
    return result

def cy_B_Quartz_berman_calib_g(double t, double p):
    result = B_Quartz_berman_calib_g(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_calib_s(double t, double p):
    result = B_Quartz_berman_calib_s(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_calib_cp(double t, double p):
    result = B_Quartz_berman_calib_cp(&lt;double&gt; t, &lt;double&gt; p)
    return result
def cy_B_Quartz_berman_calib_v(double t, double p):
    result = B_Quartz_berman_calib_v(&lt;double&gt; t, &lt;double&gt; p)
    return result
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">cd</span> ..
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">10000.0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newCodeFast</span> <span class="o">=</span> <span class="n">cy_Akermanite_berman_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">newCodeCalib</span> <span class="o">=</span> <span class="n">cy_Akermanite_berman_calib_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">newCodeFast</span><span class="p">,</span> <span class="n">newCodeCalib</span><span class="p">,</span> <span class="n">newCodeFast</span><span class="o">-</span><span class="n">newCodeCalib</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">cy_Akermanite_berman_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">cy_Akermanite_berman_calib_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">4105481.9950771444</span> <span class="o">-</span><span class="mf">4105481.9950771444</span> <span class="mf">0.0</span>
<span class="mf">523.4611502049585</span>
<span class="mf">523.4611502049585</span>
</pre></div>
</div>
<p>Compare results with the Phases Python module (wrapped Objective-C code)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">phases</span>
<span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">model</span>
<span class="n">modelDB</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Database</span><span class="p">()</span>
<span class="n">Akermanite</span> <span class="o">=</span><span class="n">modelDB</span><span class="o">.</span><span class="n">get_phase</span><span class="p">(</span><span class="s1">&#39;Ak&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Akermanite</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Akermanite</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oldCode</span> <span class="o">=</span> <span class="n">Akermanite</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">oldCode</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">oldCode</span><span class="o">-</span><span class="n">newCodeFast</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">Akermanite</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">4105478.0080570094</span>
<span class="mf">3.9870201349258423</span>
<span class="mf">523.4518527550034</span>
</pre></div>
</div>
<p>Instantiate the Objective-C code via Rubicon</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">cdll</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">util</span>
<span class="kn">from</span> <span class="nn">rubicon.objc</span> <span class="kn">import</span> <span class="n">ObjCClass</span><span class="p">,</span> <span class="n">objc_method</span>
<span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">find_library</span><span class="p">(</span><span class="s1">&#39;phaseobjc&#39;</span><span class="p">))</span>
<span class="n">AkermaniteRaw</span> <span class="o">=</span> <span class="n">ObjCClass</span><span class="p">(</span><span class="s1">&#39;AkermaniteBerman&#39;</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">AkermaniteRaw</span><span class="o">.</span><span class="n">alloc</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseName</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseFormula</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Akermanite</span>
<span class="n">Ca2MgSi2O7</span>
</pre></div>
</div>
<p>Time the fast code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_Akermanite_berman_g(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>125 ns ± 0.345 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
</pre></div>
</div>
<p>Time the calibration code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_Akermanite_berman_calib_g(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>153 ns ± 0.679 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
</pre></div>
</div>
<p>Time the Python+Rubicon wrapped Objective-C code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(Akermanite.gibbs_energy(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>84 µs ± 1.16 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
<p>Time the Rubicon wrapped Objective-C code</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(obj.getGibbsFreeEnergyFromT_andP_(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>56.3 µs ± 972 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">QuartzRaw</span> <span class="o">=</span> <span class="n">ObjCClass</span><span class="p">(</span><span class="s1">&#39;QuartzBerman&#39;</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuartzRaw</span><span class="o">.</span><span class="n">alloc</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseName</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">phaseFormula</span><span class="p">)</span>
<span class="n">QuartzRaw</span><span class="o">.</span><span class="n">disableQuartzCorrectionUsed</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">isAlphaPhaseAtT_andP_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Quartz</span>
<span class="n">SiO2</span>
<span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_g_quartz_Alpha</span> <span class="o">=</span> <span class="n">cy_A_Quartz_berman_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_s_quartz_Alpha</span> <span class="o">=</span> <span class="n">cy_A_Quartz_berman_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_cp_quartz_Alpha</span> <span class="o">=</span> <span class="n">cy_A_Quartz_berman_cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_v_quartz_Alpha</span> <span class="o">=</span> <span class="n">cy_A_Quartz_berman_v</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_g_quartz_Calib_Alpha</span> <span class="o">=</span> <span class="n">cy_A_Quartz_berman_calib_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_g_quartz_Beta</span> <span class="o">=</span> <span class="n">cy_B_Quartz_berman_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_s_quartz_Beta</span> <span class="o">=</span> <span class="n">cy_B_Quartz_berman_s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_cp_quartz_Beta</span> <span class="o">=</span> <span class="n">cy_B_Quartz_berman_cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_v_quartz_Beta</span> <span class="o">=</span> <span class="n">cy_B_Quartz_berman_v</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">new_g_quartz_Calib_Beta</span> <span class="o">=</span> <span class="n">cy_B_Quartz_berman_calib_g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">oldCode_g</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getGibbsFreeEnergyFromT_andP_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">oldCode_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getEntropyFromT_andP_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">oldCode_cp</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getHeatCapacityFromT_andP_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">oldCode_v</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getVolumeFromT_andP_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">new_g_quartz_Alpha</span><span class="p">,</span> <span class="n">new_g_quartz_Calib_Alpha</span><span class="p">,</span> <span class="n">new_g_quartz_Alpha</span><span class="o">-</span><span class="n">new_g_quartz_Calib_Alpha</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">new_g_quartz_Beta</span><span class="p">,</span> <span class="n">new_g_quartz_Calib_Beta</span><span class="p">,</span> <span class="n">new_g_quartz_Beta</span><span class="o">-</span><span class="n">new_g_quartz_Calib_Beta</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">new_g_quartz_Alpha</span><span class="o">-</span><span class="n">new_g_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">958058.6858876313</span> <span class="o">-</span><span class="mf">958058.6858876313</span> <span class="mf">0.0</span>
<span class="o">-</span><span class="mf">957890.7058826386</span> <span class="o">-</span><span class="mf">957890.7058826386</span> <span class="mf">0.0</span>
<span class="o">-</span><span class="mf">167.98000499268528</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">oldCode_g</span><span class="o">-</span><span class="n">new_g_quartz_Alpha</span><span class="p">,</span> <span class="n">oldCode_g</span><span class="o">-</span><span class="n">new_g_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">8.858848060597666</span> <span class="o">-</span><span class="mf">159.12115693208762</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">oldCode_s</span><span class="o">-</span><span class="n">new_s_quartz_Alpha</span><span class="p">,</span> <span class="n">oldCode_s</span><span class="o">-</span><span class="n">new_s_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">0.0003208644001091443</span> <span class="o">-</span><span class="mf">2.4145530879386428</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">oldCode_cp</span><span class="o">-</span><span class="n">new_cp_quartz_Alpha</span><span class="p">,</span> <span class="n">oldCode_cp</span><span class="o">-</span><span class="n">new_cp_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.01659417791225337</span> <span class="mf">7.012753660230288</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oldCode_h</span> <span class="o">=</span> <span class="n">oldCode_g</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">oldCode_s</span>
<span class="n">new_h_quartz_Alpha</span> <span class="o">=</span> <span class="n">new_g_quartz_Alpha</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">new_s_quartz_Alpha</span>
<span class="n">new_h_quartz_Beta</span> <span class="o">=</span> <span class="n">new_g_quartz_Beta</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">new_s_quartz_Beta</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">oldCode_h</span><span class="o">-</span><span class="n">new_h_quartz_Alpha</span><span class="p">,</span> <span class="n">oldCode_h</span><span class="o">-</span><span class="n">new_h_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">8.537983660469763</span> <span class="o">-</span><span class="mf">2573.674244870781</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">oldCode_v</span><span class="o">-</span><span class="n">new_v_quartz_Alpha</span><span class="p">,</span> <span class="n">oldCode_v</span><span class="o">-</span><span class="n">new_v_quartz_Beta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.00234952007086342</span> <span class="o">-</span><span class="mf">0.06335551468245093</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_A_Quartz_berman_g(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>144 ns ± 0.184 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(cy_A_Quartz_berman_calib_g(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>177 ns ± 1.4 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span>(obj.getGibbsFreeEnergyFromT_andP_(t, p))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>56 µs ± 201 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>