<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>How to import a coder generated module into ThermoEngine &mdash; Thermoengine 1.0.1 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="None"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="search" title="Search" href="search.html" >
    <link rel="top" title="Thermoengine 1.0.1 documentation" href="index.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="index.html">
      <img style="border: 0;" alt="ENKI" src="_static/img/ENKI_header.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="http://enki-portal.org">ENKI Web</a></li>
        <li class="active"><a href="https://enki.ofm-research.org">ENKI Server</a></li>
	
        <li class="active"><a href="index.html">Thermoengine 1.0.1 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Enki.png" alt="Logo">
            </a></p>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="how-to-import-a-coder-generated-module-into-thermoengine">
<h1>How to import a coder generated module into ThermoEngine<a class="headerlink" href="#how-to-import-a-coder-generated-module-into-thermoengine" title="Permalink to this headline">¶</a></h1>
<div class="section" id="demonstrates-importing-both-stoichiometric-and-solution-phase-modules">
<h2>Demonstrates importing both stoichiometric and solution phase modules<a class="headerlink" href="#demonstrates-importing-both-stoichiometric-and-solution-phase-modules" title="Permalink to this headline">¶</a></h2>
<p>import ThermoEngine libraries …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thermoengine</span> <span class="kn">import</span> <span class="n">core</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">phases</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>This notebook tests functionality of objective-C modules and <em>coder</em>
generated modules for a pure phase (“Potassium Feldspar”, “Or”) and a
solution phase (“Feldspar”, “Fsp”). Examples of producing suitable
<em>coder</em> generated modules may be found in the notebooks: -
Example-1-Berman-std-state - Example-7-Simple-Solution</p>
<p>If <em>coder</em> generated modules are tested, the code files produced by the
<em>coder</em> module must be contained in the folder <em>working</em> located in the
same directory as this notebook. This folder must also house the Cython
(module_name.pyx) and Distutil (module_name.pyxbld) files defining the
python interface to the module and the compilation/link instructions.</p>
<p>If you are testing <em>coder</em> derived modules with this notebook, ensure
that the <strong>calibration flag</strong> set below <strong>matches that specified when
the working code was generated by the coder module</strong>.</p>
</div>
<div class="section" id="options">
<h2>Options:<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p><strong>use_pure_phases</strong> - True: Run tests on the stoichiometric phase
<em>Potassium_Feldspar</em> - False: Run tests on the solution phase <em>Feldspar</em></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_pure_phase</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p><strong>use_coder_module</strong> - True: Use phase modules generated by <em>coder</em>.
Files must be avaialble in the <em>working</em> folder. They can be produced by
running notebook <em>Example-1</em> (stoichiometric phase) or <em>Example-1</em> +
<em>Example-7</em> (that together produced code for a solution phase) - False:
Use phase modules derived from the Berman (1988) database</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_coder_module</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p><strong>calib</strong> - True: Test code that implements parameter calibration
methods. If <em>coder</em> module code is used, then ensure that the <em>calib</em>
flag was set to <em>True</em> when that code was generated. - False: Test code
that does not implement the parameter calibration methods. See above.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calib</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="section" id="load-the-module-into-thermoengine">
<h2>Load the module into ThermoEngine:<a class="headerlink" href="#load-the-module-into-thermoengine" title="Permalink to this headline">¶</a></h2>
<p>Initialize a model class using the options specified above and display
some information about the model implementation …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">use_coder_module</span><span class="p">:</span>
    <span class="o">%</span><span class="k">cd</span> working
    <span class="kn">from</span> <span class="nn">pyximport</span> <span class="kn">import</span> <span class="n">install</span>
    <span class="n">install</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">Simple_Solution</span>
    <span class="o">%</span><span class="k">cd</span> ..
    <span class="n">modelDB</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Database</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">&quot;CoderModule&quot;</span><span class="p">,</span> <span class="n">calib</span><span class="o">=</span><span class="n">calib</span><span class="p">,</span>
                             <span class="n">phase_tuple</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Simple_Solution&#39;</span><span class="p">,</span> <span class="p">{</span>
                                 <span class="s1">&#39;Fsp&#39;</span><span class="p">:[</span><span class="s1">&#39;Feldspar&#39;</span><span class="p">,</span><span class="s1">&#39;solution&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;Ab&#39;</span><span class="p">:[</span><span class="s1">&#39;High_Albite&#39;</span><span class="p">,</span><span class="s1">&#39;pure&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;An&#39;</span><span class="p">:[</span><span class="s1">&#39;Anorthite&#39;</span><span class="p">,</span><span class="s1">&#39;pure&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;Or&#39;</span><span class="p">:[</span><span class="s1">&#39;Potassium_Feldspar&#39;</span><span class="p">,</span><span class="s1">&#39;pure&#39;</span><span class="p">]</span>
                             <span class="p">}))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">modelDB</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Database</span><span class="p">()</span>

<span class="k">if</span> <span class="n">use_pure_phase</span><span class="p">:</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">modelDB</span><span class="o">.</span><span class="n">get_phase</span><span class="p">(</span><span class="s1">&#39;Or&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">modelDB</span><span class="o">.</span><span class="n">get_phase</span><span class="p">(</span><span class="s1">&#39;Fsp&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">phase_name</span><span class="p">,</span> <span class="n">abbrv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">modelDB</span><span class="o">.</span><span class="n">phase_info</span><span class="o">.</span><span class="n">phase_name</span><span class="p">,</span><span class="n">modelDB</span><span class="o">.</span><span class="n">phase_info</span><span class="o">.</span><span class="n">abbrev</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Abbreviation: </span><span class="si">{0:&lt;10s}</span><span class="s1"> Name: </span><span class="si">{1:&lt;30s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">abbrv</span><span class="p">,</span> <span class="n">phase_name</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span><span class="o">/</span><span class="n">working</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ghiorso</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">ARCHIVE_XCODE</span><span class="o">/</span><span class="n">ThermoEngine</span><span class="o">/</span><span class="n">Notebooks</span><span class="o">/</span><span class="n">Codegen</span>
<span class="n">Solution</span> <span class="n">phase</span> <span class="n">code</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">the</span> <span class="n">coder</span> <span class="n">module</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">provide</span> <span class="n">information</span> <span class="n">on</span> <span class="n">solution</span> <span class="n">species</span><span class="o">.</span> <span class="n">Species</span> <span class="n">are</span> <span class="n">proxied</span> <span class="n">by</span> <span class="n">components</span><span class="o">.</span>
<span class="n">Solution</span> <span class="n">phase</span> <span class="n">code</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">the</span> <span class="n">coder</span> <span class="n">module</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">provide</span> <span class="n">information</span> <span class="n">on</span> <span class="n">species</span> <span class="n">properties</span><span class="o">.</span> <span class="n">Species</span> <span class="n">are</span> <span class="n">proxied</span> <span class="n">by</span> <span class="n">components</span><span class="o">.</span>
<span class="n">Abbreviation</span><span class="p">:</span> <span class="n">Fsp</span>        <span class="n">Name</span><span class="p">:</span> <span class="n">Feldspar</span>
<span class="n">Abbreviation</span><span class="p">:</span> <span class="n">Ab</span>         <span class="n">Name</span><span class="p">:</span> <span class="n">High_Albite</span>
<span class="n">Abbreviation</span><span class="p">:</span> <span class="n">An</span>         <span class="n">Name</span><span class="p">:</span> <span class="n">Anorthite</span>
<span class="n">Abbreviation</span><span class="p">:</span> <span class="n">Or</span>         <span class="n">Name</span><span class="p">:</span> <span class="n">Potassium_Feldspar</span>
</pre></div>
</div>
</div>
<div class="section" id="obtain-information-about-this-module">
<h2>Obtain information about this module:<a class="headerlink" href="#obtain-information-about-this-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">use_pure_phase</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;formula&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;molwt&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;abbrev&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Feldspar</span>
<span class="p">[</span><span class="s1">&#39;NaAlSi3O8&#39;</span> <span class="s1">&#39;Al2CaSi2O8&#39;</span> <span class="s1">&#39;KAlSi3O8&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mf">262.22301</span> <span class="mf">278.20928</span> <span class="mf">278.33524</span><span class="p">]</span>
<span class="n">Fsp</span>
<span class="mi">3</span>
<span class="p">[</span><span class="s1">&#39;High_Albite&#39;</span> <span class="s1">&#39;Anorthite&#39;</span> <span class="s1">&#39;Potassium_Feldspar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="for-solutions-specify-composition-of-the-phase">
<h2>For solutions, specify composition of the phase:<a class="headerlink" href="#for-solutions-specify-composition-of-the-phase" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">use_pure_phase</span><span class="p">:</span>
    <span class="n">moles_end</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">mol_oxides</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">chem</span><span class="o">.</span><span class="n">format_mol_oxide_comp</span><span class="p">({</span><span class="s1">&#39;SiO2&#39;</span><span class="p">:</span><span class="mf">67.27</span><span class="p">,</span><span class="s1">&#39;Al2O3&#39;</span><span class="p">:</span><span class="mf">18.35</span><span class="p">,</span> <span class="s1">&#39;FeO&#39;</span><span class="p">:</span><span class="mf">0.92</span><span class="p">,</span> <span class="s1">&#39;CaO&#39;</span><span class="p">:</span><span class="mf">0.15</span><span class="p">,</span>
                                                  <span class="s1">&#39;Na2O&#39;</span><span class="p">:</span><span class="mf">6.45</span><span class="p">,</span> <span class="s1">&#39;K2O&#39;</span><span class="p">:</span><span class="mf">7.05</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">0.16</span><span class="p">},</span> <span class="n">convert_grams_to_moles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">moles_end</span><span class="p">,</span><span class="n">oxide_res</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">calc_endmember_comp</span><span class="p">(</span><span class="n">mol_oxide_comp</span><span class="o">=</span><span class="n">mol_oxides</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;intrinsic&#39;</span><span class="p">,</span> <span class="n">output_residual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_num&#39;</span><span class="p">]):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;mole number of </span><span class="si">{0:10.10s}</span><span class="s2"> = </span><span class="si">{1:13.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;endmember_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">moles_end</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">phase</span><span class="o">.</span><span class="n">test_endmember_comp</span><span class="p">(</span><span class="n">moles_end</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Calculated composition is infeasible!&quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Formula: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">compute_formula</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">moles_end</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Total moles of endmembers: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">covert_endmember_comp</span><span class="p">(</span><span class="n">moles_end</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;total_moles&#39;</span><span class="p">))</span>
    <span class="n">mol_elm</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">covert_endmember_comp</span><span class="p">(</span><span class="n">moles_end</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;moles_elements&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Mole fractions of endmembers: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">covert_endmember_comp</span><span class="p">(</span><span class="n">moles_end</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mole_fraction&#39;</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Moles of endmembers: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">convert_elements</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;moles_end&#39;</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Total moles of endmembers: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">convert_elements</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;total_moles&#39;</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Total grams of phase: &#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">convert_elements</span><span class="p">(</span><span class="n">mol_elm</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;total_grams&#39;</span><span class="p">))</span>
    <span class="c1"># Check if intrinsic mode fails</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">moles_end</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Intrinsic mode returned an empty array; estimating composition ...&#39;</span><span class="p">)</span>
        <span class="n">moles_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.20813521</span><span class="p">,</span> <span class="mf">0.00267478</span><span class="p">,</span> <span class="mf">0.14968884</span><span class="p">])</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">moles_end</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mole</span> <span class="n">number</span> <span class="n">of</span> <span class="n">High_Albit</span> <span class="o">=</span>  <span class="mf">2.081352e-01</span>
<span class="n">mole</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Anorthite</span>  <span class="o">=</span>  <span class="mf">2.674779e-03</span>
<span class="n">mole</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Potassium_</span> <span class="o">=</span>  <span class="mf">1.496888e-01</span>
<span class="n">Formula</span><span class="p">:</span>  <span class="n">Ca0</span><span class="o">.</span><span class="mi">007</span><span class="n">Na0</span><span class="o">.</span><span class="mi">577</span><span class="n">K0</span><span class="o">.</span><span class="mi">415</span><span class="n">Al1</span><span class="o">.</span><span class="mi">007</span><span class="n">Si2</span><span class="o">.</span><span class="mi">993</span><span class="n">O8</span>
<span class="n">Total</span> <span class="n">moles</span> <span class="n">of</span> <span class="n">endmembers</span><span class="p">:</span>  <span class="mf">0.36049883224427715</span>
<span class="n">Mole</span> <span class="n">fractions</span> <span class="n">of</span> <span class="n">endmembers</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.57735337</span> <span class="mf">0.00741966</span> <span class="mf">0.41522697</span><span class="p">]</span>
<span class="n">Moles</span> <span class="n">of</span> <span class="n">endmembers</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.20813521</span> <span class="mf">0.00267478</span> <span class="mf">0.14968884</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">moles</span> <span class="n">of</span> <span class="n">endmembers</span><span class="p">:</span>  <span class="mf">0.36049883224427715</span>
<span class="n">Total</span> <span class="n">grams</span> <span class="n">of</span> <span class="n">phase</span><span class="p">:</span>  <span class="mf">96.98566962270826</span>
</pre></div>
</div>
</div>
<div class="section" id="all-phases-should-implement-the-following-functions">
<h2>All phases should implement the following functions:<a class="headerlink" href="#all-phases-should-implement-the-following-functions" title="Permalink to this headline">¶</a></h2>
<p>where <em>T</em> (temperature) is in K, and <em>P</em> (pressure) is in bars. Note
that for stoichiometric phases, compositional derivatives are not
implemented. In addition, Some functions are only available in code
generated by the coder module. These functions return a scalar or an
(multi-dimensional) array, depending on input.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endmember</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">moles_end</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">deriv</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="n">deriv</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">moles_end</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}{1:15.6e}</span><span class="s2"> </span><span class="si">{2:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">const</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}{1:15.6e}</span><span class="s2"> </span><span class="si">{2:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="n">const</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">moles_end</span><span class="p">),</span> <span class="n">units</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">moles_end</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}{1:15.6e}</span><span class="s2"> </span><span class="si">{2:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2"> is not implemented&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span>  <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dT&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dT2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dTdP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dTdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dP2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dPdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^3-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT2dP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT2dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdP2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdPdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dP3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^3-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dP2dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dPdm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dm3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^4&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dS/dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2S/dm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;Cv&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dCp/dT&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/-K^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dCp/dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/-K-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;gm/cc&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">thermal_exp</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;1/K&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">compressibility</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;1/bar&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">bulk_mod</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;Kp&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">bulk_mod</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;1/bar&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;dV/dT&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-K-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;dv/dP&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;dv/dm&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dT2&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-K^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dTdP&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-K-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dP2&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^3-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dTdm&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-K-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dPdm&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">test_func</span><span class="p">(</span><span class="s2">&quot;d2V/dm2&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>

<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;mu0&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">chem_potential</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">activity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;da/dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">activity</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;1/mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>         <span class="n">G</span>  <span class="o">-</span><span class="mf">1.543800e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
     <span class="n">dG</span><span class="o">/</span><span class="n">dT</span>  <span class="o">-</span><span class="mf">2.008262e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dG</span><span class="o">/</span><span class="n">dP</span>   <span class="mf">3.877689e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dG</span><span class="o">/</span><span class="n">dm</span>   <span class="o">-</span><span class="mf">4.262225e+06</span>   <span class="o">-</span><span class="mf">4.561322e+06</span>   <span class="o">-</span><span class="mf">4.305465e+06</span>  <span class="n">J</span><span class="o">/</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2G</span><span class="o">/</span><span class="n">dT2</span>  <span class="o">-</span><span class="mf">1.135029e-01</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d2G</span><span class="o">/</span><span class="n">dTdP</span>   <span class="mf">1.063956e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d2G</span><span class="o">/</span><span class="n">dTdm</span>   <span class="o">-</span><span class="mf">5.542934e+02</span>   <span class="o">-</span><span class="mf">5.673239e+02</span>   <span class="o">-</span><span class="mf">5.607681e+02</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2G</span><span class="o">/</span><span class="n">dP2</span>  <span class="o">-</span><span class="mf">7.051354e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d2G</span><span class="o">/</span><span class="n">dPdm</span>    <span class="mf">1.037394e+01</span>    <span class="mf">9.663737e+00</span>    <span class="mf">1.130785e+01</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2G</span><span class="o">/</span><span class="n">dm2</span>   <span class="o">-</span><span class="mf">1.132920e+04</span>   <span class="o">-</span><span class="mf">1.190827e+05</span>    <span class="mf">1.788060e+04</span>    <span class="mf">2.948972e+06</span>    <span class="mf">1.128839e+05</span>   <span class="o">-</span><span class="mf">2.687923e+04</span>  <span class="n">J</span><span class="o">/</span><span class="n">mol</span><span class="o">^</span><span class="mi">3</span>
   <span class="n">d3G</span><span class="o">/</span><span class="n">dT3</span>   <span class="mf">9.820971e-05</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dT2dP</span>   <span class="mf">2.475906e-08</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dT2dm</span>   <span class="o">-</span><span class="mf">3.103643e-01</span>   <span class="o">-</span><span class="mf">3.208837e-01</span>   <span class="o">-</span><span class="mf">3.209783e-01</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dTdP2</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d3G</span><span class="o">/</span><span class="n">dTdPdm</span>    <span class="mf">3.105467e-04</span>    <span class="mf">1.693974e-04</span>    <span class="mf">2.759511e-04</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dTdm2</span>    <span class="mf">3.693986e+01</span>   <span class="o">-</span><span class="mf">2.673410e+01</span>   <span class="o">-</span><span class="mf">5.088541e+01</span>    <span class="mf">3.057945e+03</span>   <span class="o">-</span><span class="mf">1.746970e+01</span>    <span class="mf">7.106591e+01</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">3</span>
   <span class="n">d3G</span><span class="o">/</span><span class="n">dP3</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dP2dm</span>   <span class="o">-</span><span class="mf">1.960841e-05</span>   <span class="o">-</span><span class="mf">1.281943e-05</span>   <span class="o">-</span><span class="mf">1.961311e-05</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
 <span class="n">d3G</span><span class="o">/</span><span class="n">dPdm2</span>   <span class="o">-</span><span class="mf">7.037012e-01</span>    <span class="mf">6.741086e-01</span>    <span class="mf">9.664175e-01</span>    <span class="mf">4.505048e+00</span>   <span class="o">-</span><span class="mf">1.017816e+00</span>   <span class="o">-</span><span class="mf">1.325570e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">3</span>
   <span class="n">d3G</span><span class="o">/</span><span class="n">dm3</span>    <span class="mf">5.123105e+04</span>    <span class="mf">6.283228e+05</span>   <span class="o">-</span><span class="mf">6.776787e+03</span>    <span class="mf">1.105060e+06</span>   <span class="o">-</span><span class="mf">9.786400e+04</span>   <span class="o">-</span><span class="mf">1.082802e+05</span>   <span class="o">-</span><span class="mf">1.161175e+09</span>   <span class="o">-</span><span class="mf">4.882569e+05</span>   <span class="o">-</span><span class="mf">6.093240e+05</span>    <span class="mf">3.410139e+05</span>  <span class="n">J</span><span class="o">/</span><span class="n">mol</span><span class="o">^</span><span class="mi">4</span>
         <span class="n">H</span>  <span class="o">-</span><span class="mf">1.342973e+06</span> <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
         <span class="n">S</span>   <span class="mf">2.008262e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dS</span><span class="o">/</span><span class="n">dm</span>    <span class="mf">5.542934e+02</span>    <span class="mf">5.673239e+02</span>    <span class="mf">5.607681e+02</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2S</span><span class="o">/</span><span class="n">dm2</span>   <span class="o">-</span><span class="mf">3.693986e+01</span>    <span class="mf">2.673410e+01</span>    <span class="mf">5.088541e+01</span>   <span class="o">-</span><span class="mf">3.057945e+03</span>    <span class="mf">1.746970e+01</span>   <span class="o">-</span><span class="mf">7.106591e+01</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">3</span>
        <span class="n">Cv</span>   <span class="mf">1.118975e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
        <span class="n">Cp</span>   <span class="mf">1.135029e+02</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
    <span class="n">dCp</span><span class="o">/</span><span class="n">dT</span>   <span class="mf">1.529320e-02</span> <span class="n">J</span><span class="o">/-</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
    <span class="n">dCp</span><span class="o">/</span><span class="n">dm</span>    <span class="mf">3.103643e-04</span>    <span class="mf">3.208837e-04</span>    <span class="mf">3.209783e-04</span>  <span class="n">J</span><span class="o">/-</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
       <span class="n">rho</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">implemented</span>
     <span class="n">alpha</span>   <span class="mf">2.743789e-05</span> <span class="mi">1</span><span class="o">/</span><span class="n">K</span>
      <span class="n">beta</span>   <span class="mf">1.818442e-06</span> <span class="mi">1</span><span class="o">/</span><span class="n">bar</span>
         <span class="n">K</span>   <span class="mf">5.499212e+05</span>
        <span class="n">Kp</span>  <span class="o">-</span><span class="mf">1.000000e+00</span> <span class="mi">1</span><span class="o">/</span><span class="n">bar</span>
         <span class="n">V</span>   <span class="mf">3.877689e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dV</span><span class="o">/</span><span class="n">dT</span>   <span class="mf">1.063956e-04</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dv</span><span class="o">/</span><span class="n">dP</span>  <span class="o">-</span><span class="mf">7.051354e-06</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">dv</span><span class="o">/</span><span class="n">dm</span>   <span class="o">-</span><span class="mf">1.960841e-05</span>   <span class="o">-</span><span class="mf">1.281943e-05</span>   <span class="o">-</span><span class="mf">1.961311e-05</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2V</span><span class="o">/</span><span class="n">dT2</span>   <span class="mf">2.475906e-08</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d2V</span><span class="o">/</span><span class="n">dTdP</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
   <span class="n">d2V</span><span class="o">/</span><span class="n">dP2</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d2V</span><span class="o">/</span><span class="n">dTdm</span>    <span class="mf">3.105467e-04</span>    <span class="mf">1.693974e-04</span>    <span class="mf">2.759511e-04</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
  <span class="n">d2V</span><span class="o">/</span><span class="n">dPdm</span>   <span class="o">-</span><span class="mf">1.960841e-05</span>   <span class="o">-</span><span class="mf">1.281943e-05</span>   <span class="o">-</span><span class="mf">1.961311e-05</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d2V</span><span class="o">/</span><span class="n">dm2</span>   <span class="o">-</span><span class="mf">7.037012e-01</span>    <span class="mf">6.741086e-01</span>    <span class="mf">9.664175e-01</span>    <span class="mf">4.505048e+00</span>   <span class="o">-</span><span class="mf">1.017816e+00</span>   <span class="o">-</span><span class="mf">1.325570e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span><span class="o">^</span><span class="mi">3</span>
       <span class="n">mu0</span>   <span class="o">-</span><span class="mf">4.305465e+06</span>  <span class="n">J</span><span class="o">/</span><span class="n">mol</span>
  <span class="n">activity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">implemented</span>
     <span class="n">da</span><span class="o">/</span><span class="n">dm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">implemented</span>
</pre></div>
</div>
</div>
<div class="section" id="illustrate-parameter-calibration-protocol-methods">
<h2>Illustrate parameter calibration protocol methods:<a class="headerlink" href="#illustrate-parameter-calibration-protocol-methods" title="Permalink to this headline">¶</a></h2>
<p>Phase code must have been generated with the <em>calib</em> option set to
<em>True</em>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">param_props</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">param_props</span>
    <span class="n">supports_calib</span> <span class="o">=</span> <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;supports_calib&#39;</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;This phase supports the Calibration protocol&#39;</span><span class="p">)</span>
    <span class="n">nparam</span> <span class="o">=</span> <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_num&#39;</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;... there are&#39;</span><span class="p">,</span> <span class="n">nparam</span><span class="p">,</span> <span class="s1">&#39;parameters&#39;</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_names&#39;</span><span class="p">]</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param_units&#39;</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">param_props</span><span class="p">[</span><span class="s1">&#39;param0&#39;</span><span class="p">]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">1000.0</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">1000.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nparam</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Parameter </span><span class="si">{0:&lt;15s}</span><span class="s2"> has value </span><span class="si">{1:15.6e}</span><span class="s2">  </span><span class="si">{2:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;This phase does not implement the parameter calibration protocol&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">phase</span> <span class="n">supports</span> <span class="n">the</span> <span class="n">Calibration</span> <span class="n">protocol</span>
<span class="o">...</span> <span class="n">there</span> <span class="n">are</span> <span class="mi">23</span> <span class="n">parameters</span>
<span class="n">Parameter</span> <span class="n">T_r</span>             <span class="n">has</span> <span class="n">value</span>    <span class="mf">2.981500e+02</span>  <span class="n">K</span>
<span class="n">Parameter</span> <span class="n">P_r</span>             <span class="n">has</span> <span class="n">value</span>    <span class="mf">1.000000e+00</span>  <span class="n">bar</span>
<span class="n">Parameter</span> <span class="n">Wh12</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">7.924000e+03</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Ws12</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wv12</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWh12</span>           <span class="n">has</span> <span class="n">value</span>   <span class="o">-</span><span class="mf">7.924000e+03</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWs12</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWv12</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wh13</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">4.613000e+04</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Ws13</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">2.060000e+01</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wv13</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">7.866000e-01</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWh13</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">8.510000e+03</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWs13</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWv13</span>           <span class="n">has</span> <span class="n">value</span>   <span class="o">-</span><span class="mf">1.338000e-01</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wh23</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">7.929100e+04</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Ws23</span>            <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wv23</span>            <span class="n">has</span> <span class="n">value</span>   <span class="o">-</span><span class="mf">1.037000e-01</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWh23</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">1.343000e+03</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWs23</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">dWv23</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">1.037000e-01</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wh123</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">1.254500e+04</span>  <span class="n">J</span><span class="o">/</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Ws123</span>           <span class="n">has</span> <span class="n">value</span>    <span class="mf">0.000000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">m</span>
<span class="n">Parameter</span> <span class="n">Wv123</span>           <span class="n">has</span> <span class="n">value</span>   <span class="o">-</span><span class="mf">1.095000e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-parameter-derivative-methods">
<h2>Calculate parameter derivative methods:<a class="headerlink" href="#calculate-parameter-derivative-methods" title="Permalink to this headline">¶</a></h2>
<p>Phase code must have been generated with the <em>calib</em> option set to
<em>True</em>.</p>
<p>The variable <em>deriv_param</em> in the following code block may be set to: -
an integer, identifying the element in the parameter array that is
output above - a string, identifying the parameter itself - a list of
integers, i.e. [4, 6], identifying a set of parameter derivatives, which
will generate an output array - a list of strings, identifying
parameters whose derivatives are output as an array</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">phase</span><span class="o">.</span><span class="n">calib</span><span class="p">:</span>
    <span class="n">deriv_param</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Derivatives with respect to parameter:&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="n">deriv_param</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">moles_end</span><span class="p">,</span> <span class="n">deriv_param</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;d(&#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;)/dParam&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">moles_end</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="n">deriv</span><span class="p">,</span> <span class="n">deriv_param</span><span class="o">=</span><span class="n">deriv_param</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:15.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;20s}{1:15.6e}</span><span class="s2"> </span><span class="si">{2:&lt;20s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:&gt;20s}{1:&gt;15s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;NYI&quot;</span><span class="p">))</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dT&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;dG/dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dT2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dTdP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dTdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dP2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dPdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d2G/dm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>

    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^3-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT2dP&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-bar-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dT2dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K^2-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdP2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar^2-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdPdm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-bar-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dTdm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/K-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dP3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^3-mol&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dP2dm&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar^2-mol^2&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dPdm2&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/bar-mol^3&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dP&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="n">test_func</span><span class="p">(</span><span class="s1">&#39;d3G/dm3&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">.</span><span class="n">gibbs_energy</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="s1">&#39;J/mol^4&#39;</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dmol&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Derivatives</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">Wv12</span>
         <span class="n">d</span><span class="p">(</span><span class="n">G</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">1.544293e+00</span> <span class="n">J</span>
     <span class="n">d</span><span class="p">(</span><span class="n">dG</span><span class="o">/</span><span class="n">dT</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">d</span><span class="p">(</span><span class="n">dG</span><span class="o">/</span><span class="n">dP</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">1.544293e-03</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
     <span class="n">d</span><span class="p">(</span><span class="n">dG</span><span class="o">/</span><span class="n">dm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>    <span class="mf">3.135895e+00</span>    <span class="mf">5.730696e+02</span>   <span class="o">-</span><span class="mf">4.283766e+00</span>  <span class="n">J</span><span class="o">/</span><span class="n">mol</span><span class="o">^</span><span class="mi">2</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dT2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dTdP</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dTdm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dP2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
  <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dPdm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d2G</span><span class="o">/</span><span class="n">dm2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dT3</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dT2dP</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">bar</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dT2dm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dTdP2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">K</span><span class="o">-</span><span class="n">bar</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">mol</span>
<span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dTdPdm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dTdm2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dP3</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>   <span class="mf">0.000000e+00</span> <span class="n">J</span><span class="o">/</span><span class="n">bar</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">mol</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dP2dm</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
 <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dPdm2</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
   <span class="n">d</span><span class="p">(</span><span class="n">d3G</span><span class="o">/</span><span class="n">dm3</span><span class="p">)</span><span class="o">/</span><span class="n">dParam</span>            <span class="n">NYI</span>
</pre></div>
</div>
</div>
<div class="section" id="illustrate-plotting-the-heat-capacity-using-an-input-array-of-temperatures">
<h2>Illustrate plotting the heat capacity using an input array of temperatures:<a class="headerlink" href="#illustrate-plotting-the-heat-capacity-using-an-input-array-of-temperatures" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://matplotlib.org/users/pyplot_tutorial.html">Documentation on PyPlot in
MatPlotLib</a></div>
<div class="line">Pressure is fixed at 1000 bars.</div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">T_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">250.0</span><span class="p">,</span> <span class="mf">1200.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Cp_array</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">(</span><span class="n">T_array</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">moles_end</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_array</span><span class="p">,</span> <span class="n">Cp_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cp J/K-m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Example-8-Importing-modules_21_0.png" src="_images/Example-8-Importing-modules_21_0.png" />
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, ENKI.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>